{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false",
    "colab_type": "text",
    "id": "AuCkj0Qwywjy"
   },
   "source": [
    "# QA of DSL Release v1.27\n",
    "\n",
    "The purpose of this notebook is to review and test the new features in this DSL version.\n",
    "\n",
    "https://docs.dimensions.ai/dsl/1.27.0-preview/releasenotes.html\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false",
    "colab_type": "text",
    "id": "dj3FxL-cbjrM"
   },
   "source": [
    "## Prerequisites\n",
    "\n",
    "Please install the latest versions of these libraries to run this notebook. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "Collapsed": "false",
    "cellView": "form",
    "colab": {
     "base_uri": "https://localhost:8080/",
     "height": 153
    },
    "colab_type": "code",
    "executionInfo": {
     "elapsed": 10861,
     "status": "ok",
     "timestamp": 1570722986241,
     "user": {
      "displayName": "Michele Pasin",
      "photoUrl": "https://lh3.googleusercontent.com/a-/AAuE7mBu8LVjIGgontF2Wax51BoL5KFx8esezX3bUmaa0g=s64",
      "userId": "10309320684375994511"
     },
     "user_tz": -60
    },
    "id": "BLUcxPxVb1vl",
    "outputId": "182031e3-7618-4a76-f7ee-d89fe4a4a6c7"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[2mDimcli - Dimensions API Client (v0.7.2)\u001b[0m\n",
      "\u001b[2mConnected to: https://integration.ds-metrics.com - DSL v1.27\u001b[0m\n",
      "\u001b[2mMethod: dsl.ini file\u001b[0m\n"
     ]
    }
   ],
   "source": [
    "#\n",
    "# load common libraries\n",
    "import pandas as pd\n",
    "from pandas.io.json import json_normalize\n",
    "\n",
    "import time\n",
    "import json\n",
    "from tqdm.notebook import tqdm as progress\n",
    "\n",
    "import plotly.express as px\n",
    "from plotly.offline import plot \n",
    "\n",
    "import dimcli\n",
    "from dimcli.shortcuts import *\n",
    "\n",
    "dimcli.login(instance=\"test\")\n",
    "dsl = dimcli.Dsl() \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false",
    "colab_type": "text",
    "id": "JcnVEdOAywj3"
   },
   "source": [
    "---"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false",
    "colab_type": "text",
    "id": "YBSdHL4Tywj4"
   },
   "source": [
    "## DSL-409 Handle obsolete GRIDS correctly\n",
    "\n",
    "https://uberresearch.atlassian.net/browse/DSL-409"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Organizations: 1 (total = 97898)\n",
      "a ==> 97898\n",
      "Returned Organizations: 1 (total = 40)\n",
      "o ==> 40\n",
      "Returned Organizations: 1 (total = 964)\n",
      "r ==> 964\n"
     ]
    }
   ],
   "source": [
    "st = [\"a\", \"o\", \"r\"]\n",
    "\n",
    "for x in st:\n",
    "    tot = dsl.query(f\"\"\"search organizations where status = \"{x}\" return organizations limit 1\"\"\").count_total\n",
    "    print(x, \"==>\", tot)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Organizations: 964 (total = 964)\n",
      "All redirect organizations have a new GRID id set up\n"
     ]
    }
   ],
   "source": [
    "st = [\"r\"]\n",
    "\n",
    "for x in st:\n",
    "    data = dsl.query(f\"\"\"search organizations where status = \"{x}\" return organizations[id+redirect] limit 1000\"\"\")\n",
    "    test = False\n",
    "    for r in data.organizations:\n",
    "        if not 'redirect' in r:\n",
    "            test = True\n",
    "            print(r['id'], \" does not have a redirect value!\")\n",
    "    if test:\n",
    "        print(\"===errors were found===\")\n",
    "    else:\n",
    "        print(\"All redirect organizations have a new GRID id set up\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## DSL-348 Error with research_orgs.name search with url string\n",
    "\n",
    "https://uberresearch.atlassian.net/browse/DSL-348\n",
    "\n",
    "Returns no results, but throws no error"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Organizations: 0\n"
     ]
    },
    {
     "data": {
      "application/json": {
       "_stats": {
        "total_count": 0
       },
       "_version": {
        "release": "1.27",
        "version": "1.27.0-preview"
       },
       "organizations": []
      },
      "text/plain": [
       "<dimcli.DslDataset object #4590807408. Records: 0/0>"
      ]
     },
     "execution_count": 4,
     "metadata": {
      "application/json": {
       "expanded": false,
       "root": "root"
      }
     },
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsl \n",
    "\n",
    "search organizations for \"https\\://www.ncbi.nlm.nih.gov\"\n",
    "return organizations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Organizations: 0\n"
     ]
    },
    {
     "data": {
      "application/json": {
       "_stats": {
        "total_count": 0
       },
       "_version": {
        "release": "1.27",
        "version": "1.27.0-preview"
       },
       "organizations": []
      },
      "text/plain": [
       "<dimcli.DslDataset object #4856532848. Records: 0/0>"
      ]
     },
     "execution_count": 5,
     "metadata": {
      "application/json": {
       "expanded": false,
       "root": "root"
      }
     },
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsl \n",
    "\n",
    "search organizations where name ~ \"https\\://www.ncbi.nlm.nih.gov\"\n",
    "return organizations"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "Still **fails if you dont escape the colon symbol** \n",
    "\n",
    "Adam: \n",
    "\n",
    "> it is expected to return an EvaluationError. Previously this was throwing 500…  Why, is another concern, but the DSL is not doing anything special here, just passing the query to Solr, and it is failing there, I am not entirely sure why either."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Errors: 1\n",
      "1 EvaluationError found\n",
      "400 - org.apache.solr.search.SyntaxError: Cannot parse 'name_search:(*https://www.ncbi.nlm.nih.gov*)': Encountered \" \":\" \": \"\" at line 1, column 19.\n",
      "Was expecting one of:\n",
      "    <AND> ...\n",
      "    <OR> ...\n",
      "    <NOT> ...\n",
      "    \"+\" ...\n",
      "    \"-\" ...\n",
      "    <BAREOPER> ...\n",
      "    \"(\" ...\n",
      "    \")\" ...\n",
      "    \"*\" ...\n",
      "    \"^\" ...\n",
      "    <QUOTED> ...\n",
      "    <TERM> ...\n",
      "    <FUZZY_SLOP> ...\n",
      "    <PREFIXTERM> ...\n",
      "    <WILDTERM> ...\n",
      "    <REGEXPTERM> ...\n",
      "    \"[\" ...\n",
      "    \"{\" ...\n",
      "    <LPARAMS> ...\n",
      "    \"filter(\" ...\n",
      "    <NUMBER> ...\n",
      "     [code: 6]\n"
     ]
    },
    {
     "data": {
      "application/json": {
       "errors": {
        "query": {
         "details": [
          "400 - org.apache.solr.search.SyntaxError: Cannot parse 'name_search:(*https://www.ncbi.nlm.nih.gov*)': Encountered \" \":\" \": \"\" at line 1, column 19.\nWas expecting one of:\n    <AND> ...\n    <OR> ...\n    <NOT> ...\n    \"+\" ...\n    \"-\" ...\n    <BAREOPER> ...\n    \"(\" ...\n    \")\" ...\n    \"*\" ...\n    \"^\" ...\n    <QUOTED> ...\n    <TERM> ...\n    <FUZZY_SLOP> ...\n    <PREFIXTERM> ...\n    <WILDTERM> ...\n    <REGEXPTERM> ...\n    \"[\" ...\n    \"{\" ...\n    <LPARAMS> ...\n    \"filter(\" ...\n    <NUMBER> ...\n     [code: 6]"
         ],
         "header": "1 EvaluationError found\n",
         "query": "\nsearch organizations where name ~ \"https://www.ncbi.nlm.nih.gov\"\nreturn organizations\n"
        }
       }
      },
      "text/plain": [
       "<dimcli.DslDataset object #4856532608. Errors: 1>"
      ]
     },
     "execution_count": 6,
     "metadata": {
      "application/json": {
       "expanded": false,
       "root": "root"
      }
     },
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsl \n",
    "\n",
    "search organizations where name ~ \"https://www.ncbi.nlm.nih.gov\"\n",
    "return organizations"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## DSL-460 Grants.research_orgs_names\n",
    "\n",
    "https://uberresearch.atlassian.net/browse/DSL-460"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Grants: 10 (total = 78)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funders</th>\n",
       "      <th>title</th>\n",
       "      <th>start_year</th>\n",
       "      <th>project_num</th>\n",
       "      <th>title_language</th>\n",
       "      <th>funding_org_name</th>\n",
       "      <th>start_date</th>\n",
       "      <th>original_title</th>\n",
       "      <th>active_year</th>\n",
       "      <th>language</th>\n",
       "      <th>end_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.9244733</td>\n",
       "      <td>[{'id': 'grid.270680.b', 'latitude': 50.85165,...</td>\n",
       "      <td>Research, Connections, Networks and Culture - ...</td>\n",
       "      <td>2020</td>\n",
       "      <td>955352</td>\n",
       "      <td>en</td>\n",
       "      <td>European Commission</td>\n",
       "      <td>2020-06-01</td>\n",
       "      <td>Research, Connections, Networks and Culture - ...</td>\n",
       "      <td>[2020, 2021]</td>\n",
       "      <td>en</td>\n",
       "      <td>2021-02-28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8710204</td>\n",
       "      <td>[{'id': 'grid.270680.b', 'latitude': 50.85165,...</td>\n",
       "      <td>EUROPEAN INVENTORY OF SOCIETAL VALUES OF CULTU...</td>\n",
       "      <td>2020</td>\n",
       "      <td>870691</td>\n",
       "      <td>en</td>\n",
       "      <td>European Commission</td>\n",
       "      <td>2020-02-01</td>\n",
       "      <td>EUROPEAN INVENTORY OF SOCIETAL VALUES OF CULTU...</td>\n",
       "      <td>[2020, 2021, 2022, 2023]</td>\n",
       "      <td>en</td>\n",
       "      <td>2023-01-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8854960</td>\n",
       "      <td>[{'id': 'grid.453039.8', 'latitude': 45.819202...</td>\n",
       "      <td>Establishing criteria for evaluating moderniza...</td>\n",
       "      <td>2020</td>\n",
       "      <td>3024</td>\n",
       "      <td>hr</td>\n",
       "      <td>Croatian Science Foundation</td>\n",
       "      <td>2020-01-02</td>\n",
       "      <td>Uspostava kriterija za vrednovanje modernizaci...</td>\n",
       "      <td>[2020, 2021, 2022, 2023, 2024, 2025]</td>\n",
       "      <td>hr</td>\n",
       "      <td>2025-01-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.8854954</td>\n",
       "      <td>[{'id': 'grid.453039.8', 'latitude': 45.819202...</td>\n",
       "      <td>Free career decision-making model: The role of...</td>\n",
       "      <td>2020</td>\n",
       "      <td>7537</td>\n",
       "      <td>bs</td>\n",
       "      <td>Croatian Science Foundation</td>\n",
       "      <td>2020-01-01</td>\n",
       "      <td>Model slobodnog odlučivanja o karijeri:  Uloga...</td>\n",
       "      <td>[2020, 2021, 2022, 2023]</td>\n",
       "      <td>bs</td>\n",
       "      <td>2023-12-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.8854912</td>\n",
       "      <td>[{'id': 'grid.453039.8', 'latitude': 45.819202...</td>\n",
       "      <td>World War I in the culture of remembrance. For...</td>\n",
       "      <td>2020</td>\n",
       "      <td>5897</td>\n",
       "      <td>hr</td>\n",
       "      <td>Croatian Science Foundation</td>\n",
       "      <td>2020-01-01</td>\n",
       "      <td>Prvi svjetski rat u kulturi sjećanja. Zaboravl...</td>\n",
       "      <td>[2020, 2021, 2022, 2023]</td>\n",
       "      <td>hr</td>\n",
       "      <td>2023-12-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>grant.8433422</td>\n",
       "      <td>[{'id': 'grid.54432.34', 'latitude': 35.68716,...</td>\n",
       "      <td>Development of Rich Learning Model using Abduc...</td>\n",
       "      <td>2019</td>\n",
       "      <td>19K03027</td>\n",
       "      <td>en</td>\n",
       "      <td>Japan Society for the Promotion of Science</td>\n",
       "      <td>2019-04-01</td>\n",
       "      <td>Development of Rich Learning Model using Abduc...</td>\n",
       "      <td>[2019, 2020, 2021, 2022]</td>\n",
       "      <td>ja</td>\n",
       "      <td>2022-03-31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>grant.7882970</td>\n",
       "      <td>[{'id': 'grid.453039.8', 'latitude': 45.819202...</td>\n",
       "      <td>Regulation of prostitution in Croatia</td>\n",
       "      <td>2019</td>\n",
       "      <td>3878</td>\n",
       "      <td>hr</td>\n",
       "      <td>Croatian Science Foundation</td>\n",
       "      <td>2019-02-05</td>\n",
       "      <td>Regulacija prostitucije u Hrvatskoj</td>\n",
       "      <td>[2019, 2020, 2021, 2022, 2023]</td>\n",
       "      <td>bs</td>\n",
       "      <td>2023-01-05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>grant.8674396</td>\n",
       "      <td>[{'id': 'grid.436050.4', 'latitude': 46.055737...</td>\n",
       "      <td>Innovative sensors for real-time monitoring of...</td>\n",
       "      <td>2019</td>\n",
       "      <td>L2-1835 (D)</td>\n",
       "      <td>en</td>\n",
       "      <td>Slovenian Research Agency</td>\n",
       "      <td>2019-01-07</td>\n",
       "      <td>Innovative sensors for real-time monitoring of...</td>\n",
       "      <td>[2019, 2020, 2021, 2022]</td>\n",
       "      <td>en</td>\n",
       "      <td>2022-06-30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>grant.8674375</td>\n",
       "      <td>[{'id': 'grid.436050.4', 'latitude': 46.055737...</td>\n",
       "      <td>Initial stages in surface functionalization of...</td>\n",
       "      <td>2019</td>\n",
       "      <td>J2-1728 (D)</td>\n",
       "      <td>en</td>\n",
       "      <td>Slovenian Research Agency</td>\n",
       "      <td>2019-01-07</td>\n",
       "      <td>Initial stages in surface functionalization of...</td>\n",
       "      <td>[2019, 2020, 2021, 2022]</td>\n",
       "      <td>en</td>\n",
       "      <td>2022-06-30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>grant.7819455</td>\n",
       "      <td>[{'id': 'grid.270680.b', 'latitude': 50.85165,...</td>\n",
       "      <td>Research, Connections, Networks and Culture</td>\n",
       "      <td>2018</td>\n",
       "      <td>817676</td>\n",
       "      <td>en</td>\n",
       "      <td>European Commission</td>\n",
       "      <td>2018-05-01</td>\n",
       "      <td>Research, Connections, Networks and Culture</td>\n",
       "      <td>[2018, 2019]</td>\n",
       "      <td>en</td>\n",
       "      <td>2019-10-31</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id                                            funders  \\\n",
       "0  grant.9244733  [{'id': 'grid.270680.b', 'latitude': 50.85165,...   \n",
       "1  grant.8710204  [{'id': 'grid.270680.b', 'latitude': 50.85165,...   \n",
       "2  grant.8854960  [{'id': 'grid.453039.8', 'latitude': 45.819202...   \n",
       "3  grant.8854954  [{'id': 'grid.453039.8', 'latitude': 45.819202...   \n",
       "4  grant.8854912  [{'id': 'grid.453039.8', 'latitude': 45.819202...   \n",
       "5  grant.8433422  [{'id': 'grid.54432.34', 'latitude': 35.68716,...   \n",
       "6  grant.7882970  [{'id': 'grid.453039.8', 'latitude': 45.819202...   \n",
       "7  grant.8674396  [{'id': 'grid.436050.4', 'latitude': 46.055737...   \n",
       "8  grant.8674375  [{'id': 'grid.436050.4', 'latitude': 46.055737...   \n",
       "9  grant.7819455  [{'id': 'grid.270680.b', 'latitude': 50.85165,...   \n",
       "\n",
       "                                               title  start_year  project_num  \\\n",
       "0  Research, Connections, Networks and Culture - ...        2020       955352   \n",
       "1  EUROPEAN INVENTORY OF SOCIETAL VALUES OF CULTU...        2020       870691   \n",
       "2  Establishing criteria for evaluating moderniza...        2020         3024   \n",
       "3  Free career decision-making model: The role of...        2020         7537   \n",
       "4  World War I in the culture of remembrance. For...        2020         5897   \n",
       "5  Development of Rich Learning Model using Abduc...        2019     19K03027   \n",
       "6              Regulation of prostitution in Croatia        2019         3878   \n",
       "7  Innovative sensors for real-time monitoring of...        2019  L2-1835 (D)   \n",
       "8  Initial stages in surface functionalization of...        2019  J2-1728 (D)   \n",
       "9        Research, Connections, Networks and Culture        2018       817676   \n",
       "\n",
       "  title_language                            funding_org_name  start_date  \\\n",
       "0             en                         European Commission  2020-06-01   \n",
       "1             en                         European Commission  2020-02-01   \n",
       "2             hr                 Croatian Science Foundation  2020-01-02   \n",
       "3             bs                 Croatian Science Foundation  2020-01-01   \n",
       "4             hr                 Croatian Science Foundation  2020-01-01   \n",
       "5             en  Japan Society for the Promotion of Science  2019-04-01   \n",
       "6             hr                 Croatian Science Foundation  2019-02-05   \n",
       "7             en                   Slovenian Research Agency  2019-01-07   \n",
       "8             en                   Slovenian Research Agency  2019-01-07   \n",
       "9             en                         European Commission  2018-05-01   \n",
       "\n",
       "                                      original_title  \\\n",
       "0  Research, Connections, Networks and Culture - ...   \n",
       "1  EUROPEAN INVENTORY OF SOCIETAL VALUES OF CULTU...   \n",
       "2  Uspostava kriterija za vrednovanje modernizaci...   \n",
       "3  Model slobodnog odlučivanja o karijeri:  Uloga...   \n",
       "4  Prvi svjetski rat u kulturi sjećanja. Zaboravl...   \n",
       "5  Development of Rich Learning Model using Abduc...   \n",
       "6                Regulacija prostitucije u Hrvatskoj   \n",
       "7  Innovative sensors for real-time monitoring of...   \n",
       "8  Initial stages in surface functionalization of...   \n",
       "9        Research, Connections, Networks and Culture   \n",
       "\n",
       "                            active_year language    end_date  \n",
       "0                          [2020, 2021]       en  2021-02-28  \n",
       "1              [2020, 2021, 2022, 2023]       en  2023-01-31  \n",
       "2  [2020, 2021, 2022, 2023, 2024, 2025]       hr  2025-01-31  \n",
       "3              [2020, 2021, 2022, 2023]       bs  2023-12-31  \n",
       "4              [2020, 2021, 2022, 2023]       hr  2023-12-31  \n",
       "5              [2019, 2020, 2021, 2022]       ja  2022-03-31  \n",
       "6        [2019, 2020, 2021, 2022, 2023]       bs  2023-01-05  \n",
       "7              [2019, 2020, 2021, 2022]       en  2022-06-30  \n",
       "8              [2019, 2020, 2021, 2022]       en  2022-06-30  \n",
       "9                          [2018, 2019]       en  2019-10-31  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf \n",
    "\n",
    "search grants where research_org_names ~ \"nih\"\n",
    "return grants limit 10"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "Fails as expected - cause it is not a facet! "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Errors: 1\n",
      "Semantic Error\n",
      "Semantic errors found:\n",
      "\tFacet 'research_org_names' is not present in source 'grants'. Available facets are: FOR,FOR_first,HRCS_HC,HRCS_RAC,RCDC,active_year,category_bra,category_for,category_hra,category_hrcs_hc,category_hrcs_rac,category_icrp_cso,category_icrp_ct,category_rcdc,category_sdg,category_uoa,experts,funder_countries,funders,funding_currency,funding_org_acronym,funding_org_city,funding_org_name,language,language_title,pf01,research_org_cities,research_org_countries,research_org_name,research_org_state_codes,research_orgs,researchers,start_year,title_language\n"
     ]
    }
   ],
   "source": [
    "%%dsldf \n",
    "\n",
    "search grants for \"covid-19\" return research_org_names"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## DSL-486 set return_all_keys not working with unnest properly\n",
    "\n",
    "https://uberresearch.atlassian.net/browse/DSL-486"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 83 (total patents= 637)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>title</th>\n",
       "      <th>id</th>\n",
       "      <th>category_rcdc.id</th>\n",
       "      <th>category_rcdc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>\"nanobubble-nanoparticle complexes for ultraso...</td>\n",
       "      <td>IN-2013MU02919-A</td>\n",
       "      <td>337</td>\n",
       "      <td>Bioengineering</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>\"nanobubble-nanoparticle complexes for ultraso...</td>\n",
       "      <td>IN-2013MU02919-A</td>\n",
       "      <td>439</td>\n",
       "      <td>Biomedical Imaging</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>\"nanobubble-nanoparticle complexes for ultraso...</td>\n",
       "      <td>IN-2013MU02919-A</td>\n",
       "      <td>390</td>\n",
       "      <td>Nanotechnology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Liposomal Curcumin for Treatment of Cancer</td>\n",
       "      <td>US-20190105287-A1</td>\n",
       "      <td>503</td>\n",
       "      <td>Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Liposomal Curcumin for Treatment of Cancer</td>\n",
       "      <td>US-20190105287-A1</td>\n",
       "      <td>337</td>\n",
       "      <td>Bioengineering</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>POLYMERIC DRUG DELIVERY SYSTEMS FOR TREATMENT ...</td>\n",
       "      <td>WO-2017100533-A1</td>\n",
       "      <td>559</td>\n",
       "      <td>Rare Diseases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>POLYMERIC DRUG DELIVERY SYSTEMS FOR TREATMENT ...</td>\n",
       "      <td>WO-2017100533-A1</td>\n",
       "      <td>337</td>\n",
       "      <td>Bioengineering</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80</th>\n",
       "      <td>NANOPARTICLE BASED TARGETED DRUG DELIVERY SYST...</td>\n",
       "      <td>IN-2015CH02315-A</td>\n",
       "      <td>337</td>\n",
       "      <td>Bioengineering</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>NANOPARTICLE BASED TARGETED DRUG DELIVERY SYST...</td>\n",
       "      <td>IN-2015CH02315-A</td>\n",
       "      <td>390</td>\n",
       "      <td>Nanotechnology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>82</th>\n",
       "      <td>NANOPARTICLE BASED TARGETED DRUG DELIVERY SYST...</td>\n",
       "      <td>IN-2015CH02315-A</td>\n",
       "      <td>503</td>\n",
       "      <td>Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>83 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                title                 id  \\\n",
       "0   \"nanobubble-nanoparticle complexes for ultraso...   IN-2013MU02919-A   \n",
       "1   \"nanobubble-nanoparticle complexes for ultraso...   IN-2013MU02919-A   \n",
       "2   \"nanobubble-nanoparticle complexes for ultraso...   IN-2013MU02919-A   \n",
       "3          Liposomal Curcumin for Treatment of Cancer  US-20190105287-A1   \n",
       "4          Liposomal Curcumin for Treatment of Cancer  US-20190105287-A1   \n",
       "..                                                ...                ...   \n",
       "78  POLYMERIC DRUG DELIVERY SYSTEMS FOR TREATMENT ...   WO-2017100533-A1   \n",
       "79  POLYMERIC DRUG DELIVERY SYSTEMS FOR TREATMENT ...   WO-2017100533-A1   \n",
       "80  NANOPARTICLE BASED TARGETED DRUG DELIVERY SYST...   IN-2015CH02315-A   \n",
       "81  NANOPARTICLE BASED TARGETED DRUG DELIVERY SYST...   IN-2015CH02315-A   \n",
       "82  NANOPARTICLE BASED TARGETED DRUG DELIVERY SYST...   IN-2015CH02315-A   \n",
       "\n",
       "   category_rcdc.id  category_rcdc.name  \n",
       "0               337      Bioengineering  \n",
       "1               439  Biomedical Imaging  \n",
       "2               390      Nanotechnology  \n",
       "3               503              Cancer  \n",
       "4               337      Bioengineering  \n",
       "..              ...                 ...  \n",
       "78              559       Rare Diseases  \n",
       "79              337      Bioengineering  \n",
       "80              337      Bioengineering  \n",
       "81              390      Nanotechnology  \n",
       "82              503              Cancer  \n",
       "\n",
       "[83 rows x 4 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf \n",
    "\n",
    "search patents in title_abstract_only for \"(nanoparticle) AND (delivery OR \\\"drug delivery\\\") AND (cancer OR oncology)\" \n",
    "    where year in [2010:2020] \n",
    "    return patents[id + title + unnest(category_rcdc)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 83 (total patents= 637)\n"
     ]
    },
    {
     "data": {
      "application/json": {
       "_stats": {
        "total_count": 637
       },
       "_version": {
        "release": "1.27",
        "version": "1.27.0-preview"
       },
       "patents": [
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "IN-2013MU02919-A"
        },
        {
         "category_rcdc.id": "439",
         "category_rcdc.name": "Biomedical Imaging",
         "id": "IN-2013MU02919-A"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "IN-2013MU02919-A"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "US-20190105287-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-20190105287-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-20190105287-A1"
        },
        {
         "category_rcdc.id": "430",
         "category_rcdc.name": "Complementary and Alternative Medicine",
         "id": "US-20190105287-A1"
        },
        {
         "category_rcdc.id": "316",
         "category_rcdc.name": "Breast Cancer",
         "id": "US-20190105287-A1"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "US-20160193159-A1"
        },
        {
         "category_rcdc.id": "430",
         "category_rcdc.name": "Complementary and Alternative Medicine",
         "id": "US-20160193159-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-20160193159-A1"
        },
        {
         "category_rcdc.id": "316",
         "category_rcdc.name": "Breast Cancer",
         "id": "US-20160193159-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-20160193159-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-10182997-B2"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "US-10182997-B2"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-10182997-B2"
        },
        {
         "category_rcdc.id": "316",
         "category_rcdc.name": "Breast Cancer",
         "id": "US-10182997-B2"
        },
        {
         "category_rcdc.id": "430",
         "category_rcdc.name": "Complementary and Alternative Medicine",
         "id": "US-10182997-B2"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-9283185-B2"
        },
        {
         "category_rcdc.id": "316",
         "category_rcdc.name": "Breast Cancer",
         "id": "US-9283185-B2"
        },
        {
         "category_rcdc.id": "430",
         "category_rcdc.name": "Complementary and Alternative Medicine",
         "id": "US-9283185-B2"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-9283185-B2"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "US-9283185-B2"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "US-20110287085-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-20110287085-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-20110287085-A1"
        },
        {
         "category_rcdc.id": "430",
         "category_rcdc.name": "Complementary and Alternative Medicine",
         "id": "US-20110287085-A1"
        },
        {
         "category_rcdc.id": "316",
         "category_rcdc.name": "Breast Cancer",
         "id": "US-20110287085-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-20190142966-A1"
        },
        {
         "category_rcdc.id": "338",
         "category_rcdc.name": "Biotechnology",
         "id": "US-20190142966-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-20190142966-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "WO-2017197133-A1"
        },
        {
         "category_rcdc.id": "338",
         "category_rcdc.name": "Biotechnology",
         "id": "WO-2017197133-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "WO-2017197133-A1"
        },
        {
         "category_rcdc.id": "543",
         "category_rcdc.name": "Orphan Drug",
         "id": "IN-2011KO00008-A"
        },
        {
         "category_rcdc.id": "559",
         "category_rcdc.name": "Rare Diseases",
         "id": "IN-2011KO00008-A"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "IN-2011KO00008-A"
        },
        {
         "category_rcdc.id": "388",
         "category_rcdc.name": "Nutrition",
         "id": "IN-2011KO00008-A"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "IN-2011KO00008-A"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "IN-2011KO00008-A"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "WO-2014065513-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "WO-2014065513-A1"
        },
        {
         "category_rcdc.id": "439",
         "category_rcdc.name": "Biomedical Imaging",
         "id": "WO-2014065513-A1"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "WO-2014065513-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "EP-2913065-A4"
        },
        {
         "category_rcdc.id": "439",
         "category_rcdc.name": "Biomedical Imaging",
         "id": "EP-2913065-A4"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "EP-2913065-A4"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "EP-2913065-A4"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "US-8198246-B1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-8198246-B1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-8198246-B1"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "US-8318200-B1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-8318200-B1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-8318200-B1"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "US-8318198-B1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-8318198-B1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-8318198-B1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-20100262115-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-20100262115-A1"
        },
        {
         "category_rcdc.id": "559",
         "category_rcdc.name": "Rare Diseases",
         "id": "US-20100262115-A1"
        },
        {
         "category_rcdc.id": "439",
         "category_rcdc.name": "Biomedical Imaging",
         "id": "US-20100262115-A1"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "US-20100262115-A1"
        },
        {
         "category_rcdc.id": "543",
         "category_rcdc.name": "Orphan Drug",
         "id": "US-20100262115-A1"
        },
        {
         "category_rcdc.id": "439",
         "category_rcdc.name": "Biomedical Imaging",
         "id": "CA-2699140-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "CA-2699140-A1"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "CA-2699140-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "CA-2699140-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-9149426-B2"
        },
        {
         "category_rcdc.id": "338",
         "category_rcdc.name": "Biotechnology",
         "id": "US-9149426-B2"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-9149426-B2"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "US-20130209566-A1"
        },
        {
         "category_rcdc.id": "338",
         "category_rcdc.name": "Biotechnology",
         "id": "US-20130209566-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "US-20130209566-A1"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "WO-2017100533-A1"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "WO-2017100533-A1"
        },
        {
         "category_rcdc.id": "543",
         "category_rcdc.name": "Orphan Drug",
         "id": "WO-2017100533-A1"
        },
        {
         "category_rcdc.id": "411",
         "category_rcdc.name": "Pancreatic Cancer",
         "id": "WO-2017100533-A1"
        },
        {
         "category_rcdc.id": "344",
         "category_rcdc.name": "Digestive Diseases",
         "id": "WO-2017100533-A1"
        },
        {
         "category_rcdc.id": "559",
         "category_rcdc.name": "Rare Diseases",
         "id": "WO-2017100533-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "WO-2017100533-A1"
        },
        {
         "category_rcdc.id": "337",
         "category_rcdc.name": "Bioengineering",
         "id": "IN-2015CH02315-A"
        },
        {
         "category_rcdc.id": "390",
         "category_rcdc.name": "Nanotechnology",
         "id": "IN-2015CH02315-A"
        },
        {
         "category_rcdc.id": "503",
         "category_rcdc.name": "Cancer",
         "id": "IN-2015CH02315-A"
        }
       ]
      },
      "text/plain": [
       "<dimcli.DslDataset object #4857058544. Records: 83/637>"
      ]
     },
     "execution_count": 10,
     "metadata": {
      "application/json": {
       "expanded": false,
       "root": "root"
      }
     },
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsl \n",
    "\n",
    "set return_all_keys\n",
    "search patents in title_abstract_only for \"(nanoparticle) AND (delivery OR \\\"drug delivery\\\") AND (cancer OR oncology)\" \n",
    "    where year in [2010:2020] \n",
    "    return patents[id + unnest(category_rcdc)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## DSL-485 Unnesting simple multivalue fields such as ids\n",
    "\n",
    "https://uberresearch.atlassian.net/browse/DSL-485"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "### Sample query from Sam:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 40 (total datasets= 36)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>associated_grant_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>796595</td>\n",
       "      <td>grant.2443303</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>796595</td>\n",
       "      <td>grant.2622776</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>796595</td>\n",
       "      <td>grant.2486583</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>796595</td>\n",
       "      <td>grant.2705157</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>796595</td>\n",
       "      <td>grant.2484211</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>358090</td>\n",
       "      <td>grant.2420507</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>358090</td>\n",
       "      <td>grant.2705199</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>11570418</td>\n",
       "      <td>grant.2354778</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>126649</td>\n",
       "      <td>grant.2489014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>126649</td>\n",
       "      <td>grant.2574938</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>126649</td>\n",
       "      <td>grant.2607733</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>126649</td>\n",
       "      <td>grant.2607806</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>907007</td>\n",
       "      <td>grant.3637460</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>987570</td>\n",
       "      <td>grant.2537759</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>987570</td>\n",
       "      <td>grant.2543242</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>244574</td>\n",
       "      <td>grant.2786397</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>244574</td>\n",
       "      <td>grant.2784260</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>244574</td>\n",
       "      <td>grant.2765320</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>5241121</td>\n",
       "      <td>grant.2549057</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>5241121</td>\n",
       "      <td>grant.2550729</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>5241121</td>\n",
       "      <td>grant.2408114</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>5241121</td>\n",
       "      <td>grant.2485620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>5241121</td>\n",
       "      <td>grant.2580198</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>5241121</td>\n",
       "      <td>grant.2588806</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>5241121</td>\n",
       "      <td>grant.2550625</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>8269316</td>\n",
       "      <td>grant.3493084</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>8268155</td>\n",
       "      <td>grant.3493084</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>8269319</td>\n",
       "      <td>grant.3493084</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>8268152</td>\n",
       "      <td>grant.3493084</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>5123290</td>\n",
       "      <td>grant.2445563</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>5123290</td>\n",
       "      <td>grant.2503461</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>295346</td>\n",
       "      <td>grant.2767340</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>295346</td>\n",
       "      <td>grant.2773919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>295346</td>\n",
       "      <td>grant.2772783</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>121628</td>\n",
       "      <td>grant.3771036</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>9981668</td>\n",
       "      <td>grant.6857674</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>5125513</td>\n",
       "      <td>grant.2405739</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>9981671</td>\n",
       "      <td>grant.6857674</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>9981659</td>\n",
       "      <td>grant.6857674</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>9981662</td>\n",
       "      <td>grant.6857674</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          id associated_grant_ids\n",
       "0     796595        grant.2443303\n",
       "1     796595        grant.2622776\n",
       "2     796595        grant.2486583\n",
       "3     796595        grant.2705157\n",
       "4     796595        grant.2484211\n",
       "5     358090        grant.2420507\n",
       "6     358090        grant.2705199\n",
       "7   11570418        grant.2354778\n",
       "8     126649        grant.2489014\n",
       "9     126649        grant.2574938\n",
       "10    126649        grant.2607733\n",
       "11    126649        grant.2607806\n",
       "12    907007        grant.3637460\n",
       "13    987570        grant.2537759\n",
       "14    987570        grant.2543242\n",
       "15    244574        grant.2786397\n",
       "16    244574        grant.2784260\n",
       "17    244574        grant.2765320\n",
       "18   5241121        grant.2549057\n",
       "19   5241121        grant.2550729\n",
       "20   5241121        grant.2408114\n",
       "21   5241121        grant.2485620\n",
       "22   5241121        grant.2580198\n",
       "23   5241121        grant.2588806\n",
       "24   5241121        grant.2550625\n",
       "25   8269316        grant.3493084\n",
       "26   8268155        grant.3493084\n",
       "27   8269319        grant.3493084\n",
       "28   8268152        grant.3493084\n",
       "29   5123290        grant.2445563\n",
       "30   5123290        grant.2503461\n",
       "31    295346        grant.2767340\n",
       "32    295346        grant.2773919\n",
       "33    295346        grant.2772783\n",
       "34    121628        grant.3771036\n",
       "35   9981668        grant.6857674\n",
       "36   5125513        grant.2405739\n",
       "37   9981671        grant.6857674\n",
       "38   9981659        grant.6857674\n",
       "39   9981662        grant.6857674"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search datasets in title_abstract_only for “(depression OR \\“mental disorder\\“) AND (blameworthiness OR definition)” \n",
    "where year in [2010:2020] and associated_grant_ids is not empty \n",
    "return datasets[id + unnest(associated_grant_ids)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "### test with concepts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 813 (total publications= 780371)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>concepts</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>social marketing interventions</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>tropical diseases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>determinants of health</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>marketing interventions</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>systematic review</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>808</th>\n",
       "      <td>pub.1125322330</td>\n",
       "      <td>meaningful IMCI consultations conflicts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>809</th>\n",
       "      <td>pub.1125322330</td>\n",
       "      <td>IMCI consultations conflicts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>810</th>\n",
       "      <td>pub.1125322330</td>\n",
       "      <td>consultations conflicts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>811</th>\n",
       "      <td>pub.1125322330</td>\n",
       "      <td>meaningful strategic recommendations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>812</th>\n",
       "      <td>pub.1125322330</td>\n",
       "      <td>IMCI program effectiveness</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>813 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id                                 concepts\n",
       "0    pub.1124196727           social marketing interventions\n",
       "1    pub.1124196727                        tropical diseases\n",
       "2    pub.1124196727                   determinants of health\n",
       "3    pub.1124196727                  marketing interventions\n",
       "4    pub.1124196727                        systematic review\n",
       "..              ...                                      ...\n",
       "808  pub.1125322330  meaningful IMCI consultations conflicts\n",
       "809  pub.1125322330             IMCI consultations conflicts\n",
       "810  pub.1125322330                  consultations conflicts\n",
       "811  pub.1125322330     meaningful strategic recommendations\n",
       "812  pub.1125322330               IMCI program effectiveness\n",
       "\n",
       "[813 rows x 2 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search publications for \"malaria\" return publications[id+unnest(concepts)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 970 (total grants= 11492)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>concepts</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.9064941</td>\n",
       "      <td>molecular mechanisms</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.9064941</td>\n",
       "      <td>mechanism</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.9064941</td>\n",
       "      <td>sex determination</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9064941</td>\n",
       "      <td>malaria parasites</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9064941</td>\n",
       "      <td>parasites</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>965</th>\n",
       "      <td>grant.9212445</td>\n",
       "      <td>meal</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>966</th>\n",
       "      <td>grant.9212445</td>\n",
       "      <td>RNAi knockdown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>967</th>\n",
       "      <td>grant.9212445</td>\n",
       "      <td>Aedes aegypti</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>968</th>\n",
       "      <td>grant.9212445</td>\n",
       "      <td>aegypti</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>969</th>\n",
       "      <td>grant.9212445</td>\n",
       "      <td>dengue virus</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>970 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                id              concepts\n",
       "0    grant.9064941  molecular mechanisms\n",
       "1    grant.9064941             mechanism\n",
       "2    grant.9064941     sex determination\n",
       "3    grant.9064941     malaria parasites\n",
       "4    grant.9064941             parasites\n",
       "..             ...                   ...\n",
       "965  grant.9212445                  meal\n",
       "966  grant.9212445        RNAi knockdown\n",
       "967  grant.9212445         Aedes aegypti\n",
       "968  grant.9212445               aegypti\n",
       "969  grant.9212445          dengue virus\n",
       "\n",
       "[970 rows x 2 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search grants for \"malaria\" return grants[id+unnest(concepts)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "### Test with all multivalue fields (either entity or not)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: publications\n",
      "***********************\n",
      "Fields:  ['category_icrp_cso', 'research_org_state_names', 'research_org_countries', 'category_rcdc', 'supporting_grant_ids', 'category_bra', 'category_icrp_ct', 'reference_ids', 'mesh_terms', 'research_org_country_names', 'category_hrcs_hc', 'category_hrcs_rac', 'referenced_pubs', 'journal_lists', 'category_uoa', 'category_hra', 'researchers', 'category_sdg', 'research_org_state_codes', 'category_for', 'funders', 'research_org_names', 'research_orgs', 'funder_countries', 'issn', 'research_org_cities', 'authors', 'open_access_categories']\n",
      "\n",
      "====\n",
      " search publications where category_icrp_cso is not empty return publications[id+unnest(category_icrp_cso)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 24 (total publications= 2466114)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_cso.id</th>\n",
       "      <th>category_icrp_cso.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1117132771</td>\n",
       "      <td>3755</td>\n",
       "      <td>3.1 Interventions to Prevent Cancer: Personal ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1127678261</td>\n",
       "      <td>3766</td>\n",
       "      <td>5.2 Localized Therapies - Clinical Applications</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1125149605</td>\n",
       "      <td>3772</td>\n",
       "      <td>6.1 Patient Care and Survivorship Issues</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1125149605</td>\n",
       "      <td>3751</td>\n",
       "      <td>2.1 Exogenous Factors in the Origin and Cause ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1129380669</td>\n",
       "      <td>3763</td>\n",
       "      <td>4.3 Technology and/or Marker Testing in a Clin...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_icrp_cso.id  \\\n",
       "0  pub.1117132771                 3755   \n",
       "1  pub.1127678261                 3766   \n",
       "2  pub.1125149605                 3772   \n",
       "3  pub.1125149605                 3751   \n",
       "4  pub.1129380669                 3763   \n",
       "\n",
       "                              category_icrp_cso.name  \n",
       "0  3.1 Interventions to Prevent Cancer: Personal ...  \n",
       "1    5.2 Localized Therapies - Clinical Applications  \n",
       "2           6.1 Patient Care and Survivorship Issues  \n",
       "3  2.1 Exogenous Factors in the Origin and Cause ...  \n",
       "4  4.3 Technology and/or Marker Testing in a Clin...  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where research_org_state_names is not empty return publications[id+unnest(research_org_state_names)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 33 (total publications= 21564635)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_state_names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>New Jersey</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1128218814</td>\n",
       "      <td>Ontario</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124948447</td>\n",
       "      <td>Massachusetts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1128226413</td>\n",
       "      <td>Massachusetts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1128910744</td>\n",
       "      <td>Victoria</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id research_org_state_names\n",
       "0  pub.1124649186               New Jersey\n",
       "1  pub.1128218814                  Ontario\n",
       "2  pub.1124948447            Massachusetts\n",
       "3  pub.1128226413            Massachusetts\n",
       "4  pub.1128910744                 Victoria"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where research_org_countries is not empty return publications[id+unnest(research_org_countries)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 32 (total publications= 58252223)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_countries.id</th>\n",
       "      <th>research_org_countries.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>CH</td>\n",
       "      <td>Switzerland</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>IN</td>\n",
       "      <td>India</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>FR</td>\n",
       "      <td>France</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>MG</td>\n",
       "      <td>Madagascar</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id research_org_countries.id research_org_countries.name\n",
       "0  pub.1124196727                        CH                 Switzerland\n",
       "1  pub.1124099280                        IN                       India\n",
       "2  pub.1124099280                        FR                      France\n",
       "3  pub.1124649186                        US               United States\n",
       "4  pub.1124649186                        MG                  Madagascar"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where category_rcdc is not empty return publications[id+unnest(category_rcdc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 104 (total publications= 23412085)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_rcdc.id</th>\n",
       "      <th>category_rcdc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>498</td>\n",
       "      <td>Behavioral and Social Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>558</td>\n",
       "      <td>Prevention</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>507</td>\n",
       "      <td>Clinical Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>533</td>\n",
       "      <td>Infectious Diseases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>559</td>\n",
       "      <td>Rare Diseases</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_rcdc.id             category_rcdc.name\n",
       "0  pub.1124196727              498  Behavioral and Social Science\n",
       "1  pub.1124196727              558                     Prevention\n",
       "2  pub.1124196727              507              Clinical Research\n",
       "3  pub.1124099280              533            Infectious Diseases\n",
       "4  pub.1124099280              559                  Rare Diseases"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where supporting_grant_ids is not empty return publications[id+unnest(supporting_grant_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 24 (total publications= 7296444)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>supporting_grant_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124056741</td>\n",
       "      <td>grant.4120643</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1125121608</td>\n",
       "      <td>grant.8634904</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1125712694</td>\n",
       "      <td>grant.2718308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1125712694</td>\n",
       "      <td>grant.2725524</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1125923533</td>\n",
       "      <td>grant.3493731</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id supporting_grant_ids\n",
       "0  pub.1124056741        grant.4120643\n",
       "1  pub.1125121608        grant.8634904\n",
       "2  pub.1125712694        grant.2718308\n",
       "3  pub.1125712694        grant.2725524\n",
       "4  pub.1125923533        grant.3493731"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where category_bra is not empty return publications[id+unnest(category_bra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total publications= 13971755)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_bra.id</th>\n",
       "      <th>category_bra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>4003</td>\n",
       "      <td>Public Health</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>4003</td>\n",
       "      <td>Public Health</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>4003</td>\n",
       "      <td>Public Health</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1125117746</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124012124</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_bra.id              category_bra.name\n",
       "0  pub.1124196727            4003                  Public Health\n",
       "1  pub.1124099280            4003                  Public Health\n",
       "2  pub.1124649186            4003                  Public Health\n",
       "3  pub.1125117746            4001  Clinical Medicine and Science\n",
       "4  pub.1124012124            4001  Clinical Medicine and Science"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where category_icrp_ct is not empty return publications[id+unnest(category_icrp_ct)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 23 (total publications= 4736265)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_ct.id</th>\n",
       "      <th>category_icrp_ct.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1117132771</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1127491594</td>\n",
       "      <td>3808</td>\n",
       "      <td>Liver Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1128779542</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124668399</td>\n",
       "      <td>3817</td>\n",
       "      <td>Oral Cavity and Lip Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124654429</td>\n",
       "      <td>3809</td>\n",
       "      <td>Lung Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_icrp_ct.id       category_icrp_ct.name\n",
       "0  pub.1117132771                3816    Not Site-Specific Cancer\n",
       "1  pub.1127491594                3808                Liver Cancer\n",
       "2  pub.1128779542                3816    Not Site-Specific Cancer\n",
       "3  pub.1124668399                3817  Oral Cavity and Lip Cancer\n",
       "4  pub.1124654429                3809                 Lung Cancer"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where reference_ids is not empty return publications[id+unnest(reference_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 655 (total publications= 53629281)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>reference_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1038918292</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1013186597</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1014886490</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1055483856</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1084252865</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id   reference_ids\n",
       "0  pub.1124196727  pub.1038918292\n",
       "1  pub.1124196727  pub.1013186597\n",
       "2  pub.1124196727  pub.1014886490\n",
       "3  pub.1124196727  pub.1055483856\n",
       "4  pub.1124196727  pub.1084252865"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where mesh_terms is not empty return publications[id+unnest(mesh_terms)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 209 (total publications= 26896118)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>mesh_terms</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124480133</td>\n",
       "      <td>Animals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124480133</td>\n",
       "      <td>DNA, Ribosomal</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124480133</td>\n",
       "      <td>DNA, Ribosomal Spacer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124480133</td>\n",
       "      <td>Humans</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124480133</td>\n",
       "      <td>Insect Vectors</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id             mesh_terms\n",
       "0  pub.1124480133                Animals\n",
       "1  pub.1124480133         DNA, Ribosomal\n",
       "2  pub.1124480133  DNA, Ribosomal Spacer\n",
       "3  pub.1124480133                 Humans\n",
       "4  pub.1124480133         Insect Vectors"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where research_org_country_names is not empty return publications[id+unnest(research_org_country_names)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 32 (total publications= 58252223)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_country_names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>Switzerland</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>India</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>France</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>Madagascar</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id research_org_country_names\n",
       "0  pub.1124196727                Switzerland\n",
       "1  pub.1124099280                      India\n",
       "2  pub.1124099280                     France\n",
       "3  pub.1124649186              United States\n",
       "4  pub.1124649186                 Madagascar"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where category_hrcs_hc is not empty return publications[id+unnest(category_hrcs_hc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total publications= 11574081)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_hc.id</th>\n",
       "      <th>category_hrcs_hc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>890</td>\n",
       "      <td>Generic Health Relevance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>898</td>\n",
       "      <td>Infection</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1125117746</td>\n",
       "      <td>905</td>\n",
       "      <td>Mental Health</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124012124</td>\n",
       "      <td>905</td>\n",
       "      <td>Mental Health</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124873363</td>\n",
       "      <td>905</td>\n",
       "      <td>Mental Health</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_hrcs_hc.id     category_hrcs_hc.name\n",
       "0  pub.1124196727                 890  Generic Health Relevance\n",
       "1  pub.1124099280                 898                 Infection\n",
       "2  pub.1125117746                 905             Mental Health\n",
       "3  pub.1124012124                 905             Mental Health\n",
       "4  pub.1124873363                 905             Mental Health"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where category_hrcs_rac is not empty return publications[id+unnest(category_hrcs_rac)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 46 (total publications= 7493588)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_rac.id</th>\n",
       "      <th>category_hrcs_rac.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>10204</td>\n",
       "      <td>2.4 Surveillance and distribution</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>10200</td>\n",
       "      <td>2 Aetiology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>10800</td>\n",
       "      <td>8 Health and Social Care Services Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>10801</td>\n",
       "      <td>8.1 Organisation and delivery of services</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124012124</td>\n",
       "      <td>10606</td>\n",
       "      <td>6.6 Psychological and behavioural</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_hrcs_rac.id  \\\n",
       "0  pub.1124196727                10204   \n",
       "1  pub.1124196727                10200   \n",
       "2  pub.1124099280                10800   \n",
       "3  pub.1124099280                10801   \n",
       "4  pub.1124012124                10606   \n",
       "\n",
       "                       category_hrcs_rac.name  \n",
       "0           2.4 Surveillance and distribution  \n",
       "1                                 2 Aetiology  \n",
       "2  8 Health and Social Care Services Research  \n",
       "3   8.1 Organisation and delivery of services  \n",
       "4           6.6 Psychological and behavioural  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where referenced_pubs is not empty return publications[id+unnest(referenced_pubs)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 655 (total publications= 53629281)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>referenced_pubs.id</th>\n",
       "      <th>referenced_pubs.doi</th>\n",
       "      <th>referenced_pubs.pmid</th>\n",
       "      <th>referenced_pubs.pmcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1038918292</td>\n",
       "      <td>10.1509/jppm.21.1.3.17602</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1013186597</td>\n",
       "      <td>10.1093/heapro/dau083</td>\n",
       "      <td>25231058</td>\n",
       "      <td>PMC4327339</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1014886490</td>\n",
       "      <td>10.1016/j.jbusres.2015.03.023</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1055483856</td>\n",
       "      <td>10.1021/es00002a709</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>pub.1084252865</td>\n",
       "      <td>10.1186/s40249-017-0288-0</td>\n",
       "      <td>28372566</td>\n",
       "      <td>PMC5379574</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id referenced_pubs.id            referenced_pubs.doi  \\\n",
       "0  pub.1124196727     pub.1038918292      10.1509/jppm.21.1.3.17602   \n",
       "1  pub.1124196727     pub.1013186597          10.1093/heapro/dau083   \n",
       "2  pub.1124196727     pub.1014886490  10.1016/j.jbusres.2015.03.023   \n",
       "3  pub.1124196727     pub.1055483856            10.1021/es00002a709   \n",
       "4  pub.1124196727     pub.1084252865      10.1186/s40249-017-0288-0   \n",
       "\n",
       "  referenced_pubs.pmid referenced_pubs.pmcid  \n",
       "0                  NaN                   NaN  \n",
       "1             25231058            PMC4327339  \n",
       "2                  NaN                   NaN  \n",
       "3                  NaN                   NaN  \n",
       "4             28372566            PMC5379574  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where journal_lists is not empty return publications[id+unnest(journal_lists)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 74 (total publications= 82590418)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>journal_lists</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>VABB-SHW</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>ERA 2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>Norwegian register level 1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>DOAJ</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>ERA 2015</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id               journal_lists\n",
       "0  pub.1124196727                    VABB-SHW\n",
       "1  pub.1124196727                    ERA 2018\n",
       "2  pub.1124196727  Norwegian register level 1\n",
       "3  pub.1124196727                        DOAJ\n",
       "4  pub.1124196727                    ERA 2015"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where category_uoa is not empty return publications[id+unnest(category_uoa)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total publications= 55654884)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_uoa.id</th>\n",
       "      <th>category_uoa.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>30003</td>\n",
       "      <td>A03 Allied Health Professions, Dentistry, Nurs...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>30002</td>\n",
       "      <td>A02 Public Health, Health Services and Primary...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>30002</td>\n",
       "      <td>A02 Public Health, Health Services and Primary...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1125117746</td>\n",
       "      <td>30004</td>\n",
       "      <td>A04 Psychology, Psychiatry and Neuroscience</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124012124</td>\n",
       "      <td>30004</td>\n",
       "      <td>A04 Psychology, Psychiatry and Neuroscience</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_uoa.id  \\\n",
       "0  pub.1124196727           30003   \n",
       "1  pub.1124099280           30002   \n",
       "2  pub.1124649186           30002   \n",
       "3  pub.1125117746           30004   \n",
       "4  pub.1124012124           30004   \n",
       "\n",
       "                                   category_uoa.name  \n",
       "0  A03 Allied Health Professions, Dentistry, Nurs...  \n",
       "1  A02 Public Health, Health Services and Primary...  \n",
       "2  A02 Public Health, Health Services and Primary...  \n",
       "3        A04 Psychology, Psychiatry and Neuroscience  \n",
       "4        A04 Psychology, Psychiatry and Neuroscience  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where category_hra is not empty return publications[id+unnest(category_hra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total publications= 14076784)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hra.id</th>\n",
       "      <th>category_hra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>3903</td>\n",
       "      <td>Population &amp; Society</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>3903</td>\n",
       "      <td>Population &amp; Society</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>3903</td>\n",
       "      <td>Population &amp; Society</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1125117746</td>\n",
       "      <td>3901</td>\n",
       "      <td>Clinical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124012124</td>\n",
       "      <td>3901</td>\n",
       "      <td>Clinical</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_hra.id     category_hra.name\n",
       "0  pub.1124196727            3903  Population & Society\n",
       "1  pub.1124099280            3903  Population & Society\n",
       "2  pub.1124649186            3903  Population & Society\n",
       "3  pub.1125117746            3901              Clinical\n",
       "4  pub.1124012124            3901              Clinical"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where researchers is not empty return publications[id+unnest(researchers)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 70 (total publications= 71005855)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>researchers.id</th>\n",
       "      <th>researchers.first_name</th>\n",
       "      <th>researchers.last_name</th>\n",
       "      <th>researchers.research_orgs</th>\n",
       "      <th>researchers.orcid_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>ur.07430064243.75</td>\n",
       "      <td>Nathaly</td>\n",
       "      <td>Aya Pastrana</td>\n",
       "      <td>[grid.29078.34]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>ur.0722036447.03</td>\n",
       "      <td>Claire</td>\n",
       "      <td>Somerville</td>\n",
       "      <td>[grid.424404.2]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>ur.0663400406.47</td>\n",
       "      <td>L Suzanne</td>\n",
       "      <td>Suggs</td>\n",
       "      <td>[grid.264797.9, grid.483659.5, grid.7445.2, gr...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>ur.015114237435.63</td>\n",
       "      <td>Mahendra M</td>\n",
       "      <td>Reddy</td>\n",
       "      <td>[grid.414953.e, grid.416263.4]</td>\n",
       "      <td>[0000-0001-9726-6064]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>ur.0670077515.38</td>\n",
       "      <td>Pruthu</td>\n",
       "      <td>Thekkur</td>\n",
       "      <td>[grid.8195.5, grid.483403.8, grid.435357.3, gr...</td>\n",
       "      <td>[0000-0001-5257-5074]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id      researchers.id researchers.first_name  \\\n",
       "0  pub.1124196727   ur.07430064243.75                Nathaly   \n",
       "1  pub.1124196727    ur.0722036447.03                 Claire   \n",
       "2  pub.1124196727    ur.0663400406.47              L Suzanne   \n",
       "3  pub.1124099280  ur.015114237435.63             Mahendra M   \n",
       "4  pub.1124099280    ur.0670077515.38                 Pruthu   \n",
       "\n",
       "  researchers.last_name                          researchers.research_orgs  \\\n",
       "0          Aya Pastrana                                    [grid.29078.34]   \n",
       "1            Somerville                                    [grid.424404.2]   \n",
       "2                 Suggs  [grid.264797.9, grid.483659.5, grid.7445.2, gr...   \n",
       "3                 Reddy                     [grid.414953.e, grid.416263.4]   \n",
       "4               Thekkur  [grid.8195.5, grid.483403.8, grid.435357.3, gr...   \n",
       "\n",
       "    researchers.orcid_id  \n",
       "0                    NaN  \n",
       "1                    NaN  \n",
       "2                    NaN  \n",
       "3  [0000-0001-9726-6064]  \n",
       "4  [0000-0001-5257-5074]  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where category_sdg is not empty return publications[id+unnest(category_sdg)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total publications= 5261480)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_sdg.id</th>\n",
       "      <th>category_sdg.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124959719</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1128689496</td>\n",
       "      <td>40016</td>\n",
       "      <td>16 Peace, Justice and Strong Institutions</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_sdg.id                          category_sdg.name\n",
       "0  pub.1124196727           40003               3 Good Health and Well Being\n",
       "1  pub.1124099280           40003               3 Good Health and Well Being\n",
       "2  pub.1124649186           40003               3 Good Health and Well Being\n",
       "3  pub.1124959719           40003               3 Good Health and Well Being\n",
       "4  pub.1128689496           40016  16 Peace, Justice and Strong Institutions"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where research_org_state_codes is not empty return publications[id+unnest(research_org_state_codes)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 33 (total publications= 21564635)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_state_codes.id</th>\n",
       "      <th>research_org_state_codes.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>US-NJ</td>\n",
       "      <td>New Jersey</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1128218814</td>\n",
       "      <td>CA-ON</td>\n",
       "      <td>Ontario</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124948447</td>\n",
       "      <td>US-MA</td>\n",
       "      <td>Massachusetts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1128226413</td>\n",
       "      <td>US-MA</td>\n",
       "      <td>Massachusetts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1128910744</td>\n",
       "      <td>AU-VIC</td>\n",
       "      <td>Victoria</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id research_org_state_codes.id research_org_state_codes.name\n",
       "0  pub.1124649186                       US-NJ                    New Jersey\n",
       "1  pub.1128218814                       CA-ON                       Ontario\n",
       "2  pub.1124948447                       US-MA                 Massachusetts\n",
       "3  pub.1128226413                       US-MA                 Massachusetts\n",
       "4  pub.1128910744                      AU-VIC                      Victoria"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where category_for is not empty return publications[id+unnest(category_for)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 48 (total publications= 82081679)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_for.id</th>\n",
       "      <th>category_for.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>3177</td>\n",
       "      <td>1117 Public Health and Health Services</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>2211</td>\n",
       "      <td>11 Medical and Health Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>3177</td>\n",
       "      <td>1117 Public Health and Health Services</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>2211</td>\n",
       "      <td>11 Medical and Health Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>3053</td>\n",
       "      <td>1103 Clinical Sciences</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id category_for.id                       category_for.name\n",
       "0  pub.1124196727            3177  1117 Public Health and Health Services\n",
       "1  pub.1124196727            2211          11 Medical and Health Sciences\n",
       "2  pub.1124099280            3177  1117 Public Health and Health Services\n",
       "3  pub.1124099280            2211          11 Medical and Health Sciences\n",
       "4  pub.1124099280            3053                  1103 Clinical Sciences"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where funders is not empty return publications[id+unnest(funders)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 26 (total publications= 12456620)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funders.id</th>\n",
       "      <th>funders.name</th>\n",
       "      <th>funders.acronym</th>\n",
       "      <th>funders.linkout</th>\n",
       "      <th>funders.country_name</th>\n",
       "      <th>funders.city_name</th>\n",
       "      <th>funders.latitude</th>\n",
       "      <th>funders.longitude</th>\n",
       "      <th>funders.types</th>\n",
       "      <th>funders.state_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124056741</td>\n",
       "      <td>grid.420488.2</td>\n",
       "      <td>Dutch Research Council</td>\n",
       "      <td>NWO</td>\n",
       "      <td>[http://www.nwo.nl/]</td>\n",
       "      <td>Netherlands</td>\n",
       "      <td>The Hague</td>\n",
       "      <td>52.080480</td>\n",
       "      <td>4.344407</td>\n",
       "      <td>[Government]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124056741</td>\n",
       "      <td>grid.37640.36</td>\n",
       "      <td>South London and Maudsley NHS Foundation Trust</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[http://www.slam.nhs.uk/]</td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>London</td>\n",
       "      <td>51.468727</td>\n",
       "      <td>-0.092638</td>\n",
       "      <td>[Healthcare]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124056741</td>\n",
       "      <td>grid.451056.3</td>\n",
       "      <td>National Institute for Health Research</td>\n",
       "      <td>NIHR</td>\n",
       "      <td>[http://www.nihr.ac.uk/]</td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>London</td>\n",
       "      <td>51.502705</td>\n",
       "      <td>-0.125350</td>\n",
       "      <td>[Government]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124012127</td>\n",
       "      <td>grid.483733.8</td>\n",
       "      <td>Fundación Alicia Koplowitz</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[https://www.fundacionaliciakoplowitz.org/]</td>\n",
       "      <td>Spain</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>40.461178</td>\n",
       "      <td>-3.686480</td>\n",
       "      <td>[Nonprofit]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1127332794</td>\n",
       "      <td>grid.418309.7</td>\n",
       "      <td>Bill &amp; Melinda Gates Foundation</td>\n",
       "      <td>BMGF</td>\n",
       "      <td>[http://www.gatesfoundation.org/]</td>\n",
       "      <td>United States</td>\n",
       "      <td>Seattle</td>\n",
       "      <td>47.623610</td>\n",
       "      <td>-122.345560</td>\n",
       "      <td>[Nonprofit]</td>\n",
       "      <td>Washington</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id     funders.id  \\\n",
       "0  pub.1124056741  grid.420488.2   \n",
       "1  pub.1124056741  grid.37640.36   \n",
       "2  pub.1124056741  grid.451056.3   \n",
       "3  pub.1124012127  grid.483733.8   \n",
       "4  pub.1127332794  grid.418309.7   \n",
       "\n",
       "                                     funders.name funders.acronym  \\\n",
       "0                          Dutch Research Council             NWO   \n",
       "1  South London and Maudsley NHS Foundation Trust             NaN   \n",
       "2          National Institute for Health Research            NIHR   \n",
       "3                      Fundación Alicia Koplowitz             NaN   \n",
       "4                 Bill & Melinda Gates Foundation           BMGF    \n",
       "\n",
       "                               funders.linkout funders.country_name  \\\n",
       "0                         [http://www.nwo.nl/]          Netherlands   \n",
       "1                    [http://www.slam.nhs.uk/]       United Kingdom   \n",
       "2                     [http://www.nihr.ac.uk/]       United Kingdom   \n",
       "3  [https://www.fundacionaliciakoplowitz.org/]                Spain   \n",
       "4            [http://www.gatesfoundation.org/]        United States   \n",
       "\n",
       "  funders.city_name  funders.latitude  funders.longitude funders.types  \\\n",
       "0         The Hague         52.080480           4.344407  [Government]   \n",
       "1            London         51.468727          -0.092638  [Healthcare]   \n",
       "2            London         51.502705          -0.125350  [Government]   \n",
       "3            Madrid         40.461178          -3.686480   [Nonprofit]   \n",
       "4           Seattle         47.623610        -122.345560   [Nonprofit]   \n",
       "\n",
       "  funders.state_name  \n",
       "0                NaN  \n",
       "1                NaN  \n",
       "2                NaN  \n",
       "3                NaN  \n",
       "4         Washington  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where research_org_names is not empty return publications[id+unnest(research_org_names)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 69 (total publications= 62210219)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>Universita della Svizzera Italiana</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>Graduate Institute of International and Develo...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>Swiss School of Public Health</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>Jawaharlal Institute of Post Graduate Medical ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>Department of Community Medicine, Sri Devaraj ...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id                                 research_org_names\n",
       "0  pub.1124196727                 Universita della Svizzera Italiana\n",
       "1  pub.1124196727  Graduate Institute of International and Develo...\n",
       "2  pub.1124196727                      Swiss School of Public Health\n",
       "3  pub.1124099280  Jawaharlal Institute of Post Graduate Medical ...\n",
       "4  pub.1124099280  Department of Community Medicine, Sri Devaraj ..."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where research_orgs is not empty return publications[id+unnest(research_orgs)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 54 (total publications= 48887996)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_orgs.id</th>\n",
       "      <th>research_orgs.name</th>\n",
       "      <th>research_orgs.acronym</th>\n",
       "      <th>research_orgs.linkout</th>\n",
       "      <th>research_orgs.country_name</th>\n",
       "      <th>research_orgs.city_name</th>\n",
       "      <th>research_orgs.latitude</th>\n",
       "      <th>research_orgs.longitude</th>\n",
       "      <th>research_orgs.types</th>\n",
       "      <th>research_orgs.state_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>grid.424404.2</td>\n",
       "      <td>Graduate Institute of International and Develo...</td>\n",
       "      <td>IHEID</td>\n",
       "      <td>[http://graduateinstitute.ch/home.html]</td>\n",
       "      <td>Switzerland</td>\n",
       "      <td>Geneva</td>\n",
       "      <td>46.220810</td>\n",
       "      <td>6.143778</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>grid.483659.5</td>\n",
       "      <td>Swiss School of Public Health</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[http://www.ssphplus.ch/sharepoint/startseite_...</td>\n",
       "      <td>Switzerland</td>\n",
       "      <td>Zurich</td>\n",
       "      <td>47.375465</td>\n",
       "      <td>8.545143</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>grid.29078.34</td>\n",
       "      <td>University of Italian Switzerland</td>\n",
       "      <td>USI</td>\n",
       "      <td>[http://www.usi.ch/en/index.htm]</td>\n",
       "      <td>Switzerland</td>\n",
       "      <td>Lugano</td>\n",
       "      <td>46.011000</td>\n",
       "      <td>8.958000</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>Ticino</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>grid.452679.b</td>\n",
       "      <td>National AIDS Control Organisation</td>\n",
       "      <td>NACO</td>\n",
       "      <td>[http://www.naco.gov.in/NACO/]</td>\n",
       "      <td>India</td>\n",
       "      <td>New Delhi</td>\n",
       "      <td>28.615486</td>\n",
       "      <td>77.218610</td>\n",
       "      <td>[Government]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>grid.414953.e</td>\n",
       "      <td>Jawaharlal Institute of Post Graduate Medical ...</td>\n",
       "      <td>JIPMER</td>\n",
       "      <td>[http://jipmer.edu.in/]</td>\n",
       "      <td>India</td>\n",
       "      <td>Puducherry</td>\n",
       "      <td>11.954301</td>\n",
       "      <td>79.796960</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id research_orgs.id  \\\n",
       "0  pub.1124196727    grid.424404.2   \n",
       "1  pub.1124196727    grid.483659.5   \n",
       "2  pub.1124196727    grid.29078.34   \n",
       "3  pub.1124099280    grid.452679.b   \n",
       "4  pub.1124099280    grid.414953.e   \n",
       "\n",
       "                                  research_orgs.name research_orgs.acronym  \\\n",
       "0  Graduate Institute of International and Develo...                 IHEID   \n",
       "1                      Swiss School of Public Health                   NaN   \n",
       "2                  University of Italian Switzerland                   USI   \n",
       "3                 National AIDS Control Organisation                  NACO   \n",
       "4  Jawaharlal Institute of Post Graduate Medical ...                JIPMER   \n",
       "\n",
       "                               research_orgs.linkout  \\\n",
       "0            [http://graduateinstitute.ch/home.html]   \n",
       "1  [http://www.ssphplus.ch/sharepoint/startseite_...   \n",
       "2                   [http://www.usi.ch/en/index.htm]   \n",
       "3                     [http://www.naco.gov.in/NACO/]   \n",
       "4                            [http://jipmer.edu.in/]   \n",
       "\n",
       "  research_orgs.country_name research_orgs.city_name  research_orgs.latitude  \\\n",
       "0                Switzerland                  Geneva               46.220810   \n",
       "1                Switzerland                  Zurich               47.375465   \n",
       "2                Switzerland                  Lugano               46.011000   \n",
       "3                      India               New Delhi               28.615486   \n",
       "4                      India              Puducherry               11.954301   \n",
       "\n",
       "   research_orgs.longitude research_orgs.types research_orgs.state_name  \n",
       "0                 6.143778         [Education]                      NaN  \n",
       "1                 8.545143         [Education]                      NaN  \n",
       "2                 8.958000         [Education]                   Ticino  \n",
       "3                77.218610        [Government]                      NaN  \n",
       "4                79.796960         [Education]                      NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where funder_countries is not empty return publications[id+unnest(funder_countries)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 23 (total publications= 12456620)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funder_countries.id</th>\n",
       "      <th>funder_countries.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124056741</td>\n",
       "      <td>NL</td>\n",
       "      <td>Netherlands</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124056741</td>\n",
       "      <td>GB</td>\n",
       "      <td>United Kingdom</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124012127</td>\n",
       "      <td>ES</td>\n",
       "      <td>Spain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1127332794</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1127332794</td>\n",
       "      <td>GB</td>\n",
       "      <td>United Kingdom</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id funder_countries.id funder_countries.name\n",
       "0  pub.1124056741                  NL           Netherlands\n",
       "1  pub.1124056741                  GB        United Kingdom\n",
       "2  pub.1124012127                  ES                 Spain\n",
       "3  pub.1127332794                  US         United States\n",
       "4  pub.1127332794                  GB        United Kingdom"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where issn is not empty return publications[id+unnest(issn)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 39 (total publications= 95704921)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>issn</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>1654-9716</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>1654-9880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>1654-9716</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>1654-9880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124649186</td>\n",
       "      <td>1654-9716</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id       issn\n",
       "0  pub.1124196727  1654-9716\n",
       "1  pub.1124196727  1654-9880\n",
       "2  pub.1124099280  1654-9716\n",
       "3  pub.1124099280  1654-9880\n",
       "4  pub.1124649186  1654-9716"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where research_org_cities is not empty return publications[id+unnest(research_org_cities)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 59 (total publications= 56651421)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_cities.id</th>\n",
       "      <th>research_org_cities.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>2657896</td>\n",
       "      <td>Zürich</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>2659836</td>\n",
       "      <td>Lugano</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>2660646</td>\n",
       "      <td>Genève</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>1259425</td>\n",
       "      <td>Puducherry</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124099280</td>\n",
       "      <td>1266305</td>\n",
       "      <td>Kolār</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id  research_org_cities.id research_org_cities.name\n",
       "0  pub.1124196727                 2657896                   Zürich\n",
       "1  pub.1124196727                 2659836                   Lugano\n",
       "2  pub.1124196727                 2660646                   Genève\n",
       "3  pub.1124099280                 1259425               Puducherry\n",
       "4  pub.1124099280                 1266305                    Kolār"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where authors is not empty return publications[id+unnest(authors)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 45 (total publications= 101368535)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>authors.first_name</th>\n",
       "      <th>authors.last_name</th>\n",
       "      <th>authors.corresponding</th>\n",
       "      <th>authors.orcid</th>\n",
       "      <th>authors.affiliations</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1125801740</td>\n",
       "      <td>Nienke</td>\n",
       "      <td>Bakker</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1125801740</td>\n",
       "      <td>Christopher</td>\n",
       "      <td>Riopelle</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1096916023</td>\n",
       "      <td>Jochen</td>\n",
       "      <td>Taupitz</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>Nathaly</td>\n",
       "      <td>Aya Pastrana</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[{'raw_affiliation': 'BeCHANGE Research Group,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>Claire</td>\n",
       "      <td>Somerville</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[{'raw_affiliation': 'Gender Centre, Graduate ...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id authors.first_name authors.last_name authors.corresponding  \\\n",
       "0  pub.1125801740             Nienke            Bakker                         \n",
       "1  pub.1125801740        Christopher          Riopelle                         \n",
       "2  pub.1096916023             Jochen           Taupitz                         \n",
       "3  pub.1124196727            Nathaly      Aya Pastrana                         \n",
       "4  pub.1124196727             Claire        Somerville                         \n",
       "\n",
       "  authors.orcid                               authors.affiliations  \n",
       "0                                                               []  \n",
       "1                                                               []  \n",
       "2                                                               []  \n",
       "3                [{'raw_affiliation': 'BeCHANGE Research Group,...  \n",
       "4                [{'raw_affiliation': 'Gender Centre, Graduate ...  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where open_access_categories is not empty return publications[id+unnest(open_access_categories)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 23 (total publications= 111617075)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>open_access_categories.id</th>\n",
       "      <th>open_access_categories.name</th>\n",
       "      <th>open_access_categories.description</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1125801740</td>\n",
       "      <td>closed</td>\n",
       "      <td>Closed</td>\n",
       "      <td>No freely available copy has been identified</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1125632078</td>\n",
       "      <td>closed</td>\n",
       "      <td>Closed</td>\n",
       "      <td>No freely available copy has been identified</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1096916023</td>\n",
       "      <td>closed</td>\n",
       "      <td>Closed</td>\n",
       "      <td>No freely available copy has been identified</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>oa_all</td>\n",
       "      <td>All OA</td>\n",
       "      <td>Article is freely available</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>gold_bronze</td>\n",
       "      <td>Bronze</td>\n",
       "      <td>Freely available on publisher page, but withou...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id open_access_categories.id open_access_categories.name  \\\n",
       "0  pub.1125801740                    closed                      Closed   \n",
       "1  pub.1125632078                    closed                      Closed   \n",
       "2  pub.1096916023                    closed                      Closed   \n",
       "3  pub.1124196727                    oa_all                      All OA   \n",
       "4  pub.1124196727               gold_bronze                      Bronze   \n",
       "\n",
       "                  open_access_categories.description  \n",
       "0       No freely available copy has been identified  \n",
       "1       No freely available copy has been identified  \n",
       "2       No freely available copy has been identified  \n",
       "3                        Article is freely available  \n",
       "4  Freely available on publisher page, but withou...  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: grants\n",
      "***********************\n",
      "Fields:  ['category_icrp_cso', 'research_org_countries', 'category_rcdc', 'category_bra', 'category_icrp_ct', 'concepts', 'category_hrcs_hc', 'category_hrcs_rac', 'category_uoa', 'category_hra', 'research_org_state_codes', 'category_sdg', 'active_year', 'category_for', 'funders', 'research_org_names', 'research_orgs', 'funder_countries', 'research_org_cities', 'researchers']\n",
      "\n",
      "====\n",
      " search grants where category_icrp_cso is not empty return grants[id+unnest(category_icrp_cso)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 28 (total grants= 286107)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_cso.id</th>\n",
       "      <th>category_icrp_cso.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.9064950</td>\n",
       "      <td>3746</td>\n",
       "      <td>1.1 Normal Functioning</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.9064955</td>\n",
       "      <td>3746</td>\n",
       "      <td>1.1 Normal Functioning</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.9065061</td>\n",
       "      <td>3748</td>\n",
       "      <td>1.3 Cancer Initiation: Oncogenes and Tumor Sup...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9065061</td>\n",
       "      <td>3752</td>\n",
       "      <td>2.2 Endogenous Factors in the Origin and Cause...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9244668</td>\n",
       "      <td>3746</td>\n",
       "      <td>1.1 Normal Functioning</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_icrp_cso.id  \\\n",
       "0  grant.9064950                 3746   \n",
       "1  grant.9064955                 3746   \n",
       "2  grant.9065061                 3748   \n",
       "3  grant.9065061                 3752   \n",
       "4  grant.9244668                 3746   \n",
       "\n",
       "                              category_icrp_cso.name  \n",
       "0                             1.1 Normal Functioning  \n",
       "1                             1.1 Normal Functioning  \n",
       "2  1.3 Cancer Initiation: Oncogenes and Tumor Sup...  \n",
       "3  2.2 Endogenous Factors in the Origin and Cause...  \n",
       "4                             1.1 Normal Functioning  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where research_org_countries is not empty return grants[id+unnest(research_org_countries)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 25 (total grants= 5250200)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_countries.id</th>\n",
       "      <th>research_org_countries.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>NL</td>\n",
       "      <td>Netherlands</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>NL</td>\n",
       "      <td>Netherlands</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>CA</td>\n",
       "      <td>Canada</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>BE</td>\n",
       "      <td>Belgium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>HU</td>\n",
       "      <td>Hungary</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id research_org_countries.id research_org_countries.name\n",
       "0  grant.6946936                        NL                 Netherlands\n",
       "1  grant.6946936                        NL                 Netherlands\n",
       "2  grant.8690978                        CA                      Canada\n",
       "3  grant.8950252                        BE                     Belgium\n",
       "4  grant.9064813                        HU                     Hungary"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where category_rcdc is not empty return grants[id+unnest(category_rcdc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 65 (total grants= 1622626)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_rcdc.id</th>\n",
       "      <th>category_rcdc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>331</td>\n",
       "      <td>Cardiovascular</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>445</td>\n",
       "      <td>Heart Disease</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>338</td>\n",
       "      <td>Biotechnology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>526</td>\n",
       "      <td>Genetics</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9244665</td>\n",
       "      <td>503</td>\n",
       "      <td>Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_rcdc.id category_rcdc.name\n",
       "0  grant.8690978              331     Cardiovascular\n",
       "1  grant.8690978              445      Heart Disease\n",
       "2  grant.8950252              338      Biotechnology\n",
       "3  grant.8950252              526           Genetics\n",
       "4  grant.9244665              503             Cancer"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where category_bra is not empty return grants[id+unnest(category_bra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total grants= 1035370)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_bra.id</th>\n",
       "      <th>category_bra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>4000</td>\n",
       "      <td>Basic Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.9244665</td>\n",
       "      <td>4000</td>\n",
       "      <td>Basic Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9244550</td>\n",
       "      <td>4000</td>\n",
       "      <td>Basic Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9065032</td>\n",
       "      <td>4003</td>\n",
       "      <td>Public Health</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_bra.id              category_bra.name\n",
       "0  grant.8690978            4001  Clinical Medicine and Science\n",
       "1  grant.8950252            4000                  Basic Science\n",
       "2  grant.9244665            4000                  Basic Science\n",
       "3  grant.9244550            4000                  Basic Science\n",
       "4  grant.9065032            4003                  Public Health"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where category_icrp_ct is not empty return grants[id+unnest(category_icrp_ct)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total grants= 339502)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_ct.id</th>\n",
       "      <th>category_icrp_ct.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.9244665</td>\n",
       "      <td>3790</td>\n",
       "      <td>Breast Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.9064723</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.9064950</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9064955</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9065061</td>\n",
       "      <td>3807</td>\n",
       "      <td>Leukemia / Leukaemia</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_icrp_ct.id     category_icrp_ct.name\n",
       "0  grant.9244665                3790             Breast Cancer\n",
       "1  grant.9064723                3816  Not Site-Specific Cancer\n",
       "2  grant.9064950                3816  Not Site-Specific Cancer\n",
       "3  grant.9064955                3816  Not Site-Specific Cancer\n",
       "4  grant.9065061                3807      Leukemia / Leukaemia"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where concepts is not empty return grants[id+unnest(concepts)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 1108 (total grants= 4949973)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>concepts</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>alarm response</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>response</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>ungulate herds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>herds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>poaching</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id        concepts\n",
       "0  grant.6946936  alarm response\n",
       "1  grant.6946936        response\n",
       "2  grant.6946936  ungulate herds\n",
       "3  grant.6946936           herds\n",
       "4  grant.6946936        poaching"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where category_hrcs_hc is not empty return grants[id+unnest(category_hrcs_hc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 24 (total grants= 1034011)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_hc.id</th>\n",
       "      <th>category_hrcs_hc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>894</td>\n",
       "      <td>Cardiovascular</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>890</td>\n",
       "      <td>Generic Health Relevance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>890</td>\n",
       "      <td>Generic Health Relevance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9244665</td>\n",
       "      <td>911</td>\n",
       "      <td>Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9244550</td>\n",
       "      <td>897</td>\n",
       "      <td>Neurological</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_hrcs_hc.id     category_hrcs_hc.name\n",
       "0  grant.8690978                 894            Cardiovascular\n",
       "1  grant.8950252                 890  Generic Health Relevance\n",
       "2  grant.9064813                 890  Generic Health Relevance\n",
       "3  grant.9244665                 911                    Cancer\n",
       "4  grant.9244550                 897              Neurological"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where category_hrcs_rac is not empty return grants[id+unnest(category_hrcs_rac)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 56 (total grants= 838322)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_rac.id</th>\n",
       "      <th>category_hrcs_rac.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>10100</td>\n",
       "      <td>1 Underpinning Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>10101</td>\n",
       "      <td>1.1 Normal biological development and functioning</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.9244665</td>\n",
       "      <td>10201</td>\n",
       "      <td>2.1 Biological and endogenous factors</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9244665</td>\n",
       "      <td>10200</td>\n",
       "      <td>2 Aetiology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9244550</td>\n",
       "      <td>10101</td>\n",
       "      <td>1.1 Normal biological development and functioning</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_hrcs_rac.id  \\\n",
       "0  grant.8950252                10100   \n",
       "1  grant.8950252                10101   \n",
       "2  grant.9244665                10201   \n",
       "3  grant.9244665                10200   \n",
       "4  grant.9244550                10101   \n",
       "\n",
       "                              category_hrcs_rac.name  \n",
       "0                            1 Underpinning Research  \n",
       "1  1.1 Normal biological development and functioning  \n",
       "2              2.1 Biological and endogenous factors  \n",
       "3                                        2 Aetiology  \n",
       "4  1.1 Normal biological development and functioning  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where category_uoa is not empty return grants[id+unnest(category_uoa)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total grants= 3545035)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_uoa.id</th>\n",
       "      <th>category_uoa.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>30014</td>\n",
       "      <td>C14 Geography and Environmental Studies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>30002</td>\n",
       "      <td>A02 Public Health, Health Services and Primary...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>30005</td>\n",
       "      <td>A05 Biological Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>30019</td>\n",
       "      <td>C19 Politics and International Studies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.8715161</td>\n",
       "      <td>30030</td>\n",
       "      <td>D30 Philosophy</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_uoa.id  \\\n",
       "0  grant.6946936           30014   \n",
       "1  grant.8690978           30002   \n",
       "2  grant.8950252           30005   \n",
       "3  grant.9064813           30019   \n",
       "4  grant.8715161           30030   \n",
       "\n",
       "                                   category_uoa.name  \n",
       "0            C14 Geography and Environmental Studies  \n",
       "1  A02 Public Health, Health Services and Primary...  \n",
       "2                            A05 Biological Sciences  \n",
       "3             C19 Politics and International Studies  \n",
       "4                                     D30 Philosophy  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where category_hra is not empty return grants[id+unnest(category_hra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total grants= 1168734)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hra.id</th>\n",
       "      <th>category_hra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.9244665</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.9244550</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9064723</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9065598</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_hra.id category_hra.name\n",
       "0  grant.8950252            3900        Biomedical\n",
       "1  grant.9244665            3900        Biomedical\n",
       "2  grant.9244550            3900        Biomedical\n",
       "3  grant.9064723            3900        Biomedical\n",
       "4  grant.9065598            3900        Biomedical"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where research_org_state_codes is not empty return grants[id+unnest(research_org_state_codes)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 26 (total grants= 1988370)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_state_codes.id</th>\n",
       "      <th>research_org_state_codes.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>CA-NB</td>\n",
       "      <td>New Brunswick</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>CA-ON</td>\n",
       "      <td>Ontario</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.9284620</td>\n",
       "      <td>US-NY</td>\n",
       "      <td>New York</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9284620</td>\n",
       "      <td>US-NY</td>\n",
       "      <td>New York</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.8857915</td>\n",
       "      <td>US-MI</td>\n",
       "      <td>Michigan</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id research_org_state_codes.id research_org_state_codes.name\n",
       "0  grant.8690978                       CA-NB                 New Brunswick\n",
       "1  grant.9064813                       CA-ON                       Ontario\n",
       "2  grant.9284620                       US-NY                      New York\n",
       "3  grant.9284620                       US-NY                      New York\n",
       "4  grant.8857915                       US-MI                      Michigan"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where category_sdg is not empty return grants[id+unnest(category_sdg)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total grants= 558091)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_sdg.id</th>\n",
       "      <th>category_sdg.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>40015</td>\n",
       "      <td>15 Life on Land</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>40005</td>\n",
       "      <td>5 Gender Equality</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9179204</td>\n",
       "      <td>40007</td>\n",
       "      <td>7 Affordable and Clean Energy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9064723</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_sdg.id              category_sdg.name\n",
       "0  grant.6946936           40015                15 Life on Land\n",
       "1  grant.8690978           40003   3 Good Health and Well Being\n",
       "2  grant.9064813           40005              5 Gender Equality\n",
       "3  grant.9179204           40007  7 Affordable and Clean Energy\n",
       "4  grant.9064723           40003   3 Good Health and Well Being"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where active_year is not empty return grants[id+unnest(active_year)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 54 (total grants= 5455132)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>active_year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>2022</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id  active_year\n",
       "0  grant.6946936         2021\n",
       "1  grant.8690978         2021\n",
       "2  grant.8950252         2021\n",
       "3  grant.9064813         2021\n",
       "4  grant.9064813         2022"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where category_for is not empty return grants[id+unnest(category_for)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 68 (total grants= 3547371)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_for.id</th>\n",
       "      <th>category_for.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>2558</td>\n",
       "      <td>0502 Environmental Science and Management</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>2597</td>\n",
       "      <td>0602 Ecology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>2205</td>\n",
       "      <td>05 Environmental Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>2206</td>\n",
       "      <td>06 Biological Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>2790</td>\n",
       "      <td>0806 Information Systems</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_for.id                          category_for.name\n",
       "0  grant.6946936            2558  0502 Environmental Science and Management\n",
       "1  grant.6946936            2597                               0602 Ecology\n",
       "2  grant.6946936            2205                  05 Environmental Sciences\n",
       "3  grant.6946936            2206                     06 Biological Sciences\n",
       "4  grant.8690978            2790                   0806 Information Systems"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where funders is not empty return grants[id+unnest(funders)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total grants= 5485590)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funders.id</th>\n",
       "      <th>funders.name</th>\n",
       "      <th>funders.acronym</th>\n",
       "      <th>funders.linkout</th>\n",
       "      <th>funders.country_name</th>\n",
       "      <th>funders.city_name</th>\n",
       "      <th>funders.latitude</th>\n",
       "      <th>funders.longitude</th>\n",
       "      <th>funders.types</th>\n",
       "      <th>funders.state_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>grid.420488.2</td>\n",
       "      <td>Dutch Research Council</td>\n",
       "      <td>NWO</td>\n",
       "      <td>[http://www.nwo.nl/]</td>\n",
       "      <td>Netherlands</td>\n",
       "      <td>The Hague</td>\n",
       "      <td>52.080480</td>\n",
       "      <td>4.344407</td>\n",
       "      <td>[Government]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>grid.484521.e</td>\n",
       "      <td>New Brunswick Health Research Foundation</td>\n",
       "      <td>NBHRF</td>\n",
       "      <td>[http://www.nbhrf.com/?lipi=urn%3Ali%3Apage%3A...</td>\n",
       "      <td>Canada</td>\n",
       "      <td>Fredericton</td>\n",
       "      <td>45.931892</td>\n",
       "      <td>-66.660590</td>\n",
       "      <td>[Nonprofit]</td>\n",
       "      <td>New Brunswick</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>grid.424470.1</td>\n",
       "      <td>Fund for Scientific Research</td>\n",
       "      <td>FRS FNRS</td>\n",
       "      <td>[http://www.fnrs.be/]</td>\n",
       "      <td>Belgium</td>\n",
       "      <td>Brussels</td>\n",
       "      <td>50.836940</td>\n",
       "      <td>4.370708</td>\n",
       "      <td>[Nonprofit]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>grid.270680.b</td>\n",
       "      <td>European Commission</td>\n",
       "      <td>EC</td>\n",
       "      <td>[http://ec.europa.eu/index_en.htm]</td>\n",
       "      <td>Belgium</td>\n",
       "      <td>Brussels</td>\n",
       "      <td>50.851650</td>\n",
       "      <td>4.363670</td>\n",
       "      <td>[Government]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.8715161</td>\n",
       "      <td>grid.25111.36</td>\n",
       "      <td>FWF Austrian Science Fund</td>\n",
       "      <td>FWF</td>\n",
       "      <td>[https://www.fwf.ac.at/en/]</td>\n",
       "      <td>Austria</td>\n",
       "      <td>Vienna</td>\n",
       "      <td>48.219303</td>\n",
       "      <td>16.352383</td>\n",
       "      <td>[Nonprofit]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id     funders.id                              funders.name  \\\n",
       "0  grant.6946936  grid.420488.2                    Dutch Research Council   \n",
       "1  grant.8690978  grid.484521.e  New Brunswick Health Research Foundation   \n",
       "2  grant.8950252  grid.424470.1              Fund for Scientific Research   \n",
       "3  grant.9064813  grid.270680.b                       European Commission   \n",
       "4  grant.8715161  grid.25111.36                 FWF Austrian Science Fund   \n",
       "\n",
       "  funders.acronym                                    funders.linkout  \\\n",
       "0             NWO                               [http://www.nwo.nl/]   \n",
       "1           NBHRF  [http://www.nbhrf.com/?lipi=urn%3Ali%3Apage%3A...   \n",
       "2        FRS FNRS                              [http://www.fnrs.be/]   \n",
       "3              EC                 [http://ec.europa.eu/index_en.htm]   \n",
       "4             FWF                        [https://www.fwf.ac.at/en/]   \n",
       "\n",
       "  funders.country_name funders.city_name  funders.latitude  funders.longitude  \\\n",
       "0          Netherlands         The Hague         52.080480           4.344407   \n",
       "1               Canada       Fredericton         45.931892         -66.660590   \n",
       "2              Belgium          Brussels         50.836940           4.370708   \n",
       "3              Belgium          Brussels         50.851650           4.363670   \n",
       "4              Austria            Vienna         48.219303          16.352383   \n",
       "\n",
       "  funders.types funders.state_name  \n",
       "0  [Government]                NaN  \n",
       "1   [Nonprofit]      New Brunswick  \n",
       "2   [Nonprofit]                NaN  \n",
       "3  [Government]                NaN  \n",
       "4   [Nonprofit]                NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where research_org_names is not empty return grants[id+unnest(research_org_names)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total grants= 5208637)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>Van Hall Larenstein University of Applied Scie...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>Horizon Health Network</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>Catholic University of Louvain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>University of Toronto</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>Central European University</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id                                 research_org_names\n",
       "0  grant.6946936  Van Hall Larenstein University of Applied Scie...\n",
       "1  grant.8690978                             Horizon Health Network\n",
       "2  grant.8950252                     Catholic University of Louvain\n",
       "3  grant.9064813                              University of Toronto\n",
       "4  grant.9064813                        Central European University"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where research_orgs is not empty return grants[id+unnest(research_orgs)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total grants= 4871948)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_orgs.id</th>\n",
       "      <th>research_orgs.name</th>\n",
       "      <th>research_orgs.linkout</th>\n",
       "      <th>research_orgs.country_name</th>\n",
       "      <th>research_orgs.city_name</th>\n",
       "      <th>research_orgs.latitude</th>\n",
       "      <th>research_orgs.longitude</th>\n",
       "      <th>research_orgs.types</th>\n",
       "      <th>research_orgs.state_name</th>\n",
       "      <th>research_orgs.acronym</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>grid.450080.9</td>\n",
       "      <td>Van Hall Larenstein University of Applied Scie...</td>\n",
       "      <td>[http://www.vhluniversity.com/vhl-studies.aspx]</td>\n",
       "      <td>Netherlands</td>\n",
       "      <td>Leeuwarden</td>\n",
       "      <td>53.194458</td>\n",
       "      <td>5.801940</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>grid.428748.5</td>\n",
       "      <td>Horizon Health Network</td>\n",
       "      <td>[http://en.horizonnb.ca/]</td>\n",
       "      <td>Canada</td>\n",
       "      <td>Miramichi</td>\n",
       "      <td>45.301910</td>\n",
       "      <td>-66.084630</td>\n",
       "      <td>[Healthcare]</td>\n",
       "      <td>New Brunswick</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>grid.7942.8</td>\n",
       "      <td>Catholic University of Louvain</td>\n",
       "      <td>[http://www.uclouvain.be/en-index.html]</td>\n",
       "      <td>Belgium</td>\n",
       "      <td>Louvain-la-Neuve</td>\n",
       "      <td>50.669613</td>\n",
       "      <td>4.612264</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>UCL</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>grid.5146.6</td>\n",
       "      <td>Central European University</td>\n",
       "      <td>[http://www.ceu.edu/]</td>\n",
       "      <td>Hungary</td>\n",
       "      <td>Budapest</td>\n",
       "      <td>47.500347</td>\n",
       "      <td>19.051785</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CEU</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>grid.17063.33</td>\n",
       "      <td>University of Toronto</td>\n",
       "      <td>[http://www.utoronto.ca/]</td>\n",
       "      <td>Canada</td>\n",
       "      <td>Toronto</td>\n",
       "      <td>43.661667</td>\n",
       "      <td>-79.395000</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>Ontario</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id research_orgs.id  \\\n",
       "0  grant.6946936    grid.450080.9   \n",
       "1  grant.8690978    grid.428748.5   \n",
       "2  grant.8950252      grid.7942.8   \n",
       "3  grant.9064813      grid.5146.6   \n",
       "4  grant.9064813    grid.17063.33   \n",
       "\n",
       "                                  research_orgs.name  \\\n",
       "0  Van Hall Larenstein University of Applied Scie...   \n",
       "1                             Horizon Health Network   \n",
       "2                     Catholic University of Louvain   \n",
       "3                        Central European University   \n",
       "4                              University of Toronto   \n",
       "\n",
       "                             research_orgs.linkout research_orgs.country_name  \\\n",
       "0  [http://www.vhluniversity.com/vhl-studies.aspx]                Netherlands   \n",
       "1                        [http://en.horizonnb.ca/]                     Canada   \n",
       "2          [http://www.uclouvain.be/en-index.html]                    Belgium   \n",
       "3                            [http://www.ceu.edu/]                    Hungary   \n",
       "4                        [http://www.utoronto.ca/]                     Canada   \n",
       "\n",
       "  research_orgs.city_name  research_orgs.latitude  research_orgs.longitude  \\\n",
       "0              Leeuwarden               53.194458                 5.801940   \n",
       "1               Miramichi               45.301910               -66.084630   \n",
       "2        Louvain-la-Neuve               50.669613                 4.612264   \n",
       "3                Budapest               47.500347                19.051785   \n",
       "4                 Toronto               43.661667               -79.395000   \n",
       "\n",
       "  research_orgs.types research_orgs.state_name research_orgs.acronym  \n",
       "0         [Education]                      NaN                   NaN  \n",
       "1        [Healthcare]            New Brunswick                   NaN  \n",
       "2         [Education]                      NaN                   UCL  \n",
       "3         [Education]                      NaN                   CEU  \n",
       "4         [Education]                  Ontario                   NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where funder_countries is not empty return grants[id+unnest(funder_countries)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total grants= 5485590)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funder_countries.id</th>\n",
       "      <th>funder_countries.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>NL</td>\n",
       "      <td>Netherlands</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>CA</td>\n",
       "      <td>Canada</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>BE</td>\n",
       "      <td>Belgium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>BE</td>\n",
       "      <td>Belgium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.8715161</td>\n",
       "      <td>AT</td>\n",
       "      <td>Austria</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id funder_countries.id funder_countries.name\n",
       "0  grant.6946936                  NL           Netherlands\n",
       "1  grant.8690978                  CA                Canada\n",
       "2  grant.8950252                  BE               Belgium\n",
       "3  grant.9064813                  BE               Belgium\n",
       "4  grant.8715161                  AT               Austria"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where research_org_cities is not empty return grants[id+unnest(research_org_cities)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 25 (total grants= 4991080)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_cities.id</th>\n",
       "      <th>research_org_cities.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>2751792</td>\n",
       "      <td>Leeuwarden</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>2751792</td>\n",
       "      <td>Leeuwarden</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>6075081</td>\n",
       "      <td>Miramichi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>2792073</td>\n",
       "      <td>Louvain-la-Neuve</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9064813</td>\n",
       "      <td>3054643</td>\n",
       "      <td>Budapest</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id  research_org_cities.id research_org_cities.name\n",
       "0  grant.6946936                 2751792               Leeuwarden\n",
       "1  grant.6946936                 2751792               Leeuwarden\n",
       "2  grant.8690978                 6075081                Miramichi\n",
       "3  grant.8950252                 2792073         Louvain-la-Neuve\n",
       "4  grant.9064813                 3054643                 Budapest"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search grants where researchers is not empty return grants[id+unnest(researchers)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total grants= 4848379)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>researchers.id</th>\n",
       "      <th>researchers.first_name</th>\n",
       "      <th>researchers.last_name</th>\n",
       "      <th>researchers.research_orgs</th>\n",
       "      <th>researchers.orcid_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>ur.0765112007.90</td>\n",
       "      <td>Martinus Jacobus Antonius</td>\n",
       "      <td>Weterings</td>\n",
       "      <td>[grid.4818.5, grid.450080.9, grid.4830.f]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>ur.01103433444.38</td>\n",
       "      <td>Sohrab R</td>\n",
       "      <td>Lutchmedial</td>\n",
       "      <td>[grid.63984.30, grid.55602.34, grid.416505.3, ...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>ur.0674515014.41</td>\n",
       "      <td>Corentin</td>\n",
       "      <td>Claeys Bouuaert</td>\n",
       "      <td>[grid.7942.8, grid.51462.34]</td>\n",
       "      <td>[0000-0001-5801-7313]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.8715161</td>\n",
       "      <td>ur.016564317465.72</td>\n",
       "      <td>Charles</td>\n",
       "      <td>Wolfe</td>\n",
       "      <td>[grid.7520.0]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.8857915</td>\n",
       "      <td>ur.07527230477.18</td>\n",
       "      <td>Gabriel S</td>\n",
       "      <td>Mendlow</td>\n",
       "      <td>[grid.214458.e]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id      researchers.id     researchers.first_name  \\\n",
       "0  grant.6946936    ur.0765112007.90  Martinus Jacobus Antonius   \n",
       "1  grant.8690978   ur.01103433444.38                   Sohrab R   \n",
       "2  grant.8950252    ur.0674515014.41                   Corentin   \n",
       "3  grant.8715161  ur.016564317465.72                    Charles   \n",
       "4  grant.8857915   ur.07527230477.18                  Gabriel S   \n",
       "\n",
       "  researchers.last_name                          researchers.research_orgs  \\\n",
       "0             Weterings          [grid.4818.5, grid.450080.9, grid.4830.f]   \n",
       "1           Lutchmedial  [grid.63984.30, grid.55602.34, grid.416505.3, ...   \n",
       "2       Claeys Bouuaert                       [grid.7942.8, grid.51462.34]   \n",
       "3                 Wolfe                                      [grid.7520.0]   \n",
       "4               Mendlow                                    [grid.214458.e]   \n",
       "\n",
       "    researchers.orcid_id  \n",
       "0                    NaN  \n",
       "1                    NaN  \n",
       "2  [0000-0001-5801-7313]  \n",
       "3                    NaN  \n",
       "4                    NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: patents\n",
      "***********************\n",
      "Fields:  ['category_icrp_cso', 'category_rcdc', 'additional_filters', 'reference_ids', 'category_bra', 'category_icrp_ct', 'cited_by_ids', 'assignee_cities', 'category_hrcs_hc', 'category_hrcs_rac', 'publications', 'current_assignee_names', 'ipcr', 'category_hra', 'researchers', 'original_assignees', 'cpc', 'associated_grant_ids', 'assignees', 'category_for', 'funders', 'current_assignees', 'assignee_names', 'assignee_countries', 'publication_ids', 'funder_countries', 'assignee_state_codes', 'original_assignee_names']\n",
      "\n",
      "====\n",
      " search patents where category_icrp_cso is not empty return patents[id+unnest(category_icrp_cso)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total patents= 154346)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_cso.id</th>\n",
       "      <th>category_icrp_cso.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>WO-2009148654-A2</td>\n",
       "      <td>3767</td>\n",
       "      <td>5.3 Systemic Therapies - Discovery and Develop...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AU-2008205459-A2</td>\n",
       "      <td>3746</td>\n",
       "      <td>1.1 Normal Functioning</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AU-2008205459-A2</td>\n",
       "      <td>3750</td>\n",
       "      <td>1.5 Resources and Infrastructure</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>GB-0918822-D0</td>\n",
       "      <td>3767</td>\n",
       "      <td>5.3 Systemic Therapies - Discovery and Develop...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-2138179-A1</td>\n",
       "      <td>3767</td>\n",
       "      <td>5.3 Systemic Therapies - Discovery and Develop...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id category_icrp_cso.id  \\\n",
       "0  WO-2009148654-A2                 3767   \n",
       "1  AU-2008205459-A2                 3746   \n",
       "2  AU-2008205459-A2                 3750   \n",
       "3     GB-0918822-D0                 3767   \n",
       "4     EP-2138179-A1                 3767   \n",
       "\n",
       "                              category_icrp_cso.name  \n",
       "0  5.3 Systemic Therapies - Discovery and Develop...  \n",
       "1                             1.1 Normal Functioning  \n",
       "2                   1.5 Resources and Infrastructure  \n",
       "3  5.3 Systemic Therapies - Discovery and Develop...  \n",
       "4  5.3 Systemic Therapies - Discovery and Develop...  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where category_rcdc is not empty return patents[id+unnest(category_rcdc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 33 (total patents= 4581907)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_rcdc.id</th>\n",
       "      <th>category_rcdc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-0850417-B2</td>\n",
       "      <td>503</td>\n",
       "      <td>Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>GB-2460638-A</td>\n",
       "      <td>507</td>\n",
       "      <td>Clinical Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-2130033-A2</td>\n",
       "      <td>337</td>\n",
       "      <td>Bioengineering</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-2131404-A3</td>\n",
       "      <td>521</td>\n",
       "      <td>Eye Disease and Disorders of Vision</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-2131651-A1</td>\n",
       "      <td>387</td>\n",
       "      <td>Neurosciences</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_rcdc.id                   category_rcdc.name\n",
       "0  EP-0850417-B2              503                               Cancer\n",
       "1   GB-2460638-A              507                    Clinical Research\n",
       "2  EP-2130033-A2              337                       Bioengineering\n",
       "3  EP-2131404-A3              521  Eye Disease and Disorders of Vision\n",
       "4  EP-2131651-A1              387                        Neurosciences"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where additional_filters is not empty return patents[id+unnest(additional_filters)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total patents= 1410973)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>additional_filters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>GB-2460638-A</td>\n",
       "      <td>Research Organization</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-2130555-A1</td>\n",
       "      <td>Research Organization</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-2131721-A1</td>\n",
       "      <td>Research Organization</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2684875-A1</td>\n",
       "      <td>Research Organization</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>DE-102008026713-A1</td>\n",
       "      <td>Research Organization</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   id     additional_filters\n",
       "0        GB-2460638-A  Research Organization\n",
       "1       EP-2130555-A1  Research Organization\n",
       "2       EP-2131721-A1  Research Organization\n",
       "3       CA-2684875-A1  Research Organization\n",
       "4  DE-102008026713-A1  Research Organization"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where reference_ids is not empty return patents[id+unnest(reference_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 53 (total patents= 21767708)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>reference_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-0747276-B2</td>\n",
       "      <td>US-4646242-A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>GB-2460642-A</td>\n",
       "      <td>AU-2006235856-B1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GB-2460642-A</td>\n",
       "      <td>WO-2001069000-A1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>GB-2460642-A</td>\n",
       "      <td>WO-2005111341-A1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-2129934-A1</td>\n",
       "      <td>US-5651748-A</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id     reference_ids\n",
       "0  EP-0747276-B2      US-4646242-A\n",
       "1   GB-2460642-A  AU-2006235856-B1\n",
       "2   GB-2460642-A  WO-2001069000-A1\n",
       "3   GB-2460642-A  WO-2005111341-A1\n",
       "4  EP-2129934-A1      US-5651748-A"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where category_bra is not empty return patents[id+unnest(category_bra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total patents= 935320)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_bra.id</th>\n",
       "      <th>category_bra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-0850417-B2</td>\n",
       "      <td>4000</td>\n",
       "      <td>Basic Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-2131651-A1</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>WO-2009156873-A1</td>\n",
       "      <td>4000</td>\n",
       "      <td>Basic Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-1728532-B1</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CA-2416480-C</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id category_bra.id              category_bra.name\n",
       "0     EP-0850417-B2            4000                  Basic Science\n",
       "1     EP-2131651-A1            4001  Clinical Medicine and Science\n",
       "2  WO-2009156873-A1            4000                  Basic Science\n",
       "3     EP-1728532-B1            4001  Clinical Medicine and Science\n",
       "4      CA-2416480-C            4001  Clinical Medicine and Science"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where category_icrp_ct is not empty return patents[id+unnest(category_icrp_ct)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 34 (total patents= 413449)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_ct.id</th>\n",
       "      <th>category_icrp_ct.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1990065-B1</td>\n",
       "      <td>3790</td>\n",
       "      <td>Breast Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2683629-A1</td>\n",
       "      <td>3810</td>\n",
       "      <td>Melanoma</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>WO-2009148654-A2</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NZ-549408-A</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NZ-549408-A</td>\n",
       "      <td>3790</td>\n",
       "      <td>Breast Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id category_icrp_ct.id     category_icrp_ct.name\n",
       "0     EP-1990065-B1                3790             Breast Cancer\n",
       "1     CA-2683629-A1                3810                  Melanoma\n",
       "2  WO-2009148654-A2                3816  Not Site-Specific Cancer\n",
       "3       NZ-549408-A                3816  Not Site-Specific Cancer\n",
       "4       NZ-549408-A                3790             Breast Cancer"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where cited_by_ids is not empty return patents[id+unnest(cited_by_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 87 (total patents= 14931033)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>cited_by_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>WO-2009149128-A2</td>\n",
       "      <td>US-9392310-B2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-0861808-B1</td>\n",
       "      <td>US-8551341-B2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-2130167-A1</td>\n",
       "      <td>US-9904771-B2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-2130167-A1</td>\n",
       "      <td>US-9177110-B1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-2130167-A1</td>\n",
       "      <td>US-9852272-B1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id   cited_by_ids\n",
       "0  WO-2009149128-A2  US-9392310-B2\n",
       "1     EP-0861808-B1  US-8551341-B2\n",
       "2     EP-2130167-A1  US-9904771-B2\n",
       "3     EP-2130167-A1  US-9177110-B1\n",
       "4     EP-2130167-A1  US-9852272-B1"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where assignee_cities is not empty return patents[id+unnest(assignee_cities)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 25 (total patents= 23852937)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>assignee_cities.id</th>\n",
       "      <th>assignee_cities.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>2825297</td>\n",
       "      <td>Stuttgart</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>4954380</td>\n",
       "      <td>Waltham</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-0861808-B1</td>\n",
       "      <td>1850147</td>\n",
       "      <td>Tokyo</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-0850417-B2</td>\n",
       "      <td>2886242</td>\n",
       "      <td>Köln</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-0805365-B1</td>\n",
       "      <td>1850147</td>\n",
       "      <td>Tokyo</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id  assignee_cities.id assignee_cities.name\n",
       "0  EP-1409282-B1             2825297            Stuttgart\n",
       "1  EP-0868664-B1             4954380              Waltham\n",
       "2  EP-0861808-B1             1850147                Tokyo\n",
       "3  EP-0850417-B2             2886242                 Köln\n",
       "4  EP-0805365-B1             1850147                Tokyo"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where category_hrcs_hc is not empty return patents[id+unnest(category_hrcs_hc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total patents= 1077606)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_hc.id</th>\n",
       "      <th>category_hrcs_hc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-2131725-A1</td>\n",
       "      <td>894</td>\n",
       "      <td>Cardiovascular</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>DE-602004023858-D1</td>\n",
       "      <td>906</td>\n",
       "      <td>Metabolic and Endocrine</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AU-2009233659-A1</td>\n",
       "      <td>902</td>\n",
       "      <td>Ear</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-1737425-B1</td>\n",
       "      <td>898</td>\n",
       "      <td>Infection</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-1728532-B1</td>\n",
       "      <td>894</td>\n",
       "      <td>Cardiovascular</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   id category_hrcs_hc.id    category_hrcs_hc.name\n",
       "0       EP-2131725-A1                 894           Cardiovascular\n",
       "1  DE-602004023858-D1                 906  Metabolic and Endocrine\n",
       "2    AU-2009233659-A1                 902                      Ear\n",
       "3       EP-1737425-B1                 898                Infection\n",
       "4       EP-1728532-B1                 894           Cardiovascular"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where category_hrcs_rac is not empty return patents[id+unnest(category_hrcs_rac)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 40 (total patents= 607748)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_rac.id</th>\n",
       "      <th>category_hrcs_rac.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-2131725-A1</td>\n",
       "      <td>10401</td>\n",
       "      <td>4.1 Discovery and preclinical testing of marke...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-2131725-A1</td>\n",
       "      <td>10400</td>\n",
       "      <td>4 Detection, Screening and Diagnosis</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>WO-2009158477-A1</td>\n",
       "      <td>10501</td>\n",
       "      <td>5.1 Pharmaceuticals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>WO-2009158477-A1</td>\n",
       "      <td>10500</td>\n",
       "      <td>5 Development of Treatments and Therapeutic In...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AU-2006234627-C1</td>\n",
       "      <td>10501</td>\n",
       "      <td>5.1 Pharmaceuticals</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id category_hrcs_rac.id  \\\n",
       "0     EP-2131725-A1                10401   \n",
       "1     EP-2131725-A1                10400   \n",
       "2  WO-2009158477-A1                10501   \n",
       "3  WO-2009158477-A1                10500   \n",
       "4  AU-2006234627-C1                10501   \n",
       "\n",
       "                              category_hrcs_rac.name  \n",
       "0  4.1 Discovery and preclinical testing of marke...  \n",
       "1               4 Detection, Screening and Diagnosis  \n",
       "2                                5.1 Pharmaceuticals  \n",
       "3  5 Development of Treatments and Therapeutic In...  \n",
       "4                                5.1 Pharmaceuticals  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where publications is not empty return patents[id+unnest(publications)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 45 (total patents= 1667333)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publications.id</th>\n",
       "      <th>publications.doi</th>\n",
       "      <th>publications.pmid</th>\n",
       "      <th>publications.pmcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>GB-2460638-A</td>\n",
       "      <td>pub.1040866712</td>\n",
       "      <td>10.1016/j.bbamem.2008.06.017</td>\n",
       "      <td>18655769</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-2131651-A1</td>\n",
       "      <td>pub.1051424394</td>\n",
       "      <td>10.1016/j.pbb.2004.12.005</td>\n",
       "      <td>15680187</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GB-2460584-A</td>\n",
       "      <td>pub.1063922419</td>\n",
       "      <td>10.1177/104239159200400301</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>GB-2460571-A</td>\n",
       "      <td>pub.1016596399</td>\n",
       "      <td>10.1111/j.1365-3040.1989.tb02123.x</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-2131952-A1</td>\n",
       "      <td>pub.1052080023</td>\n",
       "      <td>10.1016/s0376-7388(00)00535-4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id publications.id                    publications.doi  \\\n",
       "0   GB-2460638-A  pub.1040866712        10.1016/j.bbamem.2008.06.017   \n",
       "1  EP-2131651-A1  pub.1051424394           10.1016/j.pbb.2004.12.005   \n",
       "2   GB-2460584-A  pub.1063922419          10.1177/104239159200400301   \n",
       "3   GB-2460571-A  pub.1016596399  10.1111/j.1365-3040.1989.tb02123.x   \n",
       "4  EP-2131952-A1  pub.1052080023       10.1016/s0376-7388(00)00535-4   \n",
       "\n",
       "  publications.pmid publications.pmcid  \n",
       "0          18655769                NaN  \n",
       "1          15680187                NaN  \n",
       "2               NaN                NaN  \n",
       "3               NaN                NaN  \n",
       "4               NaN                NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where current_assignee_names is not empty return patents[id+unnest(current_assignee_names)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 29 (total patents= 31062540)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>current_assignee_names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>Robert Bosch GmbH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>Dionex Corp</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-0861808-B1</td>\n",
       "      <td>Kuraray Co Ltd</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-0860530-B1</td>\n",
       "      <td>Indutex SpA</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-0850417-B2</td>\n",
       "      <td>Miltenyi Biotec GmbH</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id current_assignee_names\n",
       "0  EP-1409282-B1      Robert Bosch GmbH\n",
       "1  EP-0868664-B1            Dionex Corp\n",
       "2  EP-0861808-B1         Kuraray Co Ltd\n",
       "3  EP-0860530-B1            Indutex SpA\n",
       "4  EP-0850417-B2   Miltenyi Biotec GmbH"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where ipcr is not empty return patents[id+unnest(ipcr)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 82 (total patents= 37427045)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>ipcr</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>F16H61/02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>B60K1/02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>F02D29/02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>B60W10/18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>B60W10/10</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id       ipcr\n",
       "0  EP-1409282-B1  F16H61/02\n",
       "1  EP-1409282-B1   B60K1/02\n",
       "2  EP-1409282-B1  F02D29/02\n",
       "3  EP-1409282-B1  B60W10/18\n",
       "4  EP-1409282-B1  B60W10/10"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where category_hra is not empty return patents[id+unnest(category_hra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total patents= 882767)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hra.id</th>\n",
       "      <th>category_hra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-0850417-B2</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>WO-2009158477-A1</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>WO-2009156873-A1</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-1728532-B1</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>WO-2009148654-A2</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id category_hra.id category_hra.name\n",
       "0     EP-0850417-B2            3900        Biomedical\n",
       "1  WO-2009158477-A1            3900        Biomedical\n",
       "2  WO-2009156873-A1            3900        Biomedical\n",
       "3     EP-1728532-B1            3900        Biomedical\n",
       "4  WO-2009148654-A2            3900        Biomedical"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where researchers is not empty return patents[id+unnest(researchers)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 50 (total patents= 664542)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>researchers.id</th>\n",
       "      <th>researchers.first_name</th>\n",
       "      <th>researchers.last_name</th>\n",
       "      <th>researchers.research_orgs</th>\n",
       "      <th>researchers.orcid_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-2130555-A1</td>\n",
       "      <td>ur.0744243704.42</td>\n",
       "      <td>Wilfried</td>\n",
       "      <td>Weber</td>\n",
       "      <td>[grid.419481.1, grid.5801.c, grid.5963.9, grid...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-2130555-A1</td>\n",
       "      <td>ur.0671634306.63</td>\n",
       "      <td>Martin Anton</td>\n",
       "      <td>Fussenegger</td>\n",
       "      <td>[grid.7497.d, grid.22069.3f, grid.6612.3, grid...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-2131721-A1</td>\n",
       "      <td>ur.01355071476.34</td>\n",
       "      <td>Liang</td>\n",
       "      <td>Chen</td>\n",
       "      <td>[grid.266876.b]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>DE-102008026713-A1</td>\n",
       "      <td>ur.0576337551.79</td>\n",
       "      <td>Felix</td>\n",
       "      <td>Baitalow</td>\n",
       "      <td>[grid.6862.a]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>DE-102008026713-A1</td>\n",
       "      <td>ur.01261314263.13</td>\n",
       "      <td>Steffen</td>\n",
       "      <td>Hausdorf</td>\n",
       "      <td>[grid.6862.a]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   id     researchers.id researchers.first_name  \\\n",
       "0       EP-2130555-A1   ur.0744243704.42               Wilfried   \n",
       "1       EP-2130555-A1   ur.0671634306.63           Martin Anton   \n",
       "2       EP-2131721-A1  ur.01355071476.34                  Liang   \n",
       "3  DE-102008026713-A1   ur.0576337551.79                  Felix   \n",
       "4  DE-102008026713-A1  ur.01261314263.13                Steffen   \n",
       "\n",
       "  researchers.last_name                          researchers.research_orgs  \\\n",
       "0                 Weber  [grid.419481.1, grid.5801.c, grid.5963.9, grid...   \n",
       "1           Fussenegger  [grid.7497.d, grid.22069.3f, grid.6612.3, grid...   \n",
       "2                  Chen                                    [grid.266876.b]   \n",
       "3              Baitalow                                      [grid.6862.a]   \n",
       "4              Hausdorf                                      [grid.6862.a]   \n",
       "\n",
       "  researchers.orcid_id  \n",
       "0                  NaN  \n",
       "1                  NaN  \n",
       "2                  NaN  \n",
       "3                  NaN  \n",
       "4                  NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where original_assignees is not empty return patents[id+unnest(original_assignees)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 24 (total patents= 20991384)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>original_assignees.id</th>\n",
       "      <th>original_assignees.name</th>\n",
       "      <th>original_assignees.country_name</th>\n",
       "      <th>original_assignees.city_name</th>\n",
       "      <th>original_assignees.acronym</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>grid.6584.f</td>\n",
       "      <td>Robert Bosch (Germany)</td>\n",
       "      <td>Germany</td>\n",
       "      <td>Stuttgart</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>grid.418190.5</td>\n",
       "      <td>Thermo Fisher Scientific (United States)</td>\n",
       "      <td>United States</td>\n",
       "      <td>Waltham</td>\n",
       "      <td>Life Technologies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-0861808-B1</td>\n",
       "      <td>grid.471210.1</td>\n",
       "      <td>Kuraray (Japan)</td>\n",
       "      <td>Japan</td>\n",
       "      <td>Tokyo</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-0850417-B2</td>\n",
       "      <td>grid.59409.31</td>\n",
       "      <td>Miltenyi Biotec (Germany)</td>\n",
       "      <td>Germany</td>\n",
       "      <td>Cologne</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-0805365-B1</td>\n",
       "      <td>grid.471143.4</td>\n",
       "      <td>Fujikura (Japan)</td>\n",
       "      <td>Japan</td>\n",
       "      <td>Tokyo</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id original_assignees.id  \\\n",
       "0  EP-1409282-B1           grid.6584.f   \n",
       "1  EP-0868664-B1         grid.418190.5   \n",
       "2  EP-0861808-B1         grid.471210.1   \n",
       "3  EP-0850417-B2         grid.59409.31   \n",
       "4  EP-0805365-B1         grid.471143.4   \n",
       "\n",
       "                    original_assignees.name original_assignees.country_name  \\\n",
       "0                    Robert Bosch (Germany)                         Germany   \n",
       "1  Thermo Fisher Scientific (United States)                   United States   \n",
       "2                           Kuraray (Japan)                           Japan   \n",
       "3                 Miltenyi Biotec (Germany)                         Germany   \n",
       "4                          Fujikura (Japan)                           Japan   \n",
       "\n",
       "  original_assignees.city_name original_assignees.acronym  \n",
       "0                    Stuttgart                        NaN  \n",
       "1                      Waltham          Life Technologies  \n",
       "2                        Tokyo                        NaN  \n",
       "3                      Cologne                        NaN  \n",
       "4                        Tokyo                        NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where cpc is not empty return patents[id+unnest(cpc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 169 (total patents= 35397011)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>cpc</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>Y10T477/33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>B60W20/00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>Y02T10/642</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>Y10T477/23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>B60K6/365</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id         cpc\n",
       "0  EP-1409282-B1  Y10T477/33\n",
       "1  EP-1409282-B1   B60W20/00\n",
       "2  EP-1409282-B1  Y02T10/642\n",
       "3  EP-1409282-B1  Y10T477/23\n",
       "4  EP-1409282-B1   B60K6/365"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where associated_grant_ids is not empty return patents[id+unnest(associated_grant_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 30 (total patents= 107866)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>associated_grant_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>US-20020146797-A1</td>\n",
       "      <td>grant.3433112</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>US-6667388-B2</td>\n",
       "      <td>grant.2535080</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>US-6743893-B2</td>\n",
       "      <td>grant.2535896</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-6743893-B2</td>\n",
       "      <td>grant.2438799</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-6656912-B2</td>\n",
       "      <td>grant.2495897</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  id associated_grant_ids\n",
       "0  US-20020146797-A1        grant.3433112\n",
       "1      US-6667388-B2        grant.2535080\n",
       "2      US-6743893-B2        grant.2535896\n",
       "3      US-6743893-B2        grant.2438799\n",
       "4      US-6656912-B2        grant.2495897"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where assignees is not empty return patents[id+unnest(assignees)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 26 (total patents= 23896677)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>assignees.id</th>\n",
       "      <th>assignees.name</th>\n",
       "      <th>assignees.country_name</th>\n",
       "      <th>assignees.city_name</th>\n",
       "      <th>assignees.acronym</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>grid.6584.f</td>\n",
       "      <td>Robert Bosch (Germany)</td>\n",
       "      <td>Germany</td>\n",
       "      <td>Stuttgart</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>grid.418190.5</td>\n",
       "      <td>Thermo Fisher Scientific (United States)</td>\n",
       "      <td>United States</td>\n",
       "      <td>Waltham</td>\n",
       "      <td>Life Technologies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-0861808-B1</td>\n",
       "      <td>grid.471210.1</td>\n",
       "      <td>Kuraray (Japan)</td>\n",
       "      <td>Japan</td>\n",
       "      <td>Tokyo</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-0850417-B2</td>\n",
       "      <td>grid.59409.31</td>\n",
       "      <td>Miltenyi Biotec (Germany)</td>\n",
       "      <td>Germany</td>\n",
       "      <td>Cologne</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-0805365-B1</td>\n",
       "      <td>grid.471143.4</td>\n",
       "      <td>Fujikura (Japan)</td>\n",
       "      <td>Japan</td>\n",
       "      <td>Tokyo</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id   assignees.id                            assignees.name  \\\n",
       "0  EP-1409282-B1    grid.6584.f                    Robert Bosch (Germany)   \n",
       "1  EP-0868664-B1  grid.418190.5  Thermo Fisher Scientific (United States)   \n",
       "2  EP-0861808-B1  grid.471210.1                           Kuraray (Japan)   \n",
       "3  EP-0850417-B2  grid.59409.31                 Miltenyi Biotec (Germany)   \n",
       "4  EP-0805365-B1  grid.471143.4                          Fujikura (Japan)   \n",
       "\n",
       "  assignees.country_name assignees.city_name  assignees.acronym  \n",
       "0                Germany           Stuttgart                NaN  \n",
       "1          United States             Waltham  Life Technologies  \n",
       "2                  Japan               Tokyo                NaN  \n",
       "3                Germany             Cologne                NaN  \n",
       "4                  Japan               Tokyo                NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where category_for is not empty return patents[id+unnest(category_for)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 42 (total patents= 34590974)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_for.id</th>\n",
       "      <th>category_for.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>2867</td>\n",
       "      <td>0906 Electrical and Electronic Engineering</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>2209</td>\n",
       "      <td>09 Engineering</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>WO-2009149128-A2</td>\n",
       "      <td>2790</td>\n",
       "      <td>0806 Information Systems</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>WO-2009149128-A2</td>\n",
       "      <td>2208</td>\n",
       "      <td>08 Information and Computing Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>WO-2009149128-A2</td>\n",
       "      <td>2746</td>\n",
       "      <td>0801 Artificial Intelligence and Image Processing</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id category_for.id  \\\n",
       "0     EP-1409282-B1            2867   \n",
       "1     EP-1409282-B1            2209   \n",
       "2  WO-2009149128-A2            2790   \n",
       "3  WO-2009149128-A2            2208   \n",
       "4  WO-2009149128-A2            2746   \n",
       "\n",
       "                                   category_for.name  \n",
       "0         0906 Electrical and Electronic Engineering  \n",
       "1                                     09 Engineering  \n",
       "2                           0806 Information Systems  \n",
       "3              08 Information and Computing Sciences  \n",
       "4  0801 Artificial Intelligence and Image Processing  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where funders is not empty return patents[id+unnest(funders)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 24 (total patents= 181423)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funders.id</th>\n",
       "      <th>funders.name</th>\n",
       "      <th>funders.acronym</th>\n",
       "      <th>funders.country_name</th>\n",
       "      <th>funders.city_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>US-PP14225-P2</td>\n",
       "      <td>grid.417548.b</td>\n",
       "      <td>United States Department of Agriculture</td>\n",
       "      <td>USDA</td>\n",
       "      <td>United States</td>\n",
       "      <td>Washington D.C.</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>US-20020146797-A1</td>\n",
       "      <td>grid.457768.f</td>\n",
       "      <td>Directorate for Biological Sciences</td>\n",
       "      <td>NSF BIO</td>\n",
       "      <td>United States</td>\n",
       "      <td>Arlington</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>US-20020146797-A1</td>\n",
       "      <td>grid.48336.3a</td>\n",
       "      <td>National Cancer Institute</td>\n",
       "      <td>NCI</td>\n",
       "      <td>United States</td>\n",
       "      <td>Rockville</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-6667388-B2</td>\n",
       "      <td>grid.279885.9</td>\n",
       "      <td>National Heart Lung and Blood Institute</td>\n",
       "      <td>NHLBI</td>\n",
       "      <td>United States</td>\n",
       "      <td>Bethesda</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-6656390-B2</td>\n",
       "      <td>grid.85084.31</td>\n",
       "      <td>United States Department of Energy</td>\n",
       "      <td>DOE</td>\n",
       "      <td>United States</td>\n",
       "      <td>Washington D.C.</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  id     funders.id                             funders.name  \\\n",
       "0      US-PP14225-P2  grid.417548.b  United States Department of Agriculture   \n",
       "1  US-20020146797-A1  grid.457768.f      Directorate for Biological Sciences   \n",
       "2  US-20020146797-A1  grid.48336.3a                National Cancer Institute   \n",
       "3      US-6667388-B2  grid.279885.9  National Heart Lung and Blood Institute   \n",
       "4      US-6656390-B2  grid.85084.31       United States Department of Energy   \n",
       "\n",
       "  funders.acronym funders.country_name funders.city_name  \n",
       "0            USDA        United States   Washington D.C.  \n",
       "1         NSF BIO        United States         Arlington  \n",
       "2             NCI        United States         Rockville  \n",
       "3           NHLBI        United States          Bethesda  \n",
       "4             DOE        United States   Washington D.C.  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where current_assignees is not empty return patents[id+unnest(current_assignees)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 25 (total patents= 19706083)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>current_assignees.id</th>\n",
       "      <th>current_assignees.name</th>\n",
       "      <th>current_assignees.country_name</th>\n",
       "      <th>current_assignees.city_name</th>\n",
       "      <th>current_assignees.acronym</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>grid.6584.f</td>\n",
       "      <td>Robert Bosch (Germany)</td>\n",
       "      <td>Germany</td>\n",
       "      <td>Stuttgart</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>grid.418190.5</td>\n",
       "      <td>Thermo Fisher Scientific (United States)</td>\n",
       "      <td>United States</td>\n",
       "      <td>Waltham</td>\n",
       "      <td>Life Technologies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-0861808-B1</td>\n",
       "      <td>grid.471210.1</td>\n",
       "      <td>Kuraray (Japan)</td>\n",
       "      <td>Japan</td>\n",
       "      <td>Tokyo</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-0850417-B2</td>\n",
       "      <td>grid.59409.31</td>\n",
       "      <td>Miltenyi Biotec (Germany)</td>\n",
       "      <td>Germany</td>\n",
       "      <td>Cologne</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-0805365-B1</td>\n",
       "      <td>grid.471143.4</td>\n",
       "      <td>Fujikura (Japan)</td>\n",
       "      <td>Japan</td>\n",
       "      <td>Tokyo</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id current_assignees.id  \\\n",
       "0  EP-1409282-B1          grid.6584.f   \n",
       "1  EP-0868664-B1        grid.418190.5   \n",
       "2  EP-0861808-B1        grid.471210.1   \n",
       "3  EP-0850417-B2        grid.59409.31   \n",
       "4  EP-0805365-B1        grid.471143.4   \n",
       "\n",
       "                     current_assignees.name current_assignees.country_name  \\\n",
       "0                    Robert Bosch (Germany)                        Germany   \n",
       "1  Thermo Fisher Scientific (United States)                  United States   \n",
       "2                           Kuraray (Japan)                          Japan   \n",
       "3                 Miltenyi Biotec (Germany)                        Germany   \n",
       "4                          Fujikura (Japan)                          Japan   \n",
       "\n",
       "  current_assignees.city_name current_assignees.acronym  \n",
       "0                   Stuttgart                       NaN  \n",
       "1                     Waltham         Life Technologies  \n",
       "2                       Tokyo                       NaN  \n",
       "3                     Cologne                       NaN  \n",
       "4                       Tokyo                       NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where assignee_names is not empty return patents[id+unnest(assignee_names)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 53 (total patents= 39048564)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>assignee_names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>Robert Bosch GmbH</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>BOSCH GMBH ROBERT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>WO-2009149128-A2</td>\n",
       "      <td>SHKEDI ROY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>Dionex Corp</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>DIONEX CORP</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id     assignee_names\n",
       "0     EP-1409282-B1  Robert Bosch GmbH\n",
       "1     EP-1409282-B1  BOSCH GMBH ROBERT\n",
       "2  WO-2009149128-A2         SHKEDI ROY\n",
       "3     EP-0868664-B1        Dionex Corp\n",
       "4     EP-0868664-B1        DIONEX CORP"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where assignee_countries is not empty return patents[id+unnest(assignee_countries)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 24 (total patents= 36421697)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>assignee_countries.id</th>\n",
       "      <th>assignee_countries.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>DE</td>\n",
       "      <td>Germany</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>WO-2009149128-A2</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-0861808-B1</td>\n",
       "      <td>JP</td>\n",
       "      <td>Japan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-0860530-B1</td>\n",
       "      <td>IT</td>\n",
       "      <td>Italy</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id assignee_countries.id assignee_countries.name\n",
       "0     EP-1409282-B1                    DE                 Germany\n",
       "1  WO-2009149128-A2                    US           United States\n",
       "2     EP-0868664-B1                    US           United States\n",
       "3     EP-0861808-B1                    JP                   Japan\n",
       "4     EP-0860530-B1                    IT                   Italy"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where publication_ids is not empty return patents[id+unnest(publication_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 45 (total patents= 1667333)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publication_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>GB-2460638-A</td>\n",
       "      <td>pub.1040866712</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-2131651-A1</td>\n",
       "      <td>pub.1051424394</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GB-2460584-A</td>\n",
       "      <td>pub.1063922419</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>GB-2460571-A</td>\n",
       "      <td>pub.1016596399</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-2131952-A1</td>\n",
       "      <td>pub.1052080023</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id publication_ids\n",
       "0   GB-2460638-A  pub.1040866712\n",
       "1  EP-2131651-A1  pub.1051424394\n",
       "2   GB-2460584-A  pub.1063922419\n",
       "3   GB-2460571-A  pub.1016596399\n",
       "4  EP-2131952-A1  pub.1052080023"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where funder_countries is not empty return patents[id+unnest(funder_countries)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total patents= 181423)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funder_countries.id</th>\n",
       "      <th>funder_countries.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>US-PP14225-P2</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>US-20020146797-A1</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>US-6667388-B2</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-6656390-B2</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-6743893-B2</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                  id funder_countries.id funder_countries.name\n",
       "0      US-PP14225-P2                  US         United States\n",
       "1  US-20020146797-A1                  US         United States\n",
       "2      US-6667388-B2                  US         United States\n",
       "3      US-6656390-B2                  US         United States\n",
       "4      US-6743893-B2                  US         United States"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where assignee_state_codes is not empty return patents[id+unnest(assignee_state_codes)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 22 (total patents= 9361922)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>assignee_state_codes.id</th>\n",
       "      <th>assignee_state_codes.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>US-MA</td>\n",
       "      <td>Massachusetts</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-0747276-B2</td>\n",
       "      <td>US-IL</td>\n",
       "      <td>Illinois</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GB-2460642-A</td>\n",
       "      <td>US-CA</td>\n",
       "      <td>California</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-2129934-A1</td>\n",
       "      <td>US-MI</td>\n",
       "      <td>Michigan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-2131651-A1</td>\n",
       "      <td>US-NY</td>\n",
       "      <td>New York</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id assignee_state_codes.id assignee_state_codes.name\n",
       "0  EP-0868664-B1                   US-MA             Massachusetts\n",
       "1  EP-0747276-B2                   US-IL                  Illinois\n",
       "2   GB-2460642-A                   US-CA                California\n",
       "3  EP-2129934-A1                   US-MI                  Michigan\n",
       "4  EP-2131651-A1                   US-NY                  New York"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search patents where original_assignee_names is not empty return patents[id+unnest(original_assignee_names)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 27 (total patents= 38947948)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>original_assignee_names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>EP-1409282-B1</td>\n",
       "      <td>BOSCH GMBH ROBERT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>WO-2009149128-A2</td>\n",
       "      <td>SHKEDI ROY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>EP-0868664-B1</td>\n",
       "      <td>DIONEX CORP</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>EP-0861808-B1</td>\n",
       "      <td>KURARAY CO</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-0860530-B1</td>\n",
       "      <td>INDUTEX S P A</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 id original_assignee_names\n",
       "0     EP-1409282-B1       BOSCH GMBH ROBERT\n",
       "1  WO-2009149128-A2              SHKEDI ROY\n",
       "2     EP-0868664-B1             DIONEX CORP\n",
       "3     EP-0861808-B1              KURARAY CO\n",
       "4     EP-0860530-B1           INDUTEX S P A"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: clinical_trials\n",
      "***********************\n",
      "Fields:  ['category_icrp_cso', 'category_rcdc', 'active_years', 'mesh_terms', 'category_bra', 'category_icrp_ct', 'category_hrcs_hc', 'category_hrcs_rac', 'publications', 'category_hra', 'associated_grant_ids', 'investigator_details', 'category_for', 'funders', 'research_orgs', 'publication_ids', 'funder_countries', 'interventions', 'conditions', 'researchers']\n",
      "\n",
      "====\n",
      " search clinical_trials where category_icrp_cso is not empty return clinical_trials[id+unnest(category_icrp_cso)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 25 (total clinical_trials= 72778)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_cso.id</th>\n",
       "      <th>category_icrp_cso.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>3768</td>\n",
       "      <td>5.4 Systemic Therapies - Clinical Applications</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318368</td>\n",
       "      <td>3768</td>\n",
       "      <td>5.4 Systemic Therapies - Clinical Applications</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318615</td>\n",
       "      <td>3772</td>\n",
       "      <td>6.1 Patient Care and Survivorship Issues</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318771</td>\n",
       "      <td>3768</td>\n",
       "      <td>5.4 Systemic Therapies - Clinical Applications</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318888</td>\n",
       "      <td>3772</td>\n",
       "      <td>6.1 Patient Care and Survivorship Issues</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id category_icrp_cso.id  \\\n",
       "0  NCT02318329                 3768   \n",
       "1  NCT02318368                 3768   \n",
       "2  NCT02318615                 3772   \n",
       "3  NCT02318771                 3768   \n",
       "4  NCT02318888                 3772   \n",
       "\n",
       "                           category_icrp_cso.name  \n",
       "0  5.4 Systemic Therapies - Clinical Applications  \n",
       "1  5.4 Systemic Therapies - Clinical Applications  \n",
       "2        6.1 Patient Care and Survivorship Issues  \n",
       "3  5.4 Systemic Therapies - Clinical Applications  \n",
       "4        6.1 Patient Care and Survivorship Issues  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where category_rcdc is not empty return clinical_trials[id+unnest(category_rcdc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 102 (total clinical_trials= 474840)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_rcdc.id</th>\n",
       "      <th>category_rcdc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>508</td>\n",
       "      <td>Clinical Trials and Supportive Activities</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>507</td>\n",
       "      <td>Clinical Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>558</td>\n",
       "      <td>Prevention</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>508</td>\n",
       "      <td>Clinical Trials and Supportive Activities</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>583</td>\n",
       "      <td>Vaccine Related</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id category_rcdc.id                         category_rcdc.name\n",
       "0  NCT02318264              508  Clinical Trials and Supportive Activities\n",
       "1  NCT02318264              507                          Clinical Research\n",
       "2  NCT02318277              558                                 Prevention\n",
       "3  NCT02318277              508  Clinical Trials and Supportive Activities\n",
       "4  NCT02318277              583                            Vaccine Related"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where active_years is not empty return clinical_trials[id+unnest(active_years)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 89 (total clinical_trials= 481259)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>active_years</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>2014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id  active_years\n",
       "0  NCT02318264          2015\n",
       "1  NCT02318264          2016\n",
       "2  NCT02318277          2014\n",
       "3  NCT02318277          2015\n",
       "4  NCT02318277          2016"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where mesh_terms is not empty return clinical_trials[id+unnest(mesh_terms)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 42 (total clinical_trials= 287421)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>mesh_terms</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>Head and Neck Neoplasms</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>Substance Withdrawal Syndrome</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>Syndrome</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>Rhinitis</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>Rhinitis, Allergic</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id                     mesh_terms\n",
       "0  NCT02318277        Head and Neck Neoplasms\n",
       "1  NCT02318290  Substance Withdrawal Syndrome\n",
       "2  NCT02318290                       Syndrome\n",
       "3  NCT02318303                       Rhinitis\n",
       "4  NCT02318303             Rhinitis, Allergic"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where category_bra is not empty return clinical_trials[id+unnest(category_bra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total clinical_trials= 394130)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_bra.id</th>\n",
       "      <th>category_bra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id category_bra.id              category_bra.name\n",
       "0  NCT02318277            4001  Clinical Medicine and Science\n",
       "1  NCT02318290            4001  Clinical Medicine and Science\n",
       "2  NCT02318303            4001  Clinical Medicine and Science\n",
       "3  NCT02318316            4001  Clinical Medicine and Science\n",
       "4  NCT02318329            4001  Clinical Medicine and Science"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where category_icrp_ct is not empty return clinical_trials[id+unnest(category_icrp_ct)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 26 (total clinical_trials= 126777)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_ct.id</th>\n",
       "      <th>category_icrp_ct.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>3807</td>\n",
       "      <td>Leukemia / Leukaemia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>3835</td>\n",
       "      <td>Stomach Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>3815</td>\n",
       "      <td>Non-Hodgkin's Lymphoma</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318368</td>\n",
       "      <td>3809</td>\n",
       "      <td>Lung Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318615</td>\n",
       "      <td>3790</td>\n",
       "      <td>Breast Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id category_icrp_ct.id   category_icrp_ct.name\n",
       "0  NCT02318316                3807    Leukemia / Leukaemia\n",
       "1  NCT02318329                3835          Stomach Cancer\n",
       "2  NCT02318329                3815  Non-Hodgkin's Lymphoma\n",
       "3  NCT02318368                3809             Lung Cancer\n",
       "4  NCT02318615                3790           Breast Cancer"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where category_hrcs_hc is not empty return clinical_trials[id+unnest(category_hrcs_hc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 22 (total clinical_trials= 342881)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_hc.id</th>\n",
       "      <th>category_hrcs_hc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>890</td>\n",
       "      <td>Generic Health Relevance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>896</td>\n",
       "      <td>Respiratory</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>911</td>\n",
       "      <td>Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318342</td>\n",
       "      <td>894</td>\n",
       "      <td>Cardiovascular</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318368</td>\n",
       "      <td>911</td>\n",
       "      <td>Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id category_hrcs_hc.id     category_hrcs_hc.name\n",
       "0  NCT02318290                 890  Generic Health Relevance\n",
       "1  NCT02318316                 896               Respiratory\n",
       "2  NCT02318329                 911                    Cancer\n",
       "3  NCT02318342                 894            Cardiovascular\n",
       "4  NCT02318368                 911                    Cancer"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where category_hrcs_rac is not empty return clinical_trials[id+unnest(category_hrcs_rac)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 45 (total clinical_trials= 276908)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_rac.id</th>\n",
       "      <th>category_hrcs_rac.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>10600</td>\n",
       "      <td>6 Evaluation of Treatments and Therapeutic Int...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>10601</td>\n",
       "      <td>6.1 Pharmaceuticals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>10602</td>\n",
       "      <td>6.2 Cellular and gene therapies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>10400</td>\n",
       "      <td>4 Detection, Screening and Diagnosis</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>10402</td>\n",
       "      <td>4.2 Evaluation of markers and technologies</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id category_hrcs_rac.id  \\\n",
       "0  NCT02318277                10600   \n",
       "1  NCT02318277                10601   \n",
       "2  NCT02318277                10602   \n",
       "3  NCT02318290                10400   \n",
       "4  NCT02318290                10402   \n",
       "\n",
       "                              category_hrcs_rac.name  \n",
       "0  6 Evaluation of Treatments and Therapeutic Int...  \n",
       "1                                6.1 Pharmaceuticals  \n",
       "2                    6.2 Cellular and gene therapies  \n",
       "3               4 Detection, Screening and Diagnosis  \n",
       "4         4.2 Evaluation of markers and technologies  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where publications is not empty return clinical_trials[id+unnest(publications)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 50 (total clinical_trials= 120317)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publications.id</th>\n",
       "      <th>publications.doi</th>\n",
       "      <th>publications.pmid</th>\n",
       "      <th>publications.pmcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>pub.1060172832</td>\n",
       "      <td>10.1097/00003246-199804000-00015</td>\n",
       "      <td>9559604</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>pub.1034540720</td>\n",
       "      <td>10.1097/pcc.0b013e31818c8328</td>\n",
       "      <td>18838937</td>\n",
       "      <td>PMC2775493</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>pub.1122595654</td>\n",
       "      <td>10.1016/j.anai.2019.11.007</td>\n",
       "      <td>31734334</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>pub.1078752671</td>\n",
       "      <td>NaN</td>\n",
       "      <td>23823823</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>pub.1029970033</td>\n",
       "      <td>10.1111/j.1600-6143.2006.01331.x</td>\n",
       "      <td>16686775</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id publications.id                  publications.doi  \\\n",
       "0  NCT02318290  pub.1060172832  10.1097/00003246-199804000-00015   \n",
       "1  NCT02318290  pub.1034540720      10.1097/pcc.0b013e31818c8328   \n",
       "2  NCT02318303  pub.1122595654        10.1016/j.anai.2019.11.007   \n",
       "3  NCT02318316  pub.1078752671                               NaN   \n",
       "4  NCT02318316  pub.1029970033  10.1111/j.1600-6143.2006.01331.x   \n",
       "\n",
       "  publications.pmid publications.pmcid  \n",
       "0           9559604                NaN  \n",
       "1          18838937         PMC2775493  \n",
       "2          31734334                NaN  \n",
       "3          23823823                NaN  \n",
       "4          16686775                NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where category_hra is not empty return clinical_trials[id+unnest(category_hra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total clinical_trials= 386778)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hra.id</th>\n",
       "      <th>category_hra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>3901</td>\n",
       "      <td>Clinical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>3901</td>\n",
       "      <td>Clinical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>3901</td>\n",
       "      <td>Clinical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>3901</td>\n",
       "      <td>Clinical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>3901</td>\n",
       "      <td>Clinical</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id category_hra.id category_hra.name\n",
       "0  NCT02318264            3901          Clinical\n",
       "1  NCT02318277            3901          Clinical\n",
       "2  NCT02318290            3901          Clinical\n",
       "3  NCT02318303            3901          Clinical\n",
       "4  NCT02318316            3901          Clinical"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where associated_grant_ids is not empty return clinical_trials[id+unnest(associated_grant_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 23 (total clinical_trials= 20326)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>associated_grant_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318745</td>\n",
       "      <td>grant.2441292</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02319018</td>\n",
       "      <td>grant.2438823</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02319018</td>\n",
       "      <td>grant.3624833</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02319018</td>\n",
       "      <td>grant.2479657</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02319317</td>\n",
       "      <td>grant.3805402</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id associated_grant_ids\n",
       "0  NCT02318745        grant.2441292\n",
       "1  NCT02319018        grant.2438823\n",
       "2  NCT02319018        grant.3624833\n",
       "3  NCT02319018        grant.2479657\n",
       "4  NCT02319317        grant.3805402"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where investigator_details is not empty return clinical_trials[id+unnest(investigator_details)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 35 (total clinical_trials= 440671)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>investigator_details</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>[Lance Leopold, MD, Study Director, Incyte Cor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>[David Williamson, PhD, Principal Investigator...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>[Marc Perreaut, PharmD, Principal Investigator...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>[Anne Julie Frenette, MSc, Principal Investiga...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>[Sudeesh Tantry, PhD, Study Director, Glenmark...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id                               investigator_details\n",
       "0  NCT02318277  [Lance Leopold, MD, Study Director, Incyte Cor...\n",
       "1  NCT02318290  [David Williamson, PhD, Principal Investigator...\n",
       "2  NCT02318290  [Marc Perreaut, PharmD, Principal Investigator...\n",
       "3  NCT02318290  [Anne Julie Frenette, MSc, Principal Investiga...\n",
       "4  NCT02318303  [Sudeesh Tantry, PhD, Study Director, Glenmark..."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where category_for is not empty return clinical_trials[id+unnest(category_for)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 45 (total clinical_trials= 484997)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_for.id</th>\n",
       "      <th>category_for.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>2211</td>\n",
       "      <td>11 Medical and Health Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>3053</td>\n",
       "      <td>1103 Clinical Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>2211</td>\n",
       "      <td>11 Medical and Health Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>3053</td>\n",
       "      <td>1103 Clinical Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>3177</td>\n",
       "      <td>1117 Public Health and Health Services</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id category_for.id                       category_for.name\n",
       "0  NCT02318264            2211          11 Medical and Health Sciences\n",
       "1  NCT02318264            3053                  1103 Clinical Sciences\n",
       "2  NCT02318277            2211          11 Medical and Health Sciences\n",
       "3  NCT02318277            3053                  1103 Clinical Sciences\n",
       "4  NCT02318290            3177  1117 Public Health and Health Services"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where funders is not empty return clinical_trials[id+unnest(funders)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 27 (total clinical_trials= 174098)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funders.id</th>\n",
       "      <th>funders.name</th>\n",
       "      <th>funders.acronym</th>\n",
       "      <th>funders.linkout</th>\n",
       "      <th>funders.country_name</th>\n",
       "      <th>funders.state_name</th>\n",
       "      <th>funders.city_name</th>\n",
       "      <th>funders.latitude</th>\n",
       "      <th>funders.longitude</th>\n",
       "      <th>funders.types</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>grid.418152.b</td>\n",
       "      <td>AstraZeneca (United States)</td>\n",
       "      <td>AstraZeneca</td>\n",
       "      <td>[http://www.astrazeneca-us.com/home/]</td>\n",
       "      <td>United States</td>\n",
       "      <td>Delaware</td>\n",
       "      <td>Wilmington</td>\n",
       "      <td>39.785908</td>\n",
       "      <td>-75.548960</td>\n",
       "      <td>[Company]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>grid.426409.d</td>\n",
       "      <td>Scientific and Technological Research Council ...</td>\n",
       "      <td>TÜBİTAK</td>\n",
       "      <td>[http://www.tubitak.gov.tr/en]</td>\n",
       "      <td>Turkey</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Ankara</td>\n",
       "      <td>39.904716</td>\n",
       "      <td>32.858597</td>\n",
       "      <td>[Government]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>grid.410425.6</td>\n",
       "      <td>City Of Hope National Medical Center</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[http://www.cityofhope.org/]</td>\n",
       "      <td>United States</td>\n",
       "      <td>California</td>\n",
       "      <td>Duarte</td>\n",
       "      <td>34.129635</td>\n",
       "      <td>-117.970764</td>\n",
       "      <td>[Healthcare]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>grid.65499.37</td>\n",
       "      <td>Dana-Farber Cancer Institute</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[http://www.dana-farber.org/]</td>\n",
       "      <td>United States</td>\n",
       "      <td>Massachusetts</td>\n",
       "      <td>Boston</td>\n",
       "      <td>42.337890</td>\n",
       "      <td>-71.107285</td>\n",
       "      <td>[Facility]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318355</td>\n",
       "      <td>grid.427669.8</td>\n",
       "      <td>Carolinas Healthcare System</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[http://www.carolinashealthcare.org/]</td>\n",
       "      <td>United States</td>\n",
       "      <td>North Carolina</td>\n",
       "      <td>Charlotte</td>\n",
       "      <td>35.203964</td>\n",
       "      <td>-80.839165</td>\n",
       "      <td>[Healthcare]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id     funders.id  \\\n",
       "0  NCT02318277  grid.418152.b   \n",
       "1  NCT02318316  grid.426409.d   \n",
       "2  NCT02318329  grid.410425.6   \n",
       "3  NCT02318329  grid.65499.37   \n",
       "4  NCT02318355  grid.427669.8   \n",
       "\n",
       "                                        funders.name funders.acronym  \\\n",
       "0                        AstraZeneca (United States)     AstraZeneca   \n",
       "1  Scientific and Technological Research Council ...         TÜBİTAK   \n",
       "2               City Of Hope National Medical Center             NaN   \n",
       "3                       Dana-Farber Cancer Institute             NaN   \n",
       "4                        Carolinas Healthcare System             NaN   \n",
       "\n",
       "                         funders.linkout funders.country_name  \\\n",
       "0  [http://www.astrazeneca-us.com/home/]        United States   \n",
       "1         [http://www.tubitak.gov.tr/en]               Turkey   \n",
       "2           [http://www.cityofhope.org/]        United States   \n",
       "3          [http://www.dana-farber.org/]        United States   \n",
       "4  [http://www.carolinashealthcare.org/]        United States   \n",
       "\n",
       "  funders.state_name funders.city_name  funders.latitude  funders.longitude  \\\n",
       "0           Delaware        Wilmington         39.785908         -75.548960   \n",
       "1                NaN            Ankara         39.904716          32.858597   \n",
       "2         California            Duarte         34.129635        -117.970764   \n",
       "3      Massachusetts            Boston         42.337890         -71.107285   \n",
       "4     North Carolina         Charlotte         35.203964         -80.839165   \n",
       "\n",
       "  funders.types  \n",
       "0     [Company]  \n",
       "1  [Government]  \n",
       "2  [Healthcare]  \n",
       "3    [Facility]  \n",
       "4  [Healthcare]  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where research_orgs is not empty return clinical_trials[id+unnest(research_orgs)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 105 (total clinical_trials= 529640)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_orgs.id</th>\n",
       "      <th>research_orgs.name</th>\n",
       "      <th>research_orgs.acronym</th>\n",
       "      <th>research_orgs.linkout</th>\n",
       "      <th>research_orgs.country_name</th>\n",
       "      <th>research_orgs.state_name</th>\n",
       "      <th>research_orgs.city_name</th>\n",
       "      <th>research_orgs.latitude</th>\n",
       "      <th>research_orgs.longitude</th>\n",
       "      <th>research_orgs.types</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>grid.417921.8</td>\n",
       "      <td>Incyte (United States)</td>\n",
       "      <td>Incyte</td>\n",
       "      <td>[http://www.incyte.com/]</td>\n",
       "      <td>United States</td>\n",
       "      <td>Delaware</td>\n",
       "      <td>Wilmington</td>\n",
       "      <td>39.762733</td>\n",
       "      <td>-75.55364</td>\n",
       "      <td>[Company]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>grid.418152.b</td>\n",
       "      <td>AstraZeneca (United States)</td>\n",
       "      <td>AstraZeneca</td>\n",
       "      <td>[http://www.astrazeneca-us.com/home/]</td>\n",
       "      <td>United States</td>\n",
       "      <td>Delaware</td>\n",
       "      <td>Wilmington</td>\n",
       "      <td>39.785908</td>\n",
       "      <td>-75.54896</td>\n",
       "      <td>[Company]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>grid.416099.3</td>\n",
       "      <td>Montreal General Hospital</td>\n",
       "      <td>MGH</td>\n",
       "      <td>[https://muhc.ca/mgh/dashboard]</td>\n",
       "      <td>Canada</td>\n",
       "      <td>Quebec</td>\n",
       "      <td>Montreal</td>\n",
       "      <td>45.497300</td>\n",
       "      <td>-73.58850</td>\n",
       "      <td>[Healthcare]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>grid.414056.2</td>\n",
       "      <td>Sacred Heart Hospital of Montreal</td>\n",
       "      <td>HSCM</td>\n",
       "      <td>[http://www.hscm.ca/]</td>\n",
       "      <td>Canada</td>\n",
       "      <td>Quebec</td>\n",
       "      <td>Montreal</td>\n",
       "      <td>45.533180</td>\n",
       "      <td>-73.71488</td>\n",
       "      <td>[Healthcare]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>grid.462347.0</td>\n",
       "      <td>Glenmark Pharmaceuticals (India)</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[http://www.glenmarkpharma.com/]</td>\n",
       "      <td>India</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Mumbai</td>\n",
       "      <td>19.117860</td>\n",
       "      <td>72.85562</td>\n",
       "      <td>[Company]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id research_orgs.id                 research_orgs.name  \\\n",
       "0  NCT02318277    grid.417921.8             Incyte (United States)   \n",
       "1  NCT02318277    grid.418152.b        AstraZeneca (United States)   \n",
       "2  NCT02318290    grid.416099.3          Montreal General Hospital   \n",
       "3  NCT02318290    grid.414056.2  Sacred Heart Hospital of Montreal   \n",
       "4  NCT02318303    grid.462347.0   Glenmark Pharmaceuticals (India)   \n",
       "\n",
       "  research_orgs.acronym                  research_orgs.linkout  \\\n",
       "0                Incyte               [http://www.incyte.com/]   \n",
       "1           AstraZeneca  [http://www.astrazeneca-us.com/home/]   \n",
       "2                   MGH        [https://muhc.ca/mgh/dashboard]   \n",
       "3                  HSCM                  [http://www.hscm.ca/]   \n",
       "4                   NaN       [http://www.glenmarkpharma.com/]   \n",
       "\n",
       "  research_orgs.country_name research_orgs.state_name research_orgs.city_name  \\\n",
       "0              United States                 Delaware              Wilmington   \n",
       "1              United States                 Delaware              Wilmington   \n",
       "2                     Canada                   Quebec                Montreal   \n",
       "3                     Canada                   Quebec                Montreal   \n",
       "4                      India                      NaN                  Mumbai   \n",
       "\n",
       "   research_orgs.latitude  research_orgs.longitude research_orgs.types  \n",
       "0               39.762733                -75.55364           [Company]  \n",
       "1               39.785908                -75.54896           [Company]  \n",
       "2               45.497300                -73.58850        [Healthcare]  \n",
       "3               45.533180                -73.71488        [Healthcare]  \n",
       "4               19.117860                 72.85562           [Company]  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where publication_ids is not empty return clinical_trials[id+unnest(publication_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 50 (total clinical_trials= 120317)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publication_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>pub.1060172832</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>pub.1034540720</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>pub.1122595654</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>pub.1078752671</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>pub.1029970033</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id publication_ids\n",
       "0  NCT02318290  pub.1060172832\n",
       "1  NCT02318290  pub.1034540720\n",
       "2  NCT02318303  pub.1122595654\n",
       "3  NCT02318316  pub.1078752671\n",
       "4  NCT02318316  pub.1029970033"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where funder_countries is not empty return clinical_trials[id+unnest(funder_countries)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 27 (total clinical_trials= 174098)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funder_countries.id</th>\n",
       "      <th>funder_countries.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>TR</td>\n",
       "      <td>Turkey</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318355</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id funder_countries.id funder_countries.name\n",
       "0  NCT02318277                  US         United States\n",
       "1  NCT02318316                  TR                Turkey\n",
       "2  NCT02318329                  US         United States\n",
       "3  NCT02318329                  US         United States\n",
       "4  NCT02318355                  US         United States"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where interventions is not empty return clinical_trials[id+unnest(interventions)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 38 (total clinical_trials= 462789)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>interventions.type</th>\n",
       "      <th>interventions.name</th>\n",
       "      <th>interventions.description</th>\n",
       "      <th>interventions.arm_group_labels</th>\n",
       "      <th>interventions.other_names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>Device</td>\n",
       "      <td>Kinesio Tape</td>\n",
       "      <td>Elastic tape placed over the skin</td>\n",
       "      <td>Distal to Proximal Tape, Proximal to Distal Tape</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>Drug</td>\n",
       "      <td>INCB024360</td>\n",
       "      <td>INCB024360: Oral daily dosing</td>\n",
       "      <td>MEDI4736 + INCB024360</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>Drug</td>\n",
       "      <td>MEDI4736</td>\n",
       "      <td>MEDI4736 administered intravenously (IV) every...</td>\n",
       "      <td>MEDI4736 + INCB024360</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>Drug</td>\n",
       "      <td>Opiates</td>\n",
       "      <td>Mechanically ventilated patients receiving opi...</td>\n",
       "      <td>Critically ill patients</td>\n",
       "      <td>Analgesics, Narcotics</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>Drug</td>\n",
       "      <td>Mometasone Furoate-2 NS (BID)</td>\n",
       "      <td>Mometasone furoate-2 NS (25 μg) administered a...</td>\n",
       "      <td>Mometasone Furoate-2 NS (BID)</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id interventions.type             interventions.name  \\\n",
       "0  NCT02318264             Device                   Kinesio Tape   \n",
       "1  NCT02318277               Drug                     INCB024360   \n",
       "2  NCT02318277               Drug                       MEDI4736   \n",
       "3  NCT02318290               Drug                        Opiates   \n",
       "4  NCT02318303               Drug  Mometasone Furoate-2 NS (BID)   \n",
       "\n",
       "                           interventions.description  \\\n",
       "0                  Elastic tape placed over the skin   \n",
       "1                      INCB024360: Oral daily dosing   \n",
       "2  MEDI4736 administered intravenously (IV) every...   \n",
       "3  Mechanically ventilated patients receiving opi...   \n",
       "4  Mometasone furoate-2 NS (25 μg) administered a...   \n",
       "\n",
       "                     interventions.arm_group_labels interventions.other_names  \n",
       "0  Distal to Proximal Tape, Proximal to Distal Tape                            \n",
       "1                             MEDI4736 + INCB024360                            \n",
       "2                             MEDI4736 + INCB024360                            \n",
       "3                           Critically ill patients     Analgesics, Narcotics  \n",
       "4                     Mometasone Furoate-2 NS (BID)                            "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where conditions is not empty return clinical_trials[id+unnest(conditions)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 36 (total clinical_trials= 559850)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>conditions</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>Direction of Kinesio Tape Application</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>Changes Based on Duration of Tape Application</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>Healthy Subjects</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>UC (Urothelial Cancer)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>Lung Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id                                     conditions\n",
       "0  NCT02318264          Direction of Kinesio Tape Application\n",
       "1  NCT02318264  Changes Based on Duration of Tape Application\n",
       "2  NCT02318264                               Healthy Subjects\n",
       "3  NCT02318277                         UC (Urothelial Cancer)\n",
       "4  NCT02318277                                    Lung Cancer"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where researchers is not empty return clinical_trials[id+unnest(researchers)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 29 (total clinical_trials= 237750)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>researchers.id</th>\n",
       "      <th>researchers.first_name</th>\n",
       "      <th>researchers.last_name</th>\n",
       "      <th>researchers.research_orgs</th>\n",
       "      <th>researchers.orcid_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>ur.01333126237.14</td>\n",
       "      <td>Lance</td>\n",
       "      <td>Leopold</td>\n",
       "      <td>[grid.417921.8, grid.189509.c, grid.25879.31]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>ur.01365714423.46</td>\n",
       "      <td>David R</td>\n",
       "      <td>Williamson</td>\n",
       "      <td>[grid.63984.30, grid.86715.3d, grid.28046.38, ...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>ur.0616562311.43</td>\n",
       "      <td>Sudeesh K</td>\n",
       "      <td>Tantry</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>ur.0605601036.59</td>\n",
       "      <td>Zeki</td>\n",
       "      <td>Yildirim</td>\n",
       "      <td>[grid.25769.3f, grid.411137.1, grid.440464.6, ...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318342</td>\n",
       "      <td>ur.01266104554.36</td>\n",
       "      <td>Raj R</td>\n",
       "      <td>Makkar</td>\n",
       "      <td>[grid.416167.3, grid.239578.2, grid.239585.0, ...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id     researchers.id researchers.first_name  \\\n",
       "0  NCT02318277  ur.01333126237.14                  Lance   \n",
       "1  NCT02318290  ur.01365714423.46                David R   \n",
       "2  NCT02318303   ur.0616562311.43              Sudeesh K   \n",
       "3  NCT02318316   ur.0605601036.59                   Zeki   \n",
       "4  NCT02318342  ur.01266104554.36                  Raj R   \n",
       "\n",
       "  researchers.last_name                          researchers.research_orgs  \\\n",
       "0               Leopold      [grid.417921.8, grid.189509.c, grid.25879.31]   \n",
       "1            Williamson  [grid.63984.30, grid.86715.3d, grid.28046.38, ...   \n",
       "2                Tantry                                                NaN   \n",
       "3              Yildirim  [grid.25769.3f, grid.411137.1, grid.440464.6, ...   \n",
       "4                Makkar  [grid.416167.3, grid.239578.2, grid.239585.0, ...   \n",
       "\n",
       "  researchers.orcid_id  \n",
       "0                  NaN  \n",
       "1                  NaN  \n",
       "2                  NaN  \n",
       "3                  NaN  \n",
       "4                  NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: policy_documents\n",
      "***********************\n",
      "Fields:  ['category_icrp_cso', 'category_rcdc', 'category_bra', 'category_icrp_ct', 'category_hrcs_hc', 'publications', 'category_hrcs_rac', 'category_hra', 'category_for', 'publication_ids']\n",
      "\n",
      "====\n",
      " search policy_documents where category_icrp_cso is not empty return policy_documents[id+unnest(category_icrp_cso)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 41 (total policy_documents= 15330)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_cso.id</th>\n",
       "      <th>category_icrp_cso.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643724</td>\n",
       "      <td>3775</td>\n",
       "      <td>6.4 Cost Analyses and Health Care Delivery</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.643729</td>\n",
       "      <td>3771</td>\n",
       "      <td>5.7 Resources and Infrastructure Related to Tr...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.643737</td>\n",
       "      <td>3763</td>\n",
       "      <td>4.3 Technology and/or Marker Testing in a Clin...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.643738</td>\n",
       "      <td>3763</td>\n",
       "      <td>4.3 Technology and/or Marker Testing in a Clin...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.643738</td>\n",
       "      <td>3764</td>\n",
       "      <td>4.4 Resources and Infrastructure Related to De...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_icrp_cso.id  \\\n",
       "0  policy.643724                 3775   \n",
       "1  policy.643729                 3771   \n",
       "2  policy.643737                 3763   \n",
       "3  policy.643738                 3763   \n",
       "4  policy.643738                 3764   \n",
       "\n",
       "                              category_icrp_cso.name  \n",
       "0         6.4 Cost Analyses and Health Care Delivery  \n",
       "1  5.7 Resources and Infrastructure Related to Tr...  \n",
       "2  4.3 Technology and/or Marker Testing in a Clin...  \n",
       "3  4.3 Technology and/or Marker Testing in a Clin...  \n",
       "4  4.4 Resources and Infrastructure Related to De...  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search policy_documents where category_rcdc is not empty return policy_documents[id+unnest(category_rcdc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 62 (total policy_documents= 214064)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_rcdc.id</th>\n",
       "      <th>category_rcdc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643712</td>\n",
       "      <td>443</td>\n",
       "      <td>Health Services</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.643712</td>\n",
       "      <td>507</td>\n",
       "      <td>Clinical Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.643714</td>\n",
       "      <td>558</td>\n",
       "      <td>Prevention</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.643714</td>\n",
       "      <td>498</td>\n",
       "      <td>Behavioral and Social Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.643714</td>\n",
       "      <td>533</td>\n",
       "      <td>Infectious Diseases</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_rcdc.id             category_rcdc.name\n",
       "0  policy.643712              443                Health Services\n",
       "1  policy.643712              507              Clinical Research\n",
       "2  policy.643714              558                     Prevention\n",
       "3  policy.643714              498  Behavioral and Social Science\n",
       "4  policy.643714              533            Infectious Diseases"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search policy_documents where category_bra is not empty return policy_documents[id+unnest(category_bra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total policy_documents= 61114)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_bra.id</th>\n",
       "      <th>category_bra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643720</td>\n",
       "      <td>4002</td>\n",
       "      <td>Health Services Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.643723</td>\n",
       "      <td>4002</td>\n",
       "      <td>Health Services Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.643724</td>\n",
       "      <td>4002</td>\n",
       "      <td>Health Services Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.643737</td>\n",
       "      <td>4003</td>\n",
       "      <td>Public Health</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.643738</td>\n",
       "      <td>4002</td>\n",
       "      <td>Health Services Research</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_bra.id         category_bra.name\n",
       "0  policy.643720            4002  Health Services Research\n",
       "1  policy.643723            4002  Health Services Research\n",
       "2  policy.643724            4002  Health Services Research\n",
       "3  policy.643737            4003             Public Health\n",
       "4  policy.643738            4002  Health Services Research"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search policy_documents where category_icrp_ct is not empty return policy_documents[id+unnest(category_icrp_ct)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total policy_documents= 17276)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_ct.id</th>\n",
       "      <th>category_icrp_ct.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643724</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.643729</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.643737</td>\n",
       "      <td>3792</td>\n",
       "      <td>Cervical Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.643738</td>\n",
       "      <td>3793</td>\n",
       "      <td>Colon and Rectal Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>3793</td>\n",
       "      <td>Colon and Rectal Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_icrp_ct.id     category_icrp_ct.name\n",
       "0  policy.643724                3816  Not Site-Specific Cancer\n",
       "1  policy.643729                3816  Not Site-Specific Cancer\n",
       "2  policy.643737                3792           Cervical Cancer\n",
       "3  policy.643738                3793   Colon and Rectal Cancer\n",
       "4  policy.643787                3793   Colon and Rectal Cancer"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search policy_documents where category_hrcs_hc is not empty return policy_documents[id+unnest(category_hrcs_hc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 28 (total policy_documents= 177271)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_hc.id</th>\n",
       "      <th>category_hrcs_hc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643712</td>\n",
       "      <td>890</td>\n",
       "      <td>Generic Health Relevance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.643714</td>\n",
       "      <td>890</td>\n",
       "      <td>Generic Health Relevance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.643714</td>\n",
       "      <td>898</td>\n",
       "      <td>Infection</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.64372</td>\n",
       "      <td>890</td>\n",
       "      <td>Generic Health Relevance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.643720</td>\n",
       "      <td>890</td>\n",
       "      <td>Generic Health Relevance</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_hrcs_hc.id     category_hrcs_hc.name\n",
       "0  policy.643712                 890  Generic Health Relevance\n",
       "1  policy.643714                 890  Generic Health Relevance\n",
       "2  policy.643714                 898                 Infection\n",
       "3   policy.64372                 890  Generic Health Relevance\n",
       "4  policy.643720                 890  Generic Health Relevance"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search policy_documents where publications is not empty return policy_documents[id+unnest(publications)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 241 (total policy_documents= 98668)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publications.id</th>\n",
       "      <th>publications.doi</th>\n",
       "      <th>publications.pmid</th>\n",
       "      <th>publications.pmcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643736</td>\n",
       "      <td>pub.1059967437</td>\n",
       "      <td>10.1093/oxrep/grj011</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1011501074</td>\n",
       "      <td>10.1371/journal.pmed.1001396</td>\n",
       "      <td>23468598</td>\n",
       "      <td>PMC3582608</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1039801886</td>\n",
       "      <td>10.1016/j.vaccine.2014.01.053</td>\n",
       "      <td>24480024</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1068078884</td>\n",
       "      <td>10.1586/14787210.2013.824717</td>\n",
       "      <td>24124797</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1047965704</td>\n",
       "      <td>10.1097/olq.0b013e3182631c9f</td>\n",
       "      <td>23001269</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id publications.id               publications.doi  \\\n",
       "0  policy.643736  pub.1059967437           10.1093/oxrep/grj011   \n",
       "1   policy.64374  pub.1011501074   10.1371/journal.pmed.1001396   \n",
       "2   policy.64374  pub.1039801886  10.1016/j.vaccine.2014.01.053   \n",
       "3   policy.64374  pub.1068078884   10.1586/14787210.2013.824717   \n",
       "4   policy.64374  pub.1047965704   10.1097/olq.0b013e3182631c9f   \n",
       "\n",
       "  publications.pmid publications.pmcid  \n",
       "0               NaN                NaN  \n",
       "1          23468598         PMC3582608  \n",
       "2          24480024                NaN  \n",
       "3          24124797                NaN  \n",
       "4          23001269                NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search policy_documents where category_hrcs_rac is not empty return policy_documents[id+unnest(category_hrcs_rac)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 24 (total policy_documents= 66295)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_rac.id</th>\n",
       "      <th>category_hrcs_rac.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643723</td>\n",
       "      <td>10801</td>\n",
       "      <td>8.1 Organisation and delivery of services</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.643724</td>\n",
       "      <td>10801</td>\n",
       "      <td>8.1 Organisation and delivery of services</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.643725</td>\n",
       "      <td>10801</td>\n",
       "      <td>8.1 Organisation and delivery of services</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.643728</td>\n",
       "      <td>10801</td>\n",
       "      <td>8.1 Organisation and delivery of services</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.643733</td>\n",
       "      <td>10801</td>\n",
       "      <td>8.1 Organisation and delivery of services</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_hrcs_rac.id  \\\n",
       "0  policy.643723                10801   \n",
       "1  policy.643724                10801   \n",
       "2  policy.643725                10801   \n",
       "3  policy.643728                10801   \n",
       "4  policy.643733                10801   \n",
       "\n",
       "                      category_hrcs_rac.name  \n",
       "0  8.1 Organisation and delivery of services  \n",
       "1  8.1 Organisation and delivery of services  \n",
       "2  8.1 Organisation and delivery of services  \n",
       "3  8.1 Organisation and delivery of services  \n",
       "4  8.1 Organisation and delivery of services  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search policy_documents where category_hra is not empty return policy_documents[id+unnest(category_hra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total policy_documents= 149708)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hra.id</th>\n",
       "      <th>category_hra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643712</td>\n",
       "      <td>3902</td>\n",
       "      <td>Health services &amp; systems</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.643714</td>\n",
       "      <td>3902</td>\n",
       "      <td>Health services &amp; systems</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.643722</td>\n",
       "      <td>3902</td>\n",
       "      <td>Health services &amp; systems</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.643723</td>\n",
       "      <td>3902</td>\n",
       "      <td>Health services &amp; systems</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.643724</td>\n",
       "      <td>3902</td>\n",
       "      <td>Health services &amp; systems</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_hra.id          category_hra.name\n",
       "0  policy.643712            3902  Health services & systems\n",
       "1  policy.643714            3902  Health services & systems\n",
       "2  policy.643722            3902  Health services & systems\n",
       "3  policy.643723            3902  Health services & systems\n",
       "4  policy.643724            3902  Health services & systems"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search policy_documents where category_for is not empty return policy_documents[id+unnest(category_for)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 52 (total policy_documents= 425721)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_for.id</th>\n",
       "      <th>category_for.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643711</td>\n",
       "      <td>2215</td>\n",
       "      <td>15 Commerce, Management, Tourism and Services</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.643711</td>\n",
       "      <td>3335</td>\n",
       "      <td>1502 Banking, Finance and Investment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.643712</td>\n",
       "      <td>3416</td>\n",
       "      <td>1605 Policy and Administration</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.643712</td>\n",
       "      <td>2216</td>\n",
       "      <td>16 Studies in Human Society</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.643712</td>\n",
       "      <td>3342</td>\n",
       "      <td>1503 Business and Management</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id category_for.id  \\\n",
       "0  policy.643711            2215   \n",
       "1  policy.643711            3335   \n",
       "2  policy.643712            3416   \n",
       "3  policy.643712            2216   \n",
       "4  policy.643712            3342   \n",
       "\n",
       "                               category_for.name  \n",
       "0  15 Commerce, Management, Tourism and Services  \n",
       "1           1502 Banking, Finance and Investment  \n",
       "2                 1605 Policy and Administration  \n",
       "3                    16 Studies in Human Society  \n",
       "4                   1503 Business and Management  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search policy_documents where publication_ids is not empty return policy_documents[id+unnest(publication_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 241 (total policy_documents= 98668)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publication_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643736</td>\n",
       "      <td>pub.1059967437</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1011501074</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1039801886</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1068078884</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1047965704</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id publication_ids\n",
       "0  policy.643736  pub.1059967437\n",
       "1   policy.64374  pub.1011501074\n",
       "2   policy.64374  pub.1039801886\n",
       "3   policy.64374  pub.1068078884\n",
       "4   policy.64374  pub.1047965704"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: researchers\n",
      "***********************\n",
      "Fields:  ['orcid_id', 'research_orgs', 'redirect']\n",
      "\n",
      "====\n",
      " search researchers where orcid_id is not empty return researchers[id+unnest(orcid_id)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total researchers= 7002787)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>orcid_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ur.010537013633.43</td>\n",
       "      <td>0000-0002-2891-183X</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ur.013155315523.02</td>\n",
       "      <td>0000-0001-7215-2204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ur.014131716473.20</td>\n",
       "      <td>0000-0003-4923-6332</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ur.016420443073.09</td>\n",
       "      <td>0000-0002-1707-0174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ur.011440447236.81</td>\n",
       "      <td>0000-0002-5902-2699</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   id             orcid_id\n",
       "0  ur.010537013633.43  0000-0002-2891-183X\n",
       "1  ur.013155315523.02  0000-0001-7215-2204\n",
       "2  ur.014131716473.20  0000-0003-4923-6332\n",
       "3  ur.016420443073.09  0000-0002-1707-0174\n",
       "4  ur.011440447236.81  0000-0002-5902-2699"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search researchers where research_orgs is not empty return researchers[id+unnest(research_orgs)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 23 (total researchers= 33589903)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_orgs.id</th>\n",
       "      <th>research_orgs.name</th>\n",
       "      <th>research_orgs.linkout</th>\n",
       "      <th>research_orgs.country_name</th>\n",
       "      <th>research_orgs.city_name</th>\n",
       "      <th>research_orgs.latitude</th>\n",
       "      <th>research_orgs.longitude</th>\n",
       "      <th>research_orgs.types</th>\n",
       "      <th>research_orgs.acronym</th>\n",
       "      <th>research_orgs.state_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ur.07675167317.47</td>\n",
       "      <td>grid.440633.6</td>\n",
       "      <td>University of Bío-Bío</td>\n",
       "      <td>[http://www.ubiobio.cl/w/]</td>\n",
       "      <td>Chile</td>\n",
       "      <td>Concepción</td>\n",
       "      <td>-36.822200</td>\n",
       "      <td>-73.013600</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ur.013610440106.26</td>\n",
       "      <td>grid.412028.d</td>\n",
       "      <td>Hebei University of Engineering</td>\n",
       "      <td>[http://www.hebeu.edu.cn/en/index.html]</td>\n",
       "      <td>China</td>\n",
       "      <td>Handan</td>\n",
       "      <td>36.633310</td>\n",
       "      <td>114.505720</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>HBUE</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ur.013224634223.02</td>\n",
       "      <td>grid.429211.d</td>\n",
       "      <td>Institute of Hydrobiology</td>\n",
       "      <td>[http://english.ihb.cas.cn/]</td>\n",
       "      <td>China</td>\n",
       "      <td>Wuhan</td>\n",
       "      <td>30.544794</td>\n",
       "      <td>114.357025</td>\n",
       "      <td>[Facility]</td>\n",
       "      <td>IHB</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ur.013224634223.02</td>\n",
       "      <td>grid.410726.6</td>\n",
       "      <td>University of Chinese Academy of Sciences</td>\n",
       "      <td>[http://www.ucas.ac.cn/]</td>\n",
       "      <td>China</td>\n",
       "      <td>Beijing</td>\n",
       "      <td>39.909058</td>\n",
       "      <td>116.250570</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>UCAS</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ur.012500504077.24</td>\n",
       "      <td>grid.6612.3</td>\n",
       "      <td>University of Basel</td>\n",
       "      <td>[https://www.unibas.ch/de]</td>\n",
       "      <td>Switzerland</td>\n",
       "      <td>Basel</td>\n",
       "      <td>47.558580</td>\n",
       "      <td>7.583600</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Basel-Stadt</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   id research_orgs.id  \\\n",
       "0   ur.07675167317.47    grid.440633.6   \n",
       "1  ur.013610440106.26    grid.412028.d   \n",
       "2  ur.013224634223.02    grid.429211.d   \n",
       "3  ur.013224634223.02    grid.410726.6   \n",
       "4  ur.012500504077.24      grid.6612.3   \n",
       "\n",
       "                          research_orgs.name  \\\n",
       "0                      University of Bío-Bío   \n",
       "1            Hebei University of Engineering   \n",
       "2                  Institute of Hydrobiology   \n",
       "3  University of Chinese Academy of Sciences   \n",
       "4                        University of Basel   \n",
       "\n",
       "                     research_orgs.linkout research_orgs.country_name  \\\n",
       "0               [http://www.ubiobio.cl/w/]                      Chile   \n",
       "1  [http://www.hebeu.edu.cn/en/index.html]                      China   \n",
       "2             [http://english.ihb.cas.cn/]                      China   \n",
       "3                 [http://www.ucas.ac.cn/]                      China   \n",
       "4               [https://www.unibas.ch/de]                Switzerland   \n",
       "\n",
       "  research_orgs.city_name  research_orgs.latitude  research_orgs.longitude  \\\n",
       "0              Concepción              -36.822200               -73.013600   \n",
       "1                  Handan               36.633310               114.505720   \n",
       "2                   Wuhan               30.544794               114.357025   \n",
       "3                 Beijing               39.909058               116.250570   \n",
       "4                   Basel               47.558580                 7.583600   \n",
       "\n",
       "  research_orgs.types research_orgs.acronym research_orgs.state_name  \n",
       "0         [Education]                   NaN                      NaN  \n",
       "1         [Education]                  HBUE                      NaN  \n",
       "2          [Facility]                   IHB                      NaN  \n",
       "3         [Education]                  UCAS                      NaN  \n",
       "4         [Education]                   NaN              Basel-Stadt  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search researchers where redirect is not empty return researchers[id+unnest(redirect)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total researchers= 17439353)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>redirect</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ur.013610440106.26</td>\n",
       "      <td>ur.016554401333.52</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ur.016265072537.12</td>\n",
       "      <td>ur.011055646473.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ur.067254414.74</td>\n",
       "      <td>ur.053213676.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ur.067254414.74</td>\n",
       "      <td>ur.010131563574.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ur.010143353767.05</td>\n",
       "      <td>ur.010330556133.91</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   id            redirect\n",
       "0  ur.013610440106.26  ur.016554401333.52\n",
       "1  ur.016265072537.12  ur.011055646473.98\n",
       "2     ur.067254414.74     ur.053213676.13\n",
       "3     ur.067254414.74  ur.010131563574.36\n",
       "4  ur.010143353767.05  ur.010330556133.91"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: organizations\n",
      "***********************\n",
      "Fields:  ['hesa_ids', 'external_ids_fundref', 'organization_related_ids', 'cnrs_ids', 'ror_ids', 'orgref_ids', 'isni_ids', 'organization_child_ids', 'linkout', 'organization_parent_ids', 'wikidata_ids', 'ukprn_ids', 'types', 'ucas_ids']\n",
      "\n",
      "====\n",
      " search organizations where hesa_ids is not empty return organizations[id+unnest(hesa_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 172)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>hesa_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.1006.7</td>\n",
       "      <td>0154</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.4305.2</td>\n",
       "      <td>0167</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.4425.7</td>\n",
       "      <td>0065</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.4464.2</td>\n",
       "      <td>0151</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.4563.4</td>\n",
       "      <td>0155</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id hesa_ids\n",
       "0  grid.1006.7     0154\n",
       "1  grid.4305.2     0167\n",
       "2  grid.4425.7     0065\n",
       "3  grid.4464.2     0151\n",
       "4  grid.4563.4     0155"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where external_ids_fundref is not empty return organizations[id+unnest(external_ids_fundref)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 38 (total organizations= 10117)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>external_ids_fundref</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.454842.b</td>\n",
       "      <td>100010001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>100000058</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>100005269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>100005267</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>100005268</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id external_ids_fundref\n",
       "0  grid.454842.b            100010001\n",
       "1  grid.413730.2            100000058\n",
       "2  grid.413730.2            100005269\n",
       "3  grid.413730.2            100005267\n",
       "4  grid.413730.2            100005268"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where organization_related_ids is not empty return organizations[id+unnest(organization_related_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 39 (total organizations= 4060)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>organization_related_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.418356.d</td>\n",
       "      <td>grid.413715.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.420089.7</td>\n",
       "      <td>grid.482683.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.48336.3a</td>\n",
       "      <td>grid.467988.c</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.8682.4</td>\n",
       "      <td>grid.22319.3b</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.419428.2</td>\n",
       "      <td>grid.470550.3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id organization_related_ids\n",
       "0  grid.418356.d            grid.413715.5\n",
       "1  grid.420089.7            grid.482683.3\n",
       "2  grid.48336.3a            grid.467988.c\n",
       "3    grid.8682.4            grid.22319.3b\n",
       "4  grid.419428.2            grid.470550.3"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where cnrs_ids is not empty return organizations[id+unnest(cnrs_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 833)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>cnrs_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.10877.39</td>\n",
       "      <td>UMR7643</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.462399.3</td>\n",
       "      <td>UMS839</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.72943.3b</td>\n",
       "      <td>UPR3266</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.417850.f</td>\n",
       "      <td>UMR7280</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.418110.d</td>\n",
       "      <td>IFR73</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id cnrs_ids\n",
       "0  grid.10877.39  UMR7643\n",
       "1  grid.462399.3   UMS839\n",
       "2  grid.72943.3b  UPR3266\n",
       "3  grid.417850.f  UMR7280\n",
       "4  grid.418110.d    IFR73"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where ror_ids is not empty return organizations[id+unnest(ror_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 96592)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>ror_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.454842.b</td>\n",
       "      <td>https://ror.org/0121dpf30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>https://ror.org/03t3qg659</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>https://ror.org/034xvzb47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.418356.d</td>\n",
       "      <td>https://ror.org/05rsv9s98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.413404.6</td>\n",
       "      <td>https://ror.org/03jmfdf59</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id                    ror_ids\n",
       "0  grid.454842.b  https://ror.org/0121dpf30\n",
       "1  grid.413730.2  https://ror.org/03t3qg659\n",
       "2  grid.417587.8  https://ror.org/034xvzb47\n",
       "3  grid.418356.d  https://ror.org/05rsv9s98\n",
       "4  grid.413404.6  https://ror.org/03jmfdf59"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where orgref_ids is not empty return organizations[id+unnest(orgref_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 14952)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>orgref_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.454842.b</td>\n",
       "      <td>1707966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>311822</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.418356.d</td>\n",
       "      <td>70922</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.416738.f</td>\n",
       "      <td>6811</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.453035.4</td>\n",
       "      <td>19025629</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id orgref_ids\n",
       "0  grid.454842.b    1707966\n",
       "1  grid.413730.2     311822\n",
       "2  grid.418356.d      70922\n",
       "3  grid.416738.f       6811\n",
       "4  grid.453035.4   19025629"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where isni_ids is not empty return organizations[id+unnest(isni_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 44691)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>isni_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.454842.b</td>\n",
       "      <td>0000 0004 0405 7557</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>0000 0001 0703 9395</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>0000 0001 2243 3366</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.418356.d</td>\n",
       "      <td>0000 0004 0478 7015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.413404.6</td>\n",
       "      <td>0000 0004 0507 6696</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id             isni_ids\n",
       "0  grid.454842.b  0000 0004 0405 7557\n",
       "1  grid.413730.2  0000 0001 0703 9395\n",
       "2  grid.417587.8  0000 0001 2243 3366\n",
       "3  grid.418356.d  0000 0004 0478 7015\n",
       "4  grid.413404.6  0000 0004 0507 6696"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where organization_child_ids is not empty return organizations[id+unnest(organization_child_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 201 (total organizations= 3190)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>organization_child_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>grid.290496.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>grid.413579.d</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>grid.483500.a</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>grid.483501.b</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>grid.483503.9</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id organization_child_ids\n",
       "0  grid.417587.8          grid.290496.0\n",
       "1  grid.417587.8          grid.413579.d\n",
       "2  grid.417587.8          grid.483500.a\n",
       "3  grid.417587.8          grid.483501.b\n",
       "4  grid.417587.8          grid.483503.9"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where linkout is not empty return organizations[id+unnest(linkout)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 92040)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>linkout</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.454842.b</td>\n",
       "      <td>http://www.hrsa.gov/</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>http://www.samhsa.gov/</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>http://www.fda.gov/</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.418356.d</td>\n",
       "      <td>http://www.va.gov/</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.413404.6</td>\n",
       "      <td>http://www.ahrq.gov/</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id                 linkout\n",
       "0  grid.454842.b    http://www.hrsa.gov/\n",
       "1  grid.413730.2  http://www.samhsa.gov/\n",
       "2  grid.417587.8     http://www.fda.gov/\n",
       "3  grid.418356.d      http://www.va.gov/\n",
       "4  grid.413404.6    http://www.ahrq.gov/"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where organization_parent_ids is not empty return organizations[id+unnest(organization_parent_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 12100)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>organization_parent_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.454842.b</td>\n",
       "      <td>grid.27235.31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>grid.27235.31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>grid.27235.31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.418356.d</td>\n",
       "      <td>grid.451285.f</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.413404.6</td>\n",
       "      <td>grid.27235.31</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id organization_parent_ids\n",
       "0  grid.454842.b           grid.27235.31\n",
       "1  grid.413730.2           grid.27235.31\n",
       "2  grid.417587.8           grid.27235.31\n",
       "3  grid.418356.d           grid.451285.f\n",
       "4  grid.413404.6           grid.27235.31"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where wikidata_ids is not empty return organizations[id+unnest(wikidata_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 36658)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>wikidata_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.454842.b</td>\n",
       "      <td>Q5690644</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>Q7632057</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>Q204711</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.418356.d</td>\n",
       "      <td>Q592576</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.413404.6</td>\n",
       "      <td>Q4692008</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id wikidata_ids\n",
       "0  grid.454842.b     Q5690644\n",
       "1  grid.413730.2     Q7632057\n",
       "2  grid.417587.8      Q204711\n",
       "3  grid.418356.d      Q592576\n",
       "4  grid.413404.6     Q4692008"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where ukprn_ids is not empty return organizations[id+unnest(ukprn_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 173)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>ukprn_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.1006.7</td>\n",
       "      <td>10007799</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.4305.2</td>\n",
       "      <td>10007790</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.4425.7</td>\n",
       "      <td>10003957</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.4464.2</td>\n",
       "      <td>10007797</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.4563.4</td>\n",
       "      <td>10007154</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id ukprn_ids\n",
       "0  grid.1006.7  10007799\n",
       "1  grid.4305.2  10007790\n",
       "2  grid.4425.7  10003957\n",
       "3  grid.4464.2  10007797\n",
       "4  grid.4563.4  10007154"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where types is not empty return organizations[id+unnest(types)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total organizations= 97283)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>types</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.454842.b</td>\n",
       "      <td>Government</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.413730.2</td>\n",
       "      <td>Government</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.417587.8</td>\n",
       "      <td>Government</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.418356.d</td>\n",
       "      <td>Government</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.413404.6</td>\n",
       "      <td>Other</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id       types\n",
       "0  grid.454842.b  Government\n",
       "1  grid.413730.2  Government\n",
       "2  grid.417587.8  Government\n",
       "3  grid.418356.d  Government\n",
       "4  grid.413404.6       Other"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search organizations where ucas_ids is not empty return organizations[id+unnest(ucas_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total organizations= 153)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>ucas_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grid.1006.7</td>\n",
       "      <td>N21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grid.4305.2</td>\n",
       "      <td>E56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grid.4425.7</td>\n",
       "      <td>L51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grid.4563.4</td>\n",
       "      <td>N84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grid.4701.2</td>\n",
       "      <td>P80</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id ucas_ids\n",
       "0  grid.1006.7      N21\n",
       "1  grid.4305.2      E56\n",
       "2  grid.4425.7      L51\n",
       "3  grid.4563.4      N84\n",
       "4  grid.4701.2      P80"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: datasets\n",
      "***********************\n",
      "Fields:  ['category_icrp_cso', 'research_org_states', 'research_org_countries', 'category_rcdc', 'category_bra', 'category_icrp_ct', 'category_hrcs_hc', 'category_hrcs_rac', 'researchers', 'category_hra', 'category_sdg', 'associated_grant_ids', 'keywords', 'category_for', 'funders', 'research_orgs', 'funder_countries', 'research_org_cities', 'authors']\n",
      "\n",
      "====\n",
      " search datasets where category_icrp_cso is not empty return datasets[id+unnest(category_icrp_cso)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total datasets= 163475)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_cso.id</th>\n",
       "      <th>category_icrp_cso.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354569</td>\n",
       "      <td>3768</td>\n",
       "      <td>5.4 Systemic Therapies - Clinical Applications</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>353788</td>\n",
       "      <td>3746</td>\n",
       "      <td>1.1 Normal Functioning</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>353721</td>\n",
       "      <td>3746</td>\n",
       "      <td>1.1 Normal Functioning</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>342554</td>\n",
       "      <td>3747</td>\n",
       "      <td>1.2 Cancer Initiation: Alterations in Chromosomes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>342185</td>\n",
       "      <td>3772</td>\n",
       "      <td>6.1 Patient Care and Survivorship Issues</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id category_icrp_cso.id  \\\n",
       "0  354569                 3768   \n",
       "1  353788                 3746   \n",
       "2  353721                 3746   \n",
       "3  342554                 3747   \n",
       "4  342185                 3772   \n",
       "\n",
       "                              category_icrp_cso.name  \n",
       "0     5.4 Systemic Therapies - Clinical Applications  \n",
       "1                             1.1 Normal Functioning  \n",
       "2                             1.1 Normal Functioning  \n",
       "3  1.2 Cancer Initiation: Alterations in Chromosomes  \n",
       "4           6.1 Patient Care and Survivorship Issues  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where research_org_states is not empty return datasets[id+unnest(research_org_states)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 22 (total datasets= 1045783)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_states.id</th>\n",
       "      <th>research_org_states.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354641</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354605</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354569</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354373</td>\n",
       "      <td>US-NM</td>\n",
       "      <td>New Mexico</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354340</td>\n",
       "      <td>US-FL</td>\n",
       "      <td>Florida</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id research_org_states.id research_org_states.name\n",
       "0  354641                    NaN                      NaN\n",
       "1  354605                    NaN                      NaN\n",
       "2  354569                    NaN                      NaN\n",
       "3  354373                  US-NM               New Mexico\n",
       "4  354340                  US-FL                  Florida"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where research_org_countries is not empty return datasets[id+unnest(research_org_countries)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 56 (total datasets= 1045783)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_countries.id</th>\n",
       "      <th>research_org_countries.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354641</td>\n",
       "      <td>FR</td>\n",
       "      <td>France</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354641</td>\n",
       "      <td>FR</td>\n",
       "      <td>France</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354641</td>\n",
       "      <td>FR</td>\n",
       "      <td>France</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354641</td>\n",
       "      <td>FR</td>\n",
       "      <td>France</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354605</td>\n",
       "      <td>FR</td>\n",
       "      <td>France</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id research_org_countries.id research_org_countries.name\n",
       "0  354641                        FR                      France\n",
       "1  354641                        FR                      France\n",
       "2  354641                        FR                      France\n",
       "3  354641                        FR                      France\n",
       "4  354605                        FR                      France"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where category_rcdc is not empty return datasets[id+unnest(category_rcdc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 56 (total datasets= 341115)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_rcdc.id</th>\n",
       "      <th>category_rcdc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354605</td>\n",
       "      <td>507</td>\n",
       "      <td>Clinical Research</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354605</td>\n",
       "      <td>508</td>\n",
       "      <td>Clinical Trials and Supportive Activities</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354569</td>\n",
       "      <td>533</td>\n",
       "      <td>Infectious Diseases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354308</td>\n",
       "      <td>526</td>\n",
       "      <td>Genetics</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354279</td>\n",
       "      <td>526</td>\n",
       "      <td>Genetics</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id category_rcdc.id                         category_rcdc.name\n",
       "0  354605              507                          Clinical Research\n",
       "1  354605              508  Clinical Trials and Supportive Activities\n",
       "2  354569              533                        Infectious Diseases\n",
       "3  354308              526                                   Genetics\n",
       "4  354279              526                                   Genetics"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where category_bra is not empty return datasets[id+unnest(category_bra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total datasets= 156605)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_bra.id</th>\n",
       "      <th>category_bra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354047</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>342554</td>\n",
       "      <td>4000</td>\n",
       "      <td>Basic Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>353585</td>\n",
       "      <td>4000</td>\n",
       "      <td>Basic Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>342185</td>\n",
       "      <td>4001</td>\n",
       "      <td>Clinical Medicine and Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>128699</td>\n",
       "      <td>4000</td>\n",
       "      <td>Basic Science</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id category_bra.id              category_bra.name\n",
       "0  354047            4001  Clinical Medicine and Science\n",
       "1  342554            4000                  Basic Science\n",
       "2  353585            4000                  Basic Science\n",
       "3  342185            4001  Clinical Medicine and Science\n",
       "4  128699            4000                  Basic Science"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where category_icrp_ct is not empty return datasets[id+unnest(category_icrp_ct)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 28 (total datasets= 68390)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_icrp_ct.id</th>\n",
       "      <th>category_icrp_ct.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354084</td>\n",
       "      <td>3816</td>\n",
       "      <td>Not Site-Specific Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354047</td>\n",
       "      <td>3809</td>\n",
       "      <td>Lung Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354047</td>\n",
       "      <td>3796</td>\n",
       "      <td>Esophageal / Oesophageal Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>353926</td>\n",
       "      <td>3835</td>\n",
       "      <td>Stomach Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>353746</td>\n",
       "      <td>3793</td>\n",
       "      <td>Colon and Rectal Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id category_icrp_ct.id            category_icrp_ct.name\n",
       "0  354084                3816         Not Site-Specific Cancer\n",
       "1  354047                3809                      Lung Cancer\n",
       "2  354047                3796  Esophageal / Oesophageal Cancer\n",
       "3  353926                3835                   Stomach Cancer\n",
       "4  353746                3793          Colon and Rectal Cancer"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where category_hrcs_hc is not empty return datasets[id+unnest(category_hrcs_hc)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 23 (total datasets= 183637)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_hc.id</th>\n",
       "      <th>category_hrcs_hc.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354047</td>\n",
       "      <td>911</td>\n",
       "      <td>Cancer</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>353905</td>\n",
       "      <td>898</td>\n",
       "      <td>Infection</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>353865</td>\n",
       "      <td>898</td>\n",
       "      <td>Infection</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>353833</td>\n",
       "      <td>898</td>\n",
       "      <td>Infection</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>353746</td>\n",
       "      <td>911</td>\n",
       "      <td>Cancer</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id category_hrcs_hc.id category_hrcs_hc.name\n",
       "0  354047                 911                Cancer\n",
       "1  353905                 898             Infection\n",
       "2  353865                 898             Infection\n",
       "3  353833                 898             Infection\n",
       "4  353746                 911                Cancer"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where category_hrcs_rac is not empty return datasets[id+unnest(category_hrcs_rac)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 48 (total datasets= 120600)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hrcs_rac.id</th>\n",
       "      <th>category_hrcs_rac.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354047</td>\n",
       "      <td>10200</td>\n",
       "      <td>2 Aetiology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354047</td>\n",
       "      <td>10201</td>\n",
       "      <td>2.1 Biological and endogenous factors</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354001</td>\n",
       "      <td>10200</td>\n",
       "      <td>2 Aetiology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354001</td>\n",
       "      <td>10205</td>\n",
       "      <td>2.5 Research design and methodologies (aetiology)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>342185</td>\n",
       "      <td>10600</td>\n",
       "      <td>6 Evaluation of Treatments and Therapeutic Int...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id category_hrcs_rac.id  \\\n",
       "0  354047                10200   \n",
       "1  354047                10201   \n",
       "2  354001                10200   \n",
       "3  354001                10205   \n",
       "4  342185                10600   \n",
       "\n",
       "                              category_hrcs_rac.name  \n",
       "0                                        2 Aetiology  \n",
       "1              2.1 Biological and endogenous factors  \n",
       "2                                        2 Aetiology  \n",
       "3  2.5 Research design and methodologies (aetiology)  \n",
       "4  6 Evaluation of Treatments and Therapeutic Int...  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where researchers is not empty return datasets[id+unnest(researchers)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 127 (total datasets= 1095306)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>researchers.id</th>\n",
       "      <th>researchers.first_name</th>\n",
       "      <th>researchers.last_name</th>\n",
       "      <th>researchers.research_orgs</th>\n",
       "      <th>researchers.orcid_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354641</td>\n",
       "      <td>ur.01011577376.25</td>\n",
       "      <td>Julien</td>\n",
       "      <td>Portela</td>\n",
       "      <td>[grid.11136.34, grid.4444.0]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354641</td>\n",
       "      <td>ur.0645601133.04</td>\n",
       "      <td>Jérôme</td>\n",
       "      <td>Boissier</td>\n",
       "      <td>[grid.4444.0, grid.11136.34, grid.411175.7, gr...</td>\n",
       "      <td>[0000-0002-0793-3108]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354641</td>\n",
       "      <td>ur.01062502717.22</td>\n",
       "      <td>Benjamin Ernest Franois</td>\n",
       "      <td>Gourbal</td>\n",
       "      <td>[grid.4444.0, grid.411065.7, grid.462844.8, gr...</td>\n",
       "      <td>[0000-0003-2097-2563]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354641</td>\n",
       "      <td>ur.01217330625.93</td>\n",
       "      <td>Vincent</td>\n",
       "      <td>Pradines</td>\n",
       "      <td>[grid.4444.0, grid.503102.5, grid.419564.b, gr...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354641</td>\n",
       "      <td>ur.010351273013.64</td>\n",
       "      <td>Vincent</td>\n",
       "      <td>Collière</td>\n",
       "      <td>[grid.9224.d, grid.15781.3a, grid.11417.32, gr...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id      researchers.id   researchers.first_name researchers.last_name  \\\n",
       "0  354641   ur.01011577376.25                   Julien               Portela   \n",
       "1  354641    ur.0645601133.04                   Jérôme              Boissier   \n",
       "2  354641   ur.01062502717.22  Benjamin Ernest Franois               Gourbal   \n",
       "3  354641   ur.01217330625.93                  Vincent              Pradines   \n",
       "4  354641  ur.010351273013.64                  Vincent              Collière   \n",
       "\n",
       "                           researchers.research_orgs   researchers.orcid_id  \n",
       "0                       [grid.11136.34, grid.4444.0]                    NaN  \n",
       "1  [grid.4444.0, grid.11136.34, grid.411175.7, gr...  [0000-0002-0793-3108]  \n",
       "2  [grid.4444.0, grid.411065.7, grid.462844.8, gr...  [0000-0003-2097-2563]  \n",
       "3  [grid.4444.0, grid.503102.5, grid.419564.b, gr...                    NaN  \n",
       "4  [grid.9224.d, grid.15781.3a, grid.11417.32, gr...                    NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where category_hra is not empty return datasets[id+unnest(category_hra)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 20 (total datasets= 164122)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_hra.id</th>\n",
       "      <th>category_hra.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354047</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>342554</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>342185</td>\n",
       "      <td>3901</td>\n",
       "      <td>Clinical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>128699</td>\n",
       "      <td>3900</td>\n",
       "      <td>Biomedical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>128693</td>\n",
       "      <td>3901</td>\n",
       "      <td>Clinical</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id category_hra.id category_hra.name\n",
       "0  354047            3900        Biomedical\n",
       "1  342554            3900        Biomedical\n",
       "2  342185            3901          Clinical\n",
       "3  128699            3900        Biomedical\n",
       "4  128693            3901          Clinical"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where category_sdg is not empty return datasets[id+unnest(category_sdg)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total datasets= 75953)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_sdg.id</th>\n",
       "      <th>category_sdg.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354171</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354132</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>353865</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>353833</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>353502</td>\n",
       "      <td>40003</td>\n",
       "      <td>3 Good Health and Well Being</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id category_sdg.id             category_sdg.name\n",
       "0  354171           40003  3 Good Health and Well Being\n",
       "1  354132           40003  3 Good Health and Well Being\n",
       "2  353865           40003  3 Good Health and Well Being\n",
       "3  353833           40003  3 Good Health and Well Being\n",
       "4  353502           40003  3 Good Health and Well Being"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where associated_grant_ids is not empty return datasets[id+unnest(associated_grant_ids)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 41 (total datasets= 409585)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>associated_grant_ids</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354171</td>\n",
       "      <td>grant.2617608</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>353905</td>\n",
       "      <td>grant.2457432</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>353905</td>\n",
       "      <td>grant.2417993</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>353865</td>\n",
       "      <td>grant.2457432</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>353865</td>\n",
       "      <td>grant.2417993</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id associated_grant_ids\n",
       "0  354171        grant.2617608\n",
       "1  353905        grant.2457432\n",
       "2  353905        grant.2417993\n",
       "3  353865        grant.2457432\n",
       "4  353865        grant.2417993"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where keywords is not empty return datasets[id+unnest(keywords)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 62 (total datasets= 1545575)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>keywords</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354641</td>\n",
       "      <td>damages</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354641</td>\n",
       "      <td>cultured</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354641</td>\n",
       "      <td>observed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354641</td>\n",
       "      <td>electron</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354605</td>\n",
       "      <td>pa1647</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id  keywords\n",
       "0  354641   damages\n",
       "1  354641  cultured\n",
       "2  354641  observed\n",
       "3  354641  electron\n",
       "4  354605    pa1647"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where category_for is not empty return datasets[id+unnest(category_for)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 42 (total datasets= 719006)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>category_for.id</th>\n",
       "      <th>category_for.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354605</td>\n",
       "      <td>2211</td>\n",
       "      <td>11 Medical and Health Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354605</td>\n",
       "      <td>3164</td>\n",
       "      <td>1115 Pharmacology and Pharmaceutical Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354569</td>\n",
       "      <td>2211</td>\n",
       "      <td>11 Medical and Health Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354569</td>\n",
       "      <td>3053</td>\n",
       "      <td>1103 Clinical Sciences</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354340</td>\n",
       "      <td>2211</td>\n",
       "      <td>11 Medical and Health Sciences</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id category_for.id                              category_for.name\n",
       "0  354605            2211                 11 Medical and Health Sciences\n",
       "1  354605            3164  1115 Pharmacology and Pharmaceutical Sciences\n",
       "2  354569            2211                 11 Medical and Health Sciences\n",
       "3  354569            3053                         1103 Clinical Sciences\n",
       "4  354340            2211                 11 Medical and Health Sciences"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where funders is not empty return datasets[id+unnest(funders)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 27 (total datasets= 674001)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funders.id</th>\n",
       "      <th>funders.name</th>\n",
       "      <th>funders.acronym</th>\n",
       "      <th>funders.linkout</th>\n",
       "      <th>funders.country_name</th>\n",
       "      <th>funders.state_name</th>\n",
       "      <th>funders.city_name</th>\n",
       "      <th>funders.latitude</th>\n",
       "      <th>funders.longitude</th>\n",
       "      <th>funders.types</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354171</td>\n",
       "      <td>grid.416870.c</td>\n",
       "      <td>National Institute of Neurological Disorders a...</td>\n",
       "      <td>NINDS</td>\n",
       "      <td>[http://www.ninds.nih.gov/]</td>\n",
       "      <td>United States</td>\n",
       "      <td>Maryland</td>\n",
       "      <td>Bethesda</td>\n",
       "      <td>39.003826</td>\n",
       "      <td>-77.101180</td>\n",
       "      <td>[Facility]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354171</td>\n",
       "      <td>grid.52788.30</td>\n",
       "      <td>Wellcome Trust</td>\n",
       "      <td>WT</td>\n",
       "      <td>[http://www.wellcome.ac.uk/]</td>\n",
       "      <td>United Kingdom</td>\n",
       "      <td>NaN</td>\n",
       "      <td>London</td>\n",
       "      <td>51.525867</td>\n",
       "      <td>-0.135005</td>\n",
       "      <td>[Nonprofit]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>353996</td>\n",
       "      <td>grid.248883.d</td>\n",
       "      <td>Canadian Institutes of Health Research</td>\n",
       "      <td>CIHR</td>\n",
       "      <td>[http://www.cihr-irsc.gc.ca/e/193.html]</td>\n",
       "      <td>Canada</td>\n",
       "      <td>Ontario</td>\n",
       "      <td>Ottawa</td>\n",
       "      <td>45.381893</td>\n",
       "      <td>-75.745224</td>\n",
       "      <td>[Government]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>353964</td>\n",
       "      <td>grid.248883.d</td>\n",
       "      <td>Canadian Institutes of Health Research</td>\n",
       "      <td>CIHR</td>\n",
       "      <td>[http://www.cihr-irsc.gc.ca/e/193.html]</td>\n",
       "      <td>Canada</td>\n",
       "      <td>Ontario</td>\n",
       "      <td>Ottawa</td>\n",
       "      <td>45.381893</td>\n",
       "      <td>-75.745224</td>\n",
       "      <td>[Government]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>353934</td>\n",
       "      <td>grid.248883.d</td>\n",
       "      <td>Canadian Institutes of Health Research</td>\n",
       "      <td>CIHR</td>\n",
       "      <td>[http://www.cihr-irsc.gc.ca/e/193.html]</td>\n",
       "      <td>Canada</td>\n",
       "      <td>Ontario</td>\n",
       "      <td>Ottawa</td>\n",
       "      <td>45.381893</td>\n",
       "      <td>-75.745224</td>\n",
       "      <td>[Government]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id     funders.id                                       funders.name  \\\n",
       "0  354171  grid.416870.c  National Institute of Neurological Disorders a...   \n",
       "1  354171  grid.52788.30                                     Wellcome Trust   \n",
       "2  353996  grid.248883.d             Canadian Institutes of Health Research   \n",
       "3  353964  grid.248883.d             Canadian Institutes of Health Research   \n",
       "4  353934  grid.248883.d             Canadian Institutes of Health Research   \n",
       "\n",
       "  funders.acronym                          funders.linkout  \\\n",
       "0           NINDS              [http://www.ninds.nih.gov/]   \n",
       "1              WT             [http://www.wellcome.ac.uk/]   \n",
       "2            CIHR  [http://www.cihr-irsc.gc.ca/e/193.html]   \n",
       "3            CIHR  [http://www.cihr-irsc.gc.ca/e/193.html]   \n",
       "4            CIHR  [http://www.cihr-irsc.gc.ca/e/193.html]   \n",
       "\n",
       "  funders.country_name funders.state_name funders.city_name  funders.latitude  \\\n",
       "0        United States           Maryland          Bethesda         39.003826   \n",
       "1       United Kingdom                NaN            London         51.525867   \n",
       "2               Canada            Ontario            Ottawa         45.381893   \n",
       "3               Canada            Ontario            Ottawa         45.381893   \n",
       "4               Canada            Ontario            Ottawa         45.381893   \n",
       "\n",
       "   funders.longitude funders.types  \n",
       "0         -77.101180    [Facility]  \n",
       "1          -0.135005   [Nonprofit]  \n",
       "2         -75.745224  [Government]  \n",
       "3         -75.745224  [Government]  \n",
       "4         -75.745224  [Government]  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where research_orgs is not empty return datasets[id+unnest(research_orgs)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 56 (total datasets= 1069665)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_orgs.id</th>\n",
       "      <th>research_orgs.name</th>\n",
       "      <th>research_orgs.linkout</th>\n",
       "      <th>research_orgs.country_name</th>\n",
       "      <th>research_orgs.state_name</th>\n",
       "      <th>research_orgs.city_name</th>\n",
       "      <th>research_orgs.latitude</th>\n",
       "      <th>research_orgs.longitude</th>\n",
       "      <th>research_orgs.types</th>\n",
       "      <th>research_orgs.acronym</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354641</td>\n",
       "      <td>grid.11136.34</td>\n",
       "      <td>University of Perpignan</td>\n",
       "      <td>[http://www.univ-perp.fr/]</td>\n",
       "      <td>France</td>\n",
       "      <td>Languedoc-Roussillon</td>\n",
       "      <td>Perpignan</td>\n",
       "      <td>42.683300</td>\n",
       "      <td>2.901670</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354641</td>\n",
       "      <td>grid.4444.0</td>\n",
       "      <td>French National Centre for Scientific Research</td>\n",
       "      <td>[http://www.cnrs.fr/index.php]</td>\n",
       "      <td>France</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Paris</td>\n",
       "      <td>48.847664</td>\n",
       "      <td>2.264034</td>\n",
       "      <td>[Government]</td>\n",
       "      <td>CNRS</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354641</td>\n",
       "      <td>grid.462228.8</td>\n",
       "      <td>Laboratoire de Chimie de Coordination</td>\n",
       "      <td>[http://www.lcc-toulouse.fr/lcc/?lang=en]</td>\n",
       "      <td>France</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Toulouse</td>\n",
       "      <td>43.557655</td>\n",
       "      <td>1.463439</td>\n",
       "      <td>[Facility]</td>\n",
       "      <td>LCC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354641</td>\n",
       "      <td>grid.503395.9</td>\n",
       "      <td>Palumed (France)</td>\n",
       "      <td>[http://lasersprint.com/palumed/?article15]</td>\n",
       "      <td>France</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Castanet-Tolosan</td>\n",
       "      <td>43.512910</td>\n",
       "      <td>1.521538</td>\n",
       "      <td>[Company]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354605</td>\n",
       "      <td>grid.11136.34</td>\n",
       "      <td>University of Perpignan</td>\n",
       "      <td>[http://www.univ-perp.fr/]</td>\n",
       "      <td>France</td>\n",
       "      <td>Languedoc-Roussillon</td>\n",
       "      <td>Perpignan</td>\n",
       "      <td>42.683300</td>\n",
       "      <td>2.901670</td>\n",
       "      <td>[Education]</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id research_orgs.id                              research_orgs.name  \\\n",
       "0  354641    grid.11136.34                         University of Perpignan   \n",
       "1  354641      grid.4444.0  French National Centre for Scientific Research   \n",
       "2  354641    grid.462228.8           Laboratoire de Chimie de Coordination   \n",
       "3  354641    grid.503395.9                                Palumed (France)   \n",
       "4  354605    grid.11136.34                         University of Perpignan   \n",
       "\n",
       "                         research_orgs.linkout research_orgs.country_name  \\\n",
       "0                   [http://www.univ-perp.fr/]                     France   \n",
       "1               [http://www.cnrs.fr/index.php]                     France   \n",
       "2    [http://www.lcc-toulouse.fr/lcc/?lang=en]                     France   \n",
       "3  [http://lasersprint.com/palumed/?article15]                     France   \n",
       "4                   [http://www.univ-perp.fr/]                     France   \n",
       "\n",
       "  research_orgs.state_name research_orgs.city_name  research_orgs.latitude  \\\n",
       "0     Languedoc-Roussillon               Perpignan               42.683300   \n",
       "1                      NaN                   Paris               48.847664   \n",
       "2                      NaN                Toulouse               43.557655   \n",
       "3                      NaN        Castanet-Tolosan               43.512910   \n",
       "4     Languedoc-Roussillon               Perpignan               42.683300   \n",
       "\n",
       "   research_orgs.longitude research_orgs.types research_orgs.acronym  \n",
       "0                 2.901670         [Education]                   NaN  \n",
       "1                 2.264034        [Government]                  CNRS  \n",
       "2                 1.463439          [Facility]                   LCC  \n",
       "3                 1.521538           [Company]                   NaN  \n",
       "4                 2.901670         [Education]                   NaN  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where funder_countries is not empty return datasets[id+unnest(funder_countries)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 27 (total datasets= 673991)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>funder_countries.id</th>\n",
       "      <th>funder_countries.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354171</td>\n",
       "      <td>US</td>\n",
       "      <td>United States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354171</td>\n",
       "      <td>GB</td>\n",
       "      <td>United Kingdom</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>353996</td>\n",
       "      <td>CA</td>\n",
       "      <td>Canada</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>353964</td>\n",
       "      <td>CA</td>\n",
       "      <td>Canada</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>353934</td>\n",
       "      <td>CA</td>\n",
       "      <td>Canada</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id funder_countries.id funder_countries.name\n",
       "0  354171                  US         United States\n",
       "1  354171                  GB        United Kingdom\n",
       "2  353996                  CA                Canada\n",
       "3  353964                  CA                Canada\n",
       "4  353934                  CA                Canada"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where research_org_cities is not empty return datasets[id+unnest(research_org_cities)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 56 (total datasets= 1045112)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>research_org_cities.id</th>\n",
       "      <th>research_org_cities.name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354641</td>\n",
       "      <td>2987914</td>\n",
       "      <td>Perpignan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354641</td>\n",
       "      <td>2988507</td>\n",
       "      <td>Paris</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354641</td>\n",
       "      <td>2972315</td>\n",
       "      <td>Toulouse</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354641</td>\n",
       "      <td>3028409</td>\n",
       "      <td>Castanet-Tolosan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354605</td>\n",
       "      <td>2987914</td>\n",
       "      <td>Perpignan</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id  research_org_cities.id research_org_cities.name\n",
       "0  354641                 2987914                Perpignan\n",
       "1  354641                 2988507                    Paris\n",
       "2  354641                 2972315                 Toulouse\n",
       "3  354641                 3028409         Castanet-Tolosan\n",
       "4  354605                 2987914                Perpignan"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search datasets where authors is not empty return datasets[id+unnest(authors)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 138 (total datasets= 1547302)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>authors.name</th>\n",
       "      <th>authors.orcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354641</td>\n",
       "      <td>Julien Portela</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354641</td>\n",
       "      <td>Jérôme Boissier</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354641</td>\n",
       "      <td>Benjamin Gourbal</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354641</td>\n",
       "      <td>Vincent Pradines</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354641</td>\n",
       "      <td>Vincent Collière</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id      authors.name authors.orcid\n",
       "0  354641    Julien Portela              \n",
       "1  354641   Jérôme Boissier              \n",
       "2  354641  Benjamin Gourbal              \n",
       "3  354641  Vincent Pradines              \n",
       "4  354641  Vincent Collière              "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "sources = G.sources()\n",
    "\n",
    "def get_fields(source):\n",
    "    \"get all multivalue fields for a source\"\n",
    "    res = []\n",
    "    z = dsl.query(f\"describe source {source}\")\n",
    "    for x in z['fields']:\n",
    "        if z['fields'][x]['is_multivalue']:\n",
    "            res += [x]\n",
    "    return res\n",
    "\n",
    "q = \"\"\"search {} where {} is not empty return {}[id+unnest({})]\"\"\"\n",
    "\n",
    "for s in sources:\n",
    "    print(\"\\n***********************\")\n",
    "    print(\"SOURCE:\", s)\n",
    "    print(\"***********************\")\n",
    "    fields = get_fields(s)\n",
    "    print(\"Fields: \", fields)\n",
    "    for f in fields:\n",
    "        query = q.format(s, f, s, f)\n",
    "        print(\"\\n====\\n\", query, \"\\n====\\n\")\n",
    "        try:\n",
    "            display(dsl.query(query).as_dataframe().head(5))\n",
    "        except:\n",
    "            print(\"Error\")\n",
    "        time.sleep(1)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## DSL-482 Extend `Unnest` to handle JSON fields\n",
    "\n",
    "https://uberresearch.atlassian.net/browse/DSL-482"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: publications\n",
      "***********************\n",
      "Fields:  ['concepts_scores', 'concepts', 'authors']\n",
      "\n",
      "====\n",
      " search publications where concepts_scores is not empty return publications[id+unnest(concepts_scores)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 546 (total publications= 96597153)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>concepts_scores.concept</th>\n",
       "      <th>concepts_scores.relevance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1125801740</td>\n",
       "      <td>perspective</td>\n",
       "      <td>0.055219</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1125801740</td>\n",
       "      <td>sunflower</td>\n",
       "      <td>0.024626</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>social marketing interventions</td>\n",
       "      <td>0.614269</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>tropical diseases</td>\n",
       "      <td>0.601465</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>determinants of health</td>\n",
       "      <td>0.534471</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id         concepts_scores.concept  concepts_scores.relevance\n",
       "0  pub.1125801740                     perspective                   0.055219\n",
       "1  pub.1125801740                       sunflower                   0.024626\n",
       "2  pub.1124196727  social marketing interventions                   0.614269\n",
       "3  pub.1124196727               tropical diseases                   0.601465\n",
       "4  pub.1124196727          determinants of health                   0.534471"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where concepts is not empty return publications[id+unnest(concepts)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 546 (total publications= 96597153)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>concepts</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1125801740</td>\n",
       "      <td>perspective</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1125801740</td>\n",
       "      <td>sunflower</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>social marketing interventions</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>tropical diseases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>determinants of health</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id                        concepts\n",
       "0  pub.1125801740                     perspective\n",
       "1  pub.1125801740                       sunflower\n",
       "2  pub.1124196727  social marketing interventions\n",
       "3  pub.1124196727               tropical diseases\n",
       "4  pub.1124196727          determinants of health"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search publications where authors is not empty return publications[id+unnest(authors)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 45 (total publications= 101368535)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>authors.first_name</th>\n",
       "      <th>authors.last_name</th>\n",
       "      <th>authors.corresponding</th>\n",
       "      <th>authors.orcid</th>\n",
       "      <th>authors.affiliations</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1125801740</td>\n",
       "      <td>Nienke</td>\n",
       "      <td>Bakker</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1125801740</td>\n",
       "      <td>Christopher</td>\n",
       "      <td>Riopelle</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1096916023</td>\n",
       "      <td>Jochen</td>\n",
       "      <td>Taupitz</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>Nathaly</td>\n",
       "      <td>Aya Pastrana</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[{'raw_affiliation': 'BeCHANGE Research Group,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1124196727</td>\n",
       "      <td>Claire</td>\n",
       "      <td>Somerville</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[{'raw_affiliation': 'Gender Centre, Graduate ...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id authors.first_name authors.last_name authors.corresponding  \\\n",
       "0  pub.1125801740             Nienke            Bakker                         \n",
       "1  pub.1125801740        Christopher          Riopelle                         \n",
       "2  pub.1096916023             Jochen           Taupitz                         \n",
       "3  pub.1124196727            Nathaly      Aya Pastrana                         \n",
       "4  pub.1124196727             Claire        Somerville                         \n",
       "\n",
       "  authors.orcid                               authors.affiliations  \n",
       "0                                                               []  \n",
       "1                                                               []  \n",
       "2                                                               []  \n",
       "3                [{'raw_affiliation': 'BeCHANGE Research Group,...  \n",
       "4                [{'raw_affiliation': 'Gender Centre, Graduate ...  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: grants\n",
      "***********************\n",
      "Fields:  ['investigator_details']\n",
      "\n",
      "====\n",
      " search grants where investigator_details is not empty return grants[id+unnest(investigator_details)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 21 (total grants= 4953049)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>investigator_details.id</th>\n",
       "      <th>investigator_details.first_name</th>\n",
       "      <th>investigator_details.middle_name</th>\n",
       "      <th>investigator_details.last_name</th>\n",
       "      <th>investigator_details.role</th>\n",
       "      <th>investigator_details.affiliations</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>grant.6946936</td>\n",
       "      <td>ur.0765112007.90</td>\n",
       "      <td>M.J.A.</td>\n",
       "      <td></td>\n",
       "      <td>Weterings</td>\n",
       "      <td>PI</td>\n",
       "      <td>[{'id': 'grid.450080.9', 'name': 'Van Hall Lar...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>grant.8690978</td>\n",
       "      <td>ur.01103433444.38</td>\n",
       "      <td>Sohrab</td>\n",
       "      <td>None</td>\n",
       "      <td>Lutchmedial</td>\n",
       "      <td>PI</td>\n",
       "      <td>[{'id': 'grid.428748.5', 'name': 'Horizon Heal...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>grant.8950252</td>\n",
       "      <td>ur.0674515014.41</td>\n",
       "      <td>Corentin</td>\n",
       "      <td></td>\n",
       "      <td>CLAEYS BOUUAERT</td>\n",
       "      <td>PI</td>\n",
       "      <td>[{'id': 'grid.7942.8', 'name': 'UCLouvain', 'c...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>grant.8715161</td>\n",
       "      <td>ur.016564317465.72</td>\n",
       "      <td>Charles</td>\n",
       "      <td></td>\n",
       "      <td>WOLFE</td>\n",
       "      <td>PI</td>\n",
       "      <td>[{'id': 'grid.7520.0', 'name': 'Universität Kl...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>grant.9284620</td>\n",
       "      <td>None</td>\n",
       "      <td>Yuko</td>\n",
       "      <td>None</td>\n",
       "      <td>Miki</td>\n",
       "      <td>PI</td>\n",
       "      <td>[{'id': 'grid.256023.0', 'name': 'Fordham Univ...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id investigator_details.id investigator_details.first_name  \\\n",
       "0  grant.6946936        ur.0765112007.90                          M.J.A.   \n",
       "1  grant.8690978       ur.01103433444.38                          Sohrab   \n",
       "2  grant.8950252        ur.0674515014.41                        Corentin   \n",
       "3  grant.8715161      ur.016564317465.72                         Charles   \n",
       "4  grant.9284620                    None                            Yuko   \n",
       "\n",
       "  investigator_details.middle_name investigator_details.last_name  \\\n",
       "0                                                       Weterings   \n",
       "1                             None                    Lutchmedial   \n",
       "2                                                 CLAEYS BOUUAERT   \n",
       "3                                                           WOLFE   \n",
       "4                             None                           Miki   \n",
       "\n",
       "  investigator_details.role                  investigator_details.affiliations  \n",
       "0                        PI  [{'id': 'grid.450080.9', 'name': 'Van Hall Lar...  \n",
       "1                        PI  [{'id': 'grid.428748.5', 'name': 'Horizon Heal...  \n",
       "2                        PI  [{'id': 'grid.7942.8', 'name': 'UCLouvain', 'c...  \n",
       "3                        PI  [{'id': 'grid.7520.0', 'name': 'Universität Kl...  \n",
       "4                        PI  [{'id': 'grid.256023.0', 'name': 'Fordham Univ...  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: patents\n",
      "***********************\n",
      "Fields:  []\n",
      "\n",
      "***********************\n",
      "SOURCE: clinical_trials\n",
      "***********************\n",
      "Fields:  ['investigator_details', 'interventions']\n",
      "\n",
      "====\n",
      " search clinical_trials where investigator_details is not empty return clinical_trials[id+unnest(investigator_details)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 35 (total clinical_trials= 440671)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>investigator_details</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>[Lance Leopold, MD, Study Director, Incyte Cor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>[David Williamson, PhD, Principal Investigator...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>[Marc Perreaut, PharmD, Principal Investigator...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>[Anne Julie Frenette, MSc, Principal Investiga...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>[Sudeesh Tantry, PhD, Study Director, Glenmark...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id                               investigator_details\n",
       "0  NCT02318277  [Lance Leopold, MD, Study Director, Incyte Cor...\n",
       "1  NCT02318290  [David Williamson, PhD, Principal Investigator...\n",
       "2  NCT02318290  [Marc Perreaut, PharmD, Principal Investigator...\n",
       "3  NCT02318290  [Anne Julie Frenette, MSc, Principal Investiga...\n",
       "4  NCT02318303  [Sudeesh Tantry, PhD, Study Director, Glenmark..."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "====\n",
      " search clinical_trials where interventions is not empty return clinical_trials[id+unnest(interventions)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 38 (total clinical_trials= 462789)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>interventions.type</th>\n",
       "      <th>interventions.name</th>\n",
       "      <th>interventions.description</th>\n",
       "      <th>interventions.arm_group_labels</th>\n",
       "      <th>interventions.other_names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318264</td>\n",
       "      <td>Device</td>\n",
       "      <td>Kinesio Tape</td>\n",
       "      <td>Elastic tape placed over the skin</td>\n",
       "      <td>Distal to Proximal Tape, Proximal to Distal Tape</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>Drug</td>\n",
       "      <td>INCB024360</td>\n",
       "      <td>INCB024360: Oral daily dosing</td>\n",
       "      <td>MEDI4736 + INCB024360</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318277</td>\n",
       "      <td>Drug</td>\n",
       "      <td>MEDI4736</td>\n",
       "      <td>MEDI4736 administered intravenously (IV) every...</td>\n",
       "      <td>MEDI4736 + INCB024360</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>Drug</td>\n",
       "      <td>Opiates</td>\n",
       "      <td>Mechanically ventilated patients receiving opi...</td>\n",
       "      <td>Critically ill patients</td>\n",
       "      <td>Analgesics, Narcotics</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>Drug</td>\n",
       "      <td>Mometasone Furoate-2 NS (BID)</td>\n",
       "      <td>Mometasone furoate-2 NS (25 μg) administered a...</td>\n",
       "      <td>Mometasone Furoate-2 NS (BID)</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            id interventions.type             interventions.name  \\\n",
       "0  NCT02318264             Device                   Kinesio Tape   \n",
       "1  NCT02318277               Drug                     INCB024360   \n",
       "2  NCT02318277               Drug                       MEDI4736   \n",
       "3  NCT02318290               Drug                        Opiates   \n",
       "4  NCT02318303               Drug  Mometasone Furoate-2 NS (BID)   \n",
       "\n",
       "                           interventions.description  \\\n",
       "0                  Elastic tape placed over the skin   \n",
       "1                      INCB024360: Oral daily dosing   \n",
       "2  MEDI4736 administered intravenously (IV) every...   \n",
       "3  Mechanically ventilated patients receiving opi...   \n",
       "4  Mometasone furoate-2 NS (25 μg) administered a...   \n",
       "\n",
       "                     interventions.arm_group_labels interventions.other_names  \n",
       "0  Distal to Proximal Tape, Proximal to Distal Tape                            \n",
       "1                             MEDI4736 + INCB024360                            \n",
       "2                             MEDI4736 + INCB024360                            \n",
       "3                           Critically ill patients     Analgesics, Narcotics  \n",
       "4                     Mometasone Furoate-2 NS (BID)                            "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "***********************\n",
      "SOURCE: policy_documents\n",
      "***********************\n",
      "Fields:  []\n",
      "\n",
      "***********************\n",
      "SOURCE: researchers\n",
      "***********************\n",
      "Fields:  []\n",
      "\n",
      "***********************\n",
      "SOURCE: organizations\n",
      "***********************\n",
      "Fields:  []\n",
      "\n",
      "***********************\n",
      "SOURCE: datasets\n",
      "***********************\n",
      "Fields:  ['authors']\n",
      "\n",
      "====\n",
      " search datasets where authors is not empty return datasets[id+unnest(authors)] \n",
      "====\n",
      "\n",
      "Returned records after unnesting: 138 (total datasets= 1547302)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>authors.name</th>\n",
       "      <th>authors.orcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354641</td>\n",
       "      <td>Julien Portela</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354641</td>\n",
       "      <td>Jérôme Boissier</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354641</td>\n",
       "      <td>Benjamin Gourbal</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354641</td>\n",
       "      <td>Vincent Pradines</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354641</td>\n",
       "      <td>Vincent Collière</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id      authors.name authors.orcid\n",
       "0  354641    Julien Portela              \n",
       "1  354641   Jérôme Boissier              \n",
       "2  354641  Benjamin Gourbal              \n",
       "3  354641  Vincent Pradines              \n",
       "4  354641  Vincent Collière              "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "sources = G.sources()\n",
    "\n",
    "def get_fields(source):\n",
    "    \"get all JSON fields for a source\"\n",
    "    res = []\n",
    "    z = dsl.query(f\"describe source {source}\")\n",
    "    for x in z['fields']:\n",
    "        if z['fields'][x]['type'] == \"json\":\n",
    "            res += [x]\n",
    "    return res\n",
    "\n",
    "q = \"\"\"search {} where {} is not empty return {}[id+unnest({})]\"\"\"\n",
    "\n",
    "for s in sources:\n",
    "    print(\"\\n***********************\")\n",
    "    print(\"SOURCE:\", s)\n",
    "    print(\"***********************\")\n",
    "    fields = get_fields(s)\n",
    "    print(\"Fields: \", fields)\n",
    "    for f in fields:\n",
    "        query = q.format(s, f, s, f)\n",
    "        print(\"\\n====\\n\", query, \"\\n====\\n\")\n",
    "        try:\n",
    "            display(dsl.query(query).as_dataframe().head(5))\n",
    "        except:\n",
    "            print(\"Error\")\n",
    "        time.sleep(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## DSL-407 Field for 'dimensions_url'\n",
    "\n",
    "https://uberresearch.atlassian.net/browse/DSL-407"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [],
   "source": [
    "s = G.sources()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Publications: 5 (total = 12373017)\n",
      "https://app.dimensions.ai/details/publication/pub.1125632078\n",
      "https://app.dimensions.ai/details/publication/pub.1125627213\n",
      "https://app.dimensions.ai/details/publication/pub.1125147806\n",
      "https://app.dimensions.ai/details/publication/pub.1124666673\n",
      "https://app.dimensions.ai/details/publication/pub.1124012124\n",
      "Returned Grants: 5 (total = 23150)\n",
      "https://app.dimensions.ai/details/grant/grant.7444339\n",
      "https://app.dimensions.ai/details/grant/grant.9216320\n",
      "https://app.dimensions.ai/details/grant/grant.9068276\n",
      "https://app.dimensions.ai/details/grant/grant.9216819\n",
      "https://app.dimensions.ai/details/grant/grant.9216261\n",
      "Returned Patents: 5 (total = 662386)\n",
      "https://app.dimensions.ai/details/patent/GB-8702521-D0\n",
      "https://app.dimensions.ai/details/patent/AU-123650-S\n",
      "https://app.dimensions.ai/details/patent/AU-8790698-A\n",
      "https://app.dimensions.ai/details/patent/AU-PN487995-A0\n",
      "https://app.dimensions.ai/details/patent/GB-8529375-D0\n",
      "Returned Clinical_trials: 5 (total = 8570)\n",
      "https://app.dimensions.ai/details/clinical_trial/NCT03154697\n",
      "https://app.dimensions.ai/details/clinical_trial/NCT03687593\n",
      "https://app.dimensions.ai/details/clinical_trial/ISRCTN66418282\n",
      "https://app.dimensions.ai/details/clinical_trial/ACTRN12609001062213\n",
      "https://app.dimensions.ai/details/clinical_trial/NCT00004347\n",
      "Returned Policy_documents: 5 (total = 53651)\n",
      "https://app.dimensions.ai/details/policy_documents/policy.689167\n",
      "https://app.dimensions.ai/details/policy_documents/policy.689168\n",
      "https://app.dimensions.ai/details/policy_documents/policy.146607\n",
      "https://app.dimensions.ai/details/policy_documents/policy.146942\n",
      "https://app.dimensions.ai/details/policy_documents/policy.54740\n",
      "Returned Researchers: 0\n",
      "Returned Organizations: 5 (total = 47)\n",
      "https://app.dimensions.ai/discover/publication?and_facet_research_org=grid.263724.6\n",
      "https://app.dimensions.ai/discover/publication?and_facet_research_org=grid.474189.7\n",
      "https://app.dimensions.ai/discover/publication?and_facet_research_org=grid.474193.c\n",
      "https://app.dimensions.ai/discover/publication?and_facet_research_org=grid.477245.7\n",
      "https://app.dimensions.ai/discover/publication?and_facet_research_org=grid.437995.5\n",
      "Returned Datasets: 5 (total = 17526)\n",
      "https://app.dimensions.ai/details/data_set/11101541\n",
      "https://app.dimensions.ai/details/data_set/4162785\n",
      "https://app.dimensions.ai/details/data_set/4133541\n",
      "https://app.dimensions.ai/details/data_set/4133535\n",
      "https://app.dimensions.ai/details/data_set/4077258\n"
     ]
    }
   ],
   "source": [
    "for x in s:\n",
    "    data = dsl.query(f\"\"\"search {x} for \"smith\" return {x}[id+dimensions_url] limit 5\"\"\")\n",
    "    for l in getattr(data, x):\n",
    "        print(l['dimensions_url'])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## DSL-63 Add DOIs/ PMIDs/ PMCIDs to references\n",
    "\n",
    "* New field publications in patents, clinical_trials and policy_documents\n",
    "* New field associated_publication in datasets\n",
    "* New field referenced_pubs in publications\n",
    "\n",
    "https://uberresearch.atlassian.net/browse/DSL-63"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "### Patents"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 5 (total patents= 1667333)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publications.id</th>\n",
       "      <th>publications.doi</th>\n",
       "      <th>publications.pmid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>GB-2460638-A</td>\n",
       "      <td>pub.1040866712</td>\n",
       "      <td>10.1016/j.bbamem.2008.06.017</td>\n",
       "      <td>18655769</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>EP-2131651-A1</td>\n",
       "      <td>pub.1051424394</td>\n",
       "      <td>10.1016/j.pbb.2004.12.005</td>\n",
       "      <td>15680187</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>GB-2460584-A</td>\n",
       "      <td>pub.1063922419</td>\n",
       "      <td>10.1177/104239159200400301</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>GB-2460571-A</td>\n",
       "      <td>pub.1016596399</td>\n",
       "      <td>10.1111/j.1365-3040.1989.tb02123.x</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>EP-2131952-A1</td>\n",
       "      <td>pub.1052080023</td>\n",
       "      <td>10.1016/s0376-7388(00)00535-4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id publications.id                    publications.doi  \\\n",
       "0   GB-2460638-A  pub.1040866712        10.1016/j.bbamem.2008.06.017   \n",
       "1  EP-2131651-A1  pub.1051424394           10.1016/j.pbb.2004.12.005   \n",
       "2   GB-2460584-A  pub.1063922419          10.1177/104239159200400301   \n",
       "3   GB-2460571-A  pub.1016596399  10.1111/j.1365-3040.1989.tb02123.x   \n",
       "4  EP-2131952-A1  pub.1052080023       10.1016/s0376-7388(00)00535-4   \n",
       "\n",
       "  publications.pmid  \n",
       "0          18655769  \n",
       "1          15680187  \n",
       "2               NaN  \n",
       "3               NaN  \n",
       "4               NaN  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search patents where publications is not empty return patents[id+unnest(publications)] limit 5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 50 (total patents= 36)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publications.id</th>\n",
       "      <th>publications.doi</th>\n",
       "      <th>publications.pmid</th>\n",
       "      <th>publications.pmcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1012091302</td>\n",
       "      <td>10.1006/geno.2000.6141</td>\n",
       "      <td>10777659</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1017599293</td>\n",
       "      <td>10.1093/nar/26.21.5007</td>\n",
       "      <td>9776767</td>\n",
       "      <td>PMC147919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1008324335</td>\n",
       "      <td>10.1101/gr.181501</td>\n",
       "      <td>11591650</td>\n",
       "      <td>PMC311161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1053136957</td>\n",
       "      <td>10.1006/abio.1999.4063</td>\n",
       "      <td>10328771</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1009669527</td>\n",
       "      <td>10.1006/prep.2000.1317</td>\n",
       "      <td>11087676</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1049125853</td>\n",
       "      <td>10.1002/pmic.200390038</td>\n",
       "      <td>12627378</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1027343635</td>\n",
       "      <td>10.1023/a:1025424814739</td>\n",
       "      <td>14558660</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1025386868</td>\n",
       "      <td>10.1038/ng1140</td>\n",
       "      <td>12679813</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1038950644</td>\n",
       "      <td>10.1007/s00253-002-1158-6</td>\n",
       "      <td>12536251</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>DE-102007062847-A1</td>\n",
       "      <td>pub.1030486526</td>\n",
       "      <td>10.1073/pnas.042684199</td>\n",
       "      <td>11880620</td>\n",
       "      <td>PMC122403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>WO-2012107596-A2</td>\n",
       "      <td>pub.1009669527</td>\n",
       "      <td>10.1006/prep.2000.1317</td>\n",
       "      <td>11087676</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>WO-2012107596-A2</td>\n",
       "      <td>pub.1049125853</td>\n",
       "      <td>10.1002/pmic.200390038</td>\n",
       "      <td>12627378</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>WO-2012107596-A2</td>\n",
       "      <td>pub.1053136957</td>\n",
       "      <td>10.1006/abio.1999.4063</td>\n",
       "      <td>10328771</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>WO-2012107596-A2</td>\n",
       "      <td>pub.1017599293</td>\n",
       "      <td>10.1093/nar/26.21.5007</td>\n",
       "      <td>9776767</td>\n",
       "      <td>PMC147919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>WO-2012107596-A2</td>\n",
       "      <td>pub.1008324335</td>\n",
       "      <td>10.1101/gr.181501</td>\n",
       "      <td>11591650</td>\n",
       "      <td>PMC311161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>WO-2012107596-A2</td>\n",
       "      <td>pub.1025386868</td>\n",
       "      <td>10.1038/ng1140</td>\n",
       "      <td>12679813</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>WO-2012107596-A2</td>\n",
       "      <td>pub.1027343635</td>\n",
       "      <td>10.1023/a:1025424814739</td>\n",
       "      <td>14558660</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>WO-2012107596-A2</td>\n",
       "      <td>pub.1030486526</td>\n",
       "      <td>10.1073/pnas.042684199</td>\n",
       "      <td>11880620</td>\n",
       "      <td>PMC122403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>WO-2012107596-A2</td>\n",
       "      <td>pub.1012091302</td>\n",
       "      <td>10.1006/geno.2000.6141</td>\n",
       "      <td>10777659</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>EP-2712932-A2</td>\n",
       "      <td>pub.1053136957</td>\n",
       "      <td>10.1006/abio.1999.4063</td>\n",
       "      <td>10328771</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>EP-2712932-A2</td>\n",
       "      <td>pub.1025386868</td>\n",
       "      <td>10.1038/ng1140</td>\n",
       "      <td>12679813</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>EP-2712932-A2</td>\n",
       "      <td>pub.1009669527</td>\n",
       "      <td>10.1006/prep.2000.1317</td>\n",
       "      <td>11087676</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>EP-2712932-A2</td>\n",
       "      <td>pub.1012091302</td>\n",
       "      <td>10.1006/geno.2000.6141</td>\n",
       "      <td>10777659</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>EP-2712932-A2</td>\n",
       "      <td>pub.1008324335</td>\n",
       "      <td>10.1101/gr.181501</td>\n",
       "      <td>11591650</td>\n",
       "      <td>PMC311161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>EP-2712932-A2</td>\n",
       "      <td>pub.1017599293</td>\n",
       "      <td>10.1093/nar/26.21.5007</td>\n",
       "      <td>9776767</td>\n",
       "      <td>PMC147919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>EP-2712932-A2</td>\n",
       "      <td>pub.1030486526</td>\n",
       "      <td>10.1073/pnas.042684199</td>\n",
       "      <td>11880620</td>\n",
       "      <td>PMC122403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>EP-2712932-A2</td>\n",
       "      <td>pub.1027343635</td>\n",
       "      <td>10.1023/a:1025424814739</td>\n",
       "      <td>14558660</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>EP-2712932-A2</td>\n",
       "      <td>pub.1049125853</td>\n",
       "      <td>10.1002/pmic.200390038</td>\n",
       "      <td>12627378</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1017599293</td>\n",
       "      <td>10.1093/nar/26.21.5007</td>\n",
       "      <td>9776767</td>\n",
       "      <td>PMC147919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1009669527</td>\n",
       "      <td>10.1006/prep.2000.1317</td>\n",
       "      <td>11087676</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1053136957</td>\n",
       "      <td>10.1006/abio.1999.4063</td>\n",
       "      <td>10328771</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1030486526</td>\n",
       "      <td>10.1073/pnas.042684199</td>\n",
       "      <td>11880620</td>\n",
       "      <td>PMC122403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1008324335</td>\n",
       "      <td>10.1101/gr.181501</td>\n",
       "      <td>11591650</td>\n",
       "      <td>PMC311161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1027343635</td>\n",
       "      <td>10.1023/a:1025424814739</td>\n",
       "      <td>14558660</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1050989784</td>\n",
       "      <td>10.1371/journal.pone.0085784</td>\n",
       "      <td>24551036</td>\n",
       "      <td>PMC3925090</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1015963001</td>\n",
       "      <td>10.1136/annrheumdis-2012-201612</td>\n",
       "      <td>22739990</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1025386868</td>\n",
       "      <td>10.1038/ng1140</td>\n",
       "      <td>12679813</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1011853799</td>\n",
       "      <td>10.1093/bioinformatics/19.2.185</td>\n",
       "      <td>12538238</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1012091302</td>\n",
       "      <td>10.1006/geno.2000.6141</td>\n",
       "      <td>10777659</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1018468101</td>\n",
       "      <td>10.1016/0378-1119(89)90470-8</td>\n",
       "      <td>2515992</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>WO-2017168014-A1</td>\n",
       "      <td>pub.1030379526</td>\n",
       "      <td>10.1016/s0076-6879(00)28419-x</td>\n",
       "      <td>11075367</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>EP-2441848-A1</td>\n",
       "      <td>pub.1053136957</td>\n",
       "      <td>10.1006/abio.1999.4063</td>\n",
       "      <td>10328771</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>EP-2441848-A1</td>\n",
       "      <td>pub.1025386868</td>\n",
       "      <td>10.1038/ng1140</td>\n",
       "      <td>12679813</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>EP-2441848-A1</td>\n",
       "      <td>pub.1009669527</td>\n",
       "      <td>10.1006/prep.2000.1317</td>\n",
       "      <td>11087676</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>EP-2441848-A1</td>\n",
       "      <td>pub.1012091302</td>\n",
       "      <td>10.1006/geno.2000.6141</td>\n",
       "      <td>10777659</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>EP-2441848-A1</td>\n",
       "      <td>pub.1008324335</td>\n",
       "      <td>10.1101/gr.181501</td>\n",
       "      <td>11591650</td>\n",
       "      <td>PMC311161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>EP-2441848-A1</td>\n",
       "      <td>pub.1017599293</td>\n",
       "      <td>10.1093/nar/26.21.5007</td>\n",
       "      <td>9776767</td>\n",
       "      <td>PMC147919</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>EP-2441848-A1</td>\n",
       "      <td>pub.1030486526</td>\n",
       "      <td>10.1073/pnas.042684199</td>\n",
       "      <td>11880620</td>\n",
       "      <td>PMC122403</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>EP-2441848-A1</td>\n",
       "      <td>pub.1027343635</td>\n",
       "      <td>10.1023/a:1025424814739</td>\n",
       "      <td>14558660</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>EP-2441848-A1</td>\n",
       "      <td>pub.1049125853</td>\n",
       "      <td>10.1002/pmic.200390038</td>\n",
       "      <td>12627378</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    id publications.id                 publications.doi  \\\n",
       "0   DE-102007062847-A1  pub.1012091302           10.1006/geno.2000.6141   \n",
       "1   DE-102007062847-A1  pub.1017599293           10.1093/nar/26.21.5007   \n",
       "2   DE-102007062847-A1  pub.1008324335                10.1101/gr.181501   \n",
       "3   DE-102007062847-A1  pub.1053136957           10.1006/abio.1999.4063   \n",
       "4   DE-102007062847-A1  pub.1009669527           10.1006/prep.2000.1317   \n",
       "5   DE-102007062847-A1  pub.1049125853           10.1002/pmic.200390038   \n",
       "6   DE-102007062847-A1  pub.1027343635          10.1023/a:1025424814739   \n",
       "7   DE-102007062847-A1  pub.1025386868                   10.1038/ng1140   \n",
       "8   DE-102007062847-A1  pub.1038950644        10.1007/s00253-002-1158-6   \n",
       "9   DE-102007062847-A1  pub.1030486526           10.1073/pnas.042684199   \n",
       "10    WO-2012107596-A2  pub.1009669527           10.1006/prep.2000.1317   \n",
       "11    WO-2012107596-A2  pub.1049125853           10.1002/pmic.200390038   \n",
       "12    WO-2012107596-A2  pub.1053136957           10.1006/abio.1999.4063   \n",
       "13    WO-2012107596-A2  pub.1017599293           10.1093/nar/26.21.5007   \n",
       "14    WO-2012107596-A2  pub.1008324335                10.1101/gr.181501   \n",
       "15    WO-2012107596-A2  pub.1025386868                   10.1038/ng1140   \n",
       "16    WO-2012107596-A2  pub.1027343635          10.1023/a:1025424814739   \n",
       "17    WO-2012107596-A2  pub.1030486526           10.1073/pnas.042684199   \n",
       "18    WO-2012107596-A2  pub.1012091302           10.1006/geno.2000.6141   \n",
       "19       EP-2712932-A2  pub.1053136957           10.1006/abio.1999.4063   \n",
       "20       EP-2712932-A2  pub.1025386868                   10.1038/ng1140   \n",
       "21       EP-2712932-A2  pub.1009669527           10.1006/prep.2000.1317   \n",
       "22       EP-2712932-A2  pub.1012091302           10.1006/geno.2000.6141   \n",
       "23       EP-2712932-A2  pub.1008324335                10.1101/gr.181501   \n",
       "24       EP-2712932-A2  pub.1017599293           10.1093/nar/26.21.5007   \n",
       "25       EP-2712932-A2  pub.1030486526           10.1073/pnas.042684199   \n",
       "26       EP-2712932-A2  pub.1027343635          10.1023/a:1025424814739   \n",
       "27       EP-2712932-A2  pub.1049125853           10.1002/pmic.200390038   \n",
       "28    WO-2017168014-A1  pub.1017599293           10.1093/nar/26.21.5007   \n",
       "29    WO-2017168014-A1  pub.1009669527           10.1006/prep.2000.1317   \n",
       "30    WO-2017168014-A1  pub.1053136957           10.1006/abio.1999.4063   \n",
       "31    WO-2017168014-A1  pub.1030486526           10.1073/pnas.042684199   \n",
       "32    WO-2017168014-A1  pub.1008324335                10.1101/gr.181501   \n",
       "33    WO-2017168014-A1  pub.1027343635          10.1023/a:1025424814739   \n",
       "34    WO-2017168014-A1  pub.1050989784     10.1371/journal.pone.0085784   \n",
       "35    WO-2017168014-A1  pub.1015963001  10.1136/annrheumdis-2012-201612   \n",
       "36    WO-2017168014-A1  pub.1025386868                   10.1038/ng1140   \n",
       "37    WO-2017168014-A1  pub.1011853799  10.1093/bioinformatics/19.2.185   \n",
       "38    WO-2017168014-A1  pub.1012091302           10.1006/geno.2000.6141   \n",
       "39    WO-2017168014-A1  pub.1018468101     10.1016/0378-1119(89)90470-8   \n",
       "40    WO-2017168014-A1  pub.1030379526    10.1016/s0076-6879(00)28419-x   \n",
       "41       EP-2441848-A1  pub.1053136957           10.1006/abio.1999.4063   \n",
       "42       EP-2441848-A1  pub.1025386868                   10.1038/ng1140   \n",
       "43       EP-2441848-A1  pub.1009669527           10.1006/prep.2000.1317   \n",
       "44       EP-2441848-A1  pub.1012091302           10.1006/geno.2000.6141   \n",
       "45       EP-2441848-A1  pub.1008324335                10.1101/gr.181501   \n",
       "46       EP-2441848-A1  pub.1017599293           10.1093/nar/26.21.5007   \n",
       "47       EP-2441848-A1  pub.1030486526           10.1073/pnas.042684199   \n",
       "48       EP-2441848-A1  pub.1027343635          10.1023/a:1025424814739   \n",
       "49       EP-2441848-A1  pub.1049125853           10.1002/pmic.200390038   \n",
       "\n",
       "   publications.pmid publications.pmcid  \n",
       "0           10777659                NaN  \n",
       "1            9776767          PMC147919  \n",
       "2           11591650          PMC311161  \n",
       "3           10328771                NaN  \n",
       "4           11087676                NaN  \n",
       "5           12627378                NaN  \n",
       "6           14558660                NaN  \n",
       "7           12679813                NaN  \n",
       "8           12536251                NaN  \n",
       "9           11880620          PMC122403  \n",
       "10          11087676                NaN  \n",
       "11          12627378                NaN  \n",
       "12          10328771                NaN  \n",
       "13           9776767          PMC147919  \n",
       "14          11591650          PMC311161  \n",
       "15          12679813                NaN  \n",
       "16          14558660                NaN  \n",
       "17          11880620          PMC122403  \n",
       "18          10777659                NaN  \n",
       "19          10328771                NaN  \n",
       "20          12679813                NaN  \n",
       "21          11087676                NaN  \n",
       "22          10777659                NaN  \n",
       "23          11591650          PMC311161  \n",
       "24           9776767          PMC147919  \n",
       "25          11880620          PMC122403  \n",
       "26          14558660                NaN  \n",
       "27          12627378                NaN  \n",
       "28           9776767          PMC147919  \n",
       "29          11087676                NaN  \n",
       "30          10328771                NaN  \n",
       "31          11880620          PMC122403  \n",
       "32          11591650          PMC311161  \n",
       "33          14558660                NaN  \n",
       "34          24551036         PMC3925090  \n",
       "35          22739990                NaN  \n",
       "36          12679813                NaN  \n",
       "37          12538238                NaN  \n",
       "38          10777659                NaN  \n",
       "39           2515992                NaN  \n",
       "40          11075367                NaN  \n",
       "41          10328771                NaN  \n",
       "42          12679813                NaN  \n",
       "43          11087676                NaN  \n",
       "44          10777659                NaN  \n",
       "45          11591650          PMC311161  \n",
       "46           9776767          PMC147919  \n",
       "47          11880620          PMC122403  \n",
       "48          14558660                NaN  \n",
       "49          12627378                NaN  "
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search patents where publications.id = \"pub.1009669527\" return patents[id+unnest(publications)] limit 5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "### Clinical Trials"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 11 (total clinical_trials= 120317)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publications.id</th>\n",
       "      <th>publications.doi</th>\n",
       "      <th>publications.pmid</th>\n",
       "      <th>publications.pmcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>pub.1060172832</td>\n",
       "      <td>10.1097/00003246-199804000-00015</td>\n",
       "      <td>9559604</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>pub.1034540720</td>\n",
       "      <td>10.1097/pcc.0b013e31818c8328</td>\n",
       "      <td>18838937</td>\n",
       "      <td>PMC2775493</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT02318303</td>\n",
       "      <td>pub.1122595654</td>\n",
       "      <td>10.1016/j.anai.2019.11.007</td>\n",
       "      <td>31734334</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>pub.1078752671</td>\n",
       "      <td>NaN</td>\n",
       "      <td>23823823</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>pub.1029970033</td>\n",
       "      <td>10.1111/j.1600-6143.2006.01331.x</td>\n",
       "      <td>16686775</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>NCT02318316</td>\n",
       "      <td>pub.1020641828</td>\n",
       "      <td>10.1183/09031936.05.00029705</td>\n",
       "      <td>16135737</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>NCT02318329</td>\n",
       "      <td>pub.1114347220</td>\n",
       "      <td>10.2217/fon-2019-0141</td>\n",
       "      <td>31094225</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>NCT02318342</td>\n",
       "      <td>pub.1041491024</td>\n",
       "      <td>10.1093/ehjci/jew032</td>\n",
       "      <td>27002141</td>\n",
       "      <td>PMC5066339</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>NCT02318342</td>\n",
       "      <td>pub.1012409535</td>\n",
       "      <td>10.1056/nejmoa1509233</td>\n",
       "      <td>26436963</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>NCT02318342</td>\n",
       "      <td>pub.1084043598</td>\n",
       "      <td>10.1016/s0140-6736(17)30757-2</td>\n",
       "      <td>28330690</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>NCT02318342</td>\n",
       "      <td>pub.1125683923</td>\n",
       "      <td>10.1016/j.jcin.2020.01.216</td>\n",
       "      <td>32192689</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             id publications.id                  publications.doi  \\\n",
       "0   NCT02318290  pub.1060172832  10.1097/00003246-199804000-00015   \n",
       "1   NCT02318290  pub.1034540720      10.1097/pcc.0b013e31818c8328   \n",
       "2   NCT02318303  pub.1122595654        10.1016/j.anai.2019.11.007   \n",
       "3   NCT02318316  pub.1078752671                               NaN   \n",
       "4   NCT02318316  pub.1029970033  10.1111/j.1600-6143.2006.01331.x   \n",
       "5   NCT02318316  pub.1020641828      10.1183/09031936.05.00029705   \n",
       "6   NCT02318329  pub.1114347220             10.2217/fon-2019-0141   \n",
       "7   NCT02318342  pub.1041491024              10.1093/ehjci/jew032   \n",
       "8   NCT02318342  pub.1012409535             10.1056/nejmoa1509233   \n",
       "9   NCT02318342  pub.1084043598     10.1016/s0140-6736(17)30757-2   \n",
       "10  NCT02318342  pub.1125683923        10.1016/j.jcin.2020.01.216   \n",
       "\n",
       "   publications.pmid publications.pmcid  \n",
       "0            9559604                NaN  \n",
       "1           18838937         PMC2775493  \n",
       "2           31734334                NaN  \n",
       "3           23823823                NaN  \n",
       "4           16686775                NaN  \n",
       "5           16135737                NaN  \n",
       "6           31094225                NaN  \n",
       "7           27002141         PMC5066339  \n",
       "8           26436963                NaN  \n",
       "9           28330690                NaN  \n",
       "10          32192689                NaN  "
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search clinical_trials where publications is not empty return clinical_trials[id+unnest(publications)] limit 5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 17 (total clinical_trials= 4)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publications.id</th>\n",
       "      <th>publications.doi</th>\n",
       "      <th>publications.pmid</th>\n",
       "      <th>publications.pmcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>pub.1060172832</td>\n",
       "      <td>10.1097/00003246-199804000-00015</td>\n",
       "      <td>9559604</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NCT02318290</td>\n",
       "      <td>pub.1034540720</td>\n",
       "      <td>10.1097/pcc.0b013e31818c8328</td>\n",
       "      <td>18838937</td>\n",
       "      <td>PMC2775493</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NCT03435614</td>\n",
       "      <td>pub.1060172832</td>\n",
       "      <td>10.1097/00003246-199804000-00015</td>\n",
       "      <td>9559604</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NCT03435614</td>\n",
       "      <td>pub.1091425047</td>\n",
       "      <td>10.1186/s13613-017-0310-5</td>\n",
       "      <td>28866754</td>\n",
       "      <td>PMC5581799</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NCT03435614</td>\n",
       "      <td>pub.1091145460</td>\n",
       "      <td>10.1177/1060028017724538</td>\n",
       "      <td>28793780</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>NCT03374722</td>\n",
       "      <td>pub.1060172832</td>\n",
       "      <td>10.1097/00003246-199804000-00015</td>\n",
       "      <td>9559604</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>NCT03374722</td>\n",
       "      <td>pub.1074627525</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10776874</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>NCT03374722</td>\n",
       "      <td>pub.1091425047</td>\n",
       "      <td>10.1186/s13613-017-0310-5</td>\n",
       "      <td>28866754</td>\n",
       "      <td>PMC5581799</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>NCT03374722</td>\n",
       "      <td>pub.1030841256</td>\n",
       "      <td>10.1007/s00134-005-2579-3</td>\n",
       "      <td>15714323</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>NCT04422808</td>\n",
       "      <td>pub.1074627525</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10776874</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>NCT04422808</td>\n",
       "      <td>pub.1100171233</td>\n",
       "      <td>10.4037/ajcc2018959</td>\n",
       "      <td>29292273</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>NCT04422808</td>\n",
       "      <td>pub.1035391523</td>\n",
       "      <td>10.1001/jama.2014.18399</td>\n",
       "      <td>25602358</td>\n",
       "      <td>PMC4955566</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>NCT04422808</td>\n",
       "      <td>pub.1091145460</td>\n",
       "      <td>10.1177/1060028017724538</td>\n",
       "      <td>28793780</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>NCT04422808</td>\n",
       "      <td>pub.1060172832</td>\n",
       "      <td>10.1097/00003246-199804000-00015</td>\n",
       "      <td>9559604</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>NCT04422808</td>\n",
       "      <td>pub.1060173286</td>\n",
       "      <td>10.1097/00003246-199901000-00052</td>\n",
       "      <td>9934916</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>NCT04422808</td>\n",
       "      <td>pub.1091425047</td>\n",
       "      <td>10.1186/s13613-017-0310-5</td>\n",
       "      <td>28866754</td>\n",
       "      <td>PMC5581799</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>NCT04422808</td>\n",
       "      <td>pub.1110762074</td>\n",
       "      <td>10.1111/jcpt.12787</td>\n",
       "      <td>30569508</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             id publications.id                  publications.doi  \\\n",
       "0   NCT02318290  pub.1060172832  10.1097/00003246-199804000-00015   \n",
       "1   NCT02318290  pub.1034540720      10.1097/pcc.0b013e31818c8328   \n",
       "2   NCT03435614  pub.1060172832  10.1097/00003246-199804000-00015   \n",
       "3   NCT03435614  pub.1091425047         10.1186/s13613-017-0310-5   \n",
       "4   NCT03435614  pub.1091145460          10.1177/1060028017724538   \n",
       "5   NCT03374722  pub.1060172832  10.1097/00003246-199804000-00015   \n",
       "6   NCT03374722  pub.1074627525                               NaN   \n",
       "7   NCT03374722  pub.1091425047         10.1186/s13613-017-0310-5   \n",
       "8   NCT03374722  pub.1030841256         10.1007/s00134-005-2579-3   \n",
       "9   NCT04422808  pub.1074627525                               NaN   \n",
       "10  NCT04422808  pub.1100171233               10.4037/ajcc2018959   \n",
       "11  NCT04422808  pub.1035391523           10.1001/jama.2014.18399   \n",
       "12  NCT04422808  pub.1091145460          10.1177/1060028017724538   \n",
       "13  NCT04422808  pub.1060172832  10.1097/00003246-199804000-00015   \n",
       "14  NCT04422808  pub.1060173286  10.1097/00003246-199901000-00052   \n",
       "15  NCT04422808  pub.1091425047         10.1186/s13613-017-0310-5   \n",
       "16  NCT04422808  pub.1110762074                10.1111/jcpt.12787   \n",
       "\n",
       "   publications.pmid publications.pmcid  \n",
       "0            9559604                NaN  \n",
       "1           18838937         PMC2775493  \n",
       "2            9559604                NaN  \n",
       "3           28866754         PMC5581799  \n",
       "4           28793780                NaN  \n",
       "5            9559604                NaN  \n",
       "6           10776874                NaN  \n",
       "7           28866754         PMC5581799  \n",
       "8           15714323                NaN  \n",
       "9           10776874                NaN  \n",
       "10          29292273                NaN  \n",
       "11          25602358         PMC4955566  \n",
       "12          28793780                NaN  \n",
       "13           9559604                NaN  \n",
       "14           9934916                NaN  \n",
       "15          28866754         PMC5581799  \n",
       "16          30569508                NaN  "
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search clinical_trials where publications.id=\"pub.1060172832\" return clinical_trials[id+unnest(publications)] limit 5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "### Policy Documents"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 43 (total policy_documents= 98668)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publications.id</th>\n",
       "      <th>publications.doi</th>\n",
       "      <th>publications.pmid</th>\n",
       "      <th>publications.pmcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643736</td>\n",
       "      <td>pub.1059967437</td>\n",
       "      <td>10.1093/oxrep/grj011</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1011501074</td>\n",
       "      <td>10.1371/journal.pmed.1001396</td>\n",
       "      <td>23468598</td>\n",
       "      <td>PMC3582608</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1039801886</td>\n",
       "      <td>10.1016/j.vaccine.2014.01.053</td>\n",
       "      <td>24480024</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1068078884</td>\n",
       "      <td>10.1586/14787210.2013.824717</td>\n",
       "      <td>24124797</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1047965704</td>\n",
       "      <td>10.1097/olq.0b013e3182631c9f</td>\n",
       "      <td>23001269</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1052332326</td>\n",
       "      <td>10.1016/j.vaccine.2013.07.087</td>\n",
       "      <td>24581979</td>\n",
       "      <td>PMC6794147</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>policy.64374</td>\n",
       "      <td>pub.1050222392</td>\n",
       "      <td>10.1097/olq.0000000000000062</td>\n",
       "      <td>24326577</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1012595932</td>\n",
       "      <td>10.1161/01.cir.97.5.437</td>\n",
       "      <td>9490237</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1041131412</td>\n",
       "      <td>10.1056/nejmoa055227</td>\n",
       "      <td>16531614</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1024094647</td>\n",
       "      <td>10.1093/jnci/djp019</td>\n",
       "      <td>19276452</td>\n",
       "      <td>PMC2657096</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1064069744</td>\n",
       "      <td>10.1177/174182679800500404</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1026322923</td>\n",
       "      <td>10.1056/nejmoa060900</td>\n",
       "      <td>16531613</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1054158801</td>\n",
       "      <td>10.1001/jama.274.13.1049</td>\n",
       "      <td>7563456</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1015060066</td>\n",
       "      <td>10.1097/meg.0b013e328306ccdb</td>\n",
       "      <td>19190501</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1044787811</td>\n",
       "      <td>10.1093/jnci/djk006</td>\n",
       "      <td>17202114</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1041011492</td>\n",
       "      <td>10.1161/circulationaha.105.570846</td>\n",
       "      <td>16534029</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1046334544</td>\n",
       "      <td>10.1111/j.1747-4949.2007.00111.x</td>\n",
       "      <td>18705976</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1038199540</td>\n",
       "      <td>10.1016/s0140-6736(07)60854-x</td>\n",
       "      <td>17544768</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1047239169</td>\n",
       "      <td>10.1001/jama.300.7.795</td>\n",
       "      <td>18714059</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1009008325</td>\n",
       "      <td>10.1001/jama.298.10.1163</td>\n",
       "      <td>17848650</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1070163897</td>\n",
       "      <td>10.2307/3001616</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1076963202</td>\n",
       "      <td>10.1093/ajcn/80.5.1123</td>\n",
       "      <td>15531657</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1023282848</td>\n",
       "      <td>10.1001/jama.285.23.2981</td>\n",
       "      <td>11410096</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1077123930</td>\n",
       "      <td>10.1093/ajcn/82.4.806</td>\n",
       "      <td>16210710</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1025640235</td>\n",
       "      <td>10.1016/j.ahj.2005.04.025</td>\n",
       "      <td>16442889</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1019933505</td>\n",
       "      <td>10.1053/j.gastro.2007.10.014</td>\n",
       "      <td>18022173</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1052394891</td>\n",
       "      <td>10.1001/jama.291.5.565</td>\n",
       "      <td>14762035</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1034834983</td>\n",
       "      <td>10.1001/jama.279.5.359</td>\n",
       "      <td>9459468</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1010430932</td>\n",
       "      <td>10.1056/nejm199104253241701</td>\n",
       "      <td>2011158</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1036328128</td>\n",
       "      <td>10.1016/s0140-6736(12)62001-7</td>\n",
       "      <td>23352552</td>\n",
       "      <td>PMC3836669</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1025240701</td>\n",
       "      <td>10.1001/jama.299.17.2027</td>\n",
       "      <td>18460663</td>\n",
       "      <td>PMC2684623</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1048999034</td>\n",
       "      <td>10.1016/j.ahj.2007.06.034</td>\n",
       "      <td>17967584</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1038194636</td>\n",
       "      <td>10.1053/j.ajkd.2008.08.010</td>\n",
       "      <td>19022547</td>\n",
       "      <td>PMC2682551</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1022274202</td>\n",
       "      <td>10.1001/jama.297.21.2351</td>\n",
       "      <td>17551129</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>policy.643787</td>\n",
       "      <td>pub.1006442615</td>\n",
       "      <td>10.1161/strokeaha.108.529503</td>\n",
       "      <td>19228852</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1038547748</td>\n",
       "      <td>10.1353/tech.0.0169</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1039268894</td>\n",
       "      <td>10.1038/458149a</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1044215330</td>\n",
       "      <td>10.1038/455288b</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1043813564</td>\n",
       "      <td>10.1080/07341510701810955</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1026566193</td>\n",
       "      <td>10.1002/chem.200800718</td>\n",
       "      <td>18671308</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>policy.643844</td>\n",
       "      <td>pub.1050606261</td>\n",
       "      <td>10.1038/nchembio.150</td>\n",
       "      <td>19234453</td>\n",
       "      <td>PMC2659327</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>policy.643844</td>\n",
       "      <td>pub.1005580423</td>\n",
       "      <td>10.1111/j.1365-2583.2007.00789.x</td>\n",
       "      <td>18353104</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>policy.643844</td>\n",
       "      <td>pub.1002498063</td>\n",
       "      <td>10.1056/nejmoa0804953</td>\n",
       "      <td>19109573</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id publications.id                   publications.doi  \\\n",
       "0   policy.643736  pub.1059967437               10.1093/oxrep/grj011   \n",
       "1    policy.64374  pub.1011501074       10.1371/journal.pmed.1001396   \n",
       "2    policy.64374  pub.1039801886      10.1016/j.vaccine.2014.01.053   \n",
       "3    policy.64374  pub.1068078884       10.1586/14787210.2013.824717   \n",
       "4    policy.64374  pub.1047965704       10.1097/olq.0b013e3182631c9f   \n",
       "5    policy.64374  pub.1052332326      10.1016/j.vaccine.2013.07.087   \n",
       "6    policy.64374  pub.1050222392       10.1097/olq.0000000000000062   \n",
       "7   policy.643787  pub.1012595932            10.1161/01.cir.97.5.437   \n",
       "8   policy.643787  pub.1041131412               10.1056/nejmoa055227   \n",
       "9   policy.643787  pub.1024094647                10.1093/jnci/djp019   \n",
       "10  policy.643787  pub.1064069744         10.1177/174182679800500404   \n",
       "11  policy.643787  pub.1026322923               10.1056/nejmoa060900   \n",
       "12  policy.643787  pub.1054158801           10.1001/jama.274.13.1049   \n",
       "13  policy.643787  pub.1015060066       10.1097/meg.0b013e328306ccdb   \n",
       "14  policy.643787  pub.1044787811                10.1093/jnci/djk006   \n",
       "15  policy.643787  pub.1041011492  10.1161/circulationaha.105.570846   \n",
       "16  policy.643787  pub.1046334544   10.1111/j.1747-4949.2007.00111.x   \n",
       "17  policy.643787  pub.1038199540      10.1016/s0140-6736(07)60854-x   \n",
       "18  policy.643787  pub.1047239169             10.1001/jama.300.7.795   \n",
       "19  policy.643787  pub.1009008325           10.1001/jama.298.10.1163   \n",
       "20  policy.643787  pub.1070163897                    10.2307/3001616   \n",
       "21  policy.643787  pub.1076963202             10.1093/ajcn/80.5.1123   \n",
       "22  policy.643787  pub.1023282848           10.1001/jama.285.23.2981   \n",
       "23  policy.643787  pub.1077123930              10.1093/ajcn/82.4.806   \n",
       "24  policy.643787  pub.1025640235          10.1016/j.ahj.2005.04.025   \n",
       "25  policy.643787  pub.1019933505       10.1053/j.gastro.2007.10.014   \n",
       "26  policy.643787  pub.1052394891             10.1001/jama.291.5.565   \n",
       "27  policy.643787  pub.1034834983             10.1001/jama.279.5.359   \n",
       "28  policy.643787  pub.1010430932        10.1056/nejm199104253241701   \n",
       "29  policy.643787  pub.1036328128      10.1016/s0140-6736(12)62001-7   \n",
       "30  policy.643787  pub.1025240701           10.1001/jama.299.17.2027   \n",
       "31  policy.643787  pub.1048999034          10.1016/j.ahj.2007.06.034   \n",
       "32  policy.643787  pub.1038194636         10.1053/j.ajkd.2008.08.010   \n",
       "33  policy.643787  pub.1022274202           10.1001/jama.297.21.2351   \n",
       "34  policy.643787  pub.1006442615       10.1161/strokeaha.108.529503   \n",
       "35  policy.643831  pub.1038547748                10.1353/tech.0.0169   \n",
       "36  policy.643831  pub.1039268894                    10.1038/458149a   \n",
       "37  policy.643831  pub.1044215330                    10.1038/455288b   \n",
       "38  policy.643831  pub.1043813564          10.1080/07341510701810955   \n",
       "39  policy.643831  pub.1026566193             10.1002/chem.200800718   \n",
       "40  policy.643844  pub.1050606261               10.1038/nchembio.150   \n",
       "41  policy.643844  pub.1005580423   10.1111/j.1365-2583.2007.00789.x   \n",
       "42  policy.643844  pub.1002498063              10.1056/nejmoa0804953   \n",
       "\n",
       "   publications.pmid publications.pmcid  \n",
       "0                NaN                NaN  \n",
       "1           23468598         PMC3582608  \n",
       "2           24480024                NaN  \n",
       "3           24124797                NaN  \n",
       "4           23001269                NaN  \n",
       "5           24581979         PMC6794147  \n",
       "6           24326577                NaN  \n",
       "7            9490237                NaN  \n",
       "8           16531614                NaN  \n",
       "9           19276452         PMC2657096  \n",
       "10               NaN                NaN  \n",
       "11          16531613                NaN  \n",
       "12           7563456                NaN  \n",
       "13          19190501                NaN  \n",
       "14          17202114                NaN  \n",
       "15          16534029                NaN  \n",
       "16          18705976                NaN  \n",
       "17          17544768                NaN  \n",
       "18          18714059                NaN  \n",
       "19          17848650                NaN  \n",
       "20               NaN                NaN  \n",
       "21          15531657                NaN  \n",
       "22          11410096                NaN  \n",
       "23          16210710                NaN  \n",
       "24          16442889                NaN  \n",
       "25          18022173                NaN  \n",
       "26          14762035                NaN  \n",
       "27           9459468                NaN  \n",
       "28           2011158                NaN  \n",
       "29          23352552         PMC3836669  \n",
       "30          18460663         PMC2684623  \n",
       "31          17967584                NaN  \n",
       "32          19022547         PMC2682551  \n",
       "33          17551129                NaN  \n",
       "34          19228852                NaN  \n",
       "35               NaN                NaN  \n",
       "36               NaN                NaN  \n",
       "37               NaN                NaN  \n",
       "38               NaN                NaN  \n",
       "39          18671308                NaN  \n",
       "40          19234453         PMC2659327  \n",
       "41          18353104                NaN  \n",
       "42          19109573                NaN  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search policy_documents where publications is not empty return policy_documents[id+unnest(publications)] limit 5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 5 (total policy_documents= 1)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>publications.id</th>\n",
       "      <th>publications.doi</th>\n",
       "      <th>publications.pmid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1038547748</td>\n",
       "      <td>10.1353/tech.0.0169</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1039268894</td>\n",
       "      <td>10.1038/458149a</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1044215330</td>\n",
       "      <td>10.1038/455288b</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1043813564</td>\n",
       "      <td>10.1080/07341510701810955</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>policy.643831</td>\n",
       "      <td>pub.1026566193</td>\n",
       "      <td>10.1002/chem.200800718</td>\n",
       "      <td>18671308</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              id publications.id           publications.doi publications.pmid\n",
       "0  policy.643831  pub.1038547748        10.1353/tech.0.0169               NaN\n",
       "1  policy.643831  pub.1039268894            10.1038/458149a               NaN\n",
       "2  policy.643831  pub.1044215330            10.1038/455288b               NaN\n",
       "3  policy.643831  pub.1043813564  10.1080/07341510701810955               NaN\n",
       "4  policy.643831  pub.1026566193     10.1002/chem.200800718          18671308"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search policy_documents where publications.id = \"pub.1026566193\" return policy_documents[id+unnest(publications)] limit 5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "### Datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Datasets: 5 (total = 1095337)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>associated_publication.id</th>\n",
       "      <th>associated_publication.doi</th>\n",
       "      <th>associated_publication.pmcid</th>\n",
       "      <th>associated_publication.pmid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354641</td>\n",
       "      <td>pub.1006463932</td>\n",
       "      <td>10.1371/journal.pntd.0001474</td>\n",
       "      <td>PMC3279339</td>\n",
       "      <td>22348155</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354605</td>\n",
       "      <td>pub.1006463932</td>\n",
       "      <td>10.1371/journal.pntd.0001474</td>\n",
       "      <td>PMC3279339</td>\n",
       "      <td>22348155</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>354569</td>\n",
       "      <td>pub.1006463932</td>\n",
       "      <td>10.1371/journal.pntd.0001474</td>\n",
       "      <td>PMC3279339</td>\n",
       "      <td>22348155</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>354373</td>\n",
       "      <td>pub.1030656761</td>\n",
       "      <td>10.1371/journal.pone.0030914</td>\n",
       "      <td>PMC3279350</td>\n",
       "      <td>22348030</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>354340</td>\n",
       "      <td>pub.1043185463</td>\n",
       "      <td>10.1371/journal.pone.0030486</td>\n",
       "      <td>PMC3279358</td>\n",
       "      <td>22348010</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id associated_publication.id    associated_publication.doi  \\\n",
       "0  354641            pub.1006463932  10.1371/journal.pntd.0001474   \n",
       "1  354605            pub.1006463932  10.1371/journal.pntd.0001474   \n",
       "2  354569            pub.1006463932  10.1371/journal.pntd.0001474   \n",
       "3  354373            pub.1030656761  10.1371/journal.pone.0030914   \n",
       "4  354340            pub.1043185463  10.1371/journal.pone.0030486   \n",
       "\n",
       "  associated_publication.pmcid associated_publication.pmid  \n",
       "0                   PMC3279339                    22348155  \n",
       "1                   PMC3279339                    22348155  \n",
       "2                   PMC3279339                    22348155  \n",
       "3                   PMC3279350                    22348030  \n",
       "4                   PMC3279358                    22348010  "
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search datasets where associated_publication is not empty return datasets[id+associated_publication] limit 5"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Datasets: 3 (total = 3)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>associated_publication.id</th>\n",
       "      <th>associated_publication.doi</th>\n",
       "      <th>associated_publication.pmcid</th>\n",
       "      <th>associated_publication.pmid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>354373</td>\n",
       "      <td>pub.1030656761</td>\n",
       "      <td>10.1371/journal.pone.0030914</td>\n",
       "      <td>PMC3279350</td>\n",
       "      <td>22348030</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>354338</td>\n",
       "      <td>pub.1030656761</td>\n",
       "      <td>10.1371/journal.pone.0030914</td>\n",
       "      <td>PMC3279350</td>\n",
       "      <td>22348030</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>128758</td>\n",
       "      <td>pub.1030656761</td>\n",
       "      <td>10.1371/journal.pone.0030914</td>\n",
       "      <td>PMC3279350</td>\n",
       "      <td>22348030</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id associated_publication.id    associated_publication.doi  \\\n",
       "0  354373            pub.1030656761  10.1371/journal.pone.0030914   \n",
       "1  354338            pub.1030656761  10.1371/journal.pone.0030914   \n",
       "2  128758            pub.1030656761  10.1371/journal.pone.0030914   \n",
       "\n",
       "  associated_publication.pmcid associated_publication.pmid  \n",
       "0                   PMC3279350                    22348030  \n",
       "1                   PMC3279350                    22348030  \n",
       "2                   PMC3279350                    22348030  "
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search datasets where associated_publication.id = \"pub.1030656761\" return datasets[id+associated_publication] limit 5"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "### Publications"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned records after unnesting: 1521 (total publications= 47)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>referenced_pubs.id</th>\n",
       "      <th>referenced_pubs.doi</th>\n",
       "      <th>referenced_pubs.pmid</th>\n",
       "      <th>referenced_pubs.pmcid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1117179638</td>\n",
       "      <td>pub.1018649176</td>\n",
       "      <td>10.1016/j.bpj.2011.04.041</td>\n",
       "      <td>21641310</td>\n",
       "      <td>PMC3117184</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1117179638</td>\n",
       "      <td>pub.1016092297</td>\n",
       "      <td>10.1016/j.procbio.2008.08.012</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1117179638</td>\n",
       "      <td>pub.1005450273</td>\n",
       "      <td>10.1111/j.1749-6632.2012.06697.x</td>\n",
       "      <td>23045967</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1117179638</td>\n",
       "      <td>pub.1028850603</td>\n",
       "      <td>10.1038/415389a</td>\n",
       "      <td>11807545</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1117179638</td>\n",
       "      <td>pub.1002509623</td>\n",
       "      <td>10.1128/aac.50.4.1251-1256.2006</td>\n",
       "      <td>16569836</td>\n",
       "      <td>PMC1426946</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1516</th>\n",
       "      <td>pub.1043995944</td>\n",
       "      <td>pub.1069164948</td>\n",
       "      <td>10.2174/1381612033454595</td>\n",
       "      <td>12871062</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1517</th>\n",
       "      <td>pub.1043995944</td>\n",
       "      <td>pub.1025205043</td>\n",
       "      <td>10.1002/prot.10266</td>\n",
       "      <td>12660987</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1518</th>\n",
       "      <td>pub.1043995944</td>\n",
       "      <td>pub.1021292465</td>\n",
       "      <td>10.1002/(sici)1097-0134(1997)1+&lt;215::aid-prot2...</td>\n",
       "      <td>9485515</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1519</th>\n",
       "      <td>pub.1043995944</td>\n",
       "      <td>pub.1055948217</td>\n",
       "      <td>10.1021/jm030605g</td>\n",
       "      <td>15369385</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1520</th>\n",
       "      <td>pub.1043995944</td>\n",
       "      <td>pub.1055948478</td>\n",
       "      <td>10.1021/jm0311487</td>\n",
       "      <td>15481976</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1521 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  id referenced_pubs.id  \\\n",
       "0     pub.1117179638     pub.1018649176   \n",
       "1     pub.1117179638     pub.1016092297   \n",
       "2     pub.1117179638     pub.1005450273   \n",
       "3     pub.1117179638     pub.1028850603   \n",
       "4     pub.1117179638     pub.1002509623   \n",
       "...              ...                ...   \n",
       "1516  pub.1043995944     pub.1069164948   \n",
       "1517  pub.1043995944     pub.1025205043   \n",
       "1518  pub.1043995944     pub.1021292465   \n",
       "1519  pub.1043995944     pub.1055948217   \n",
       "1520  pub.1043995944     pub.1055948478   \n",
       "\n",
       "                                    referenced_pubs.doi referenced_pubs.pmid  \\\n",
       "0                             10.1016/j.bpj.2011.04.041             21641310   \n",
       "1                         10.1016/j.procbio.2008.08.012                  NaN   \n",
       "2                      10.1111/j.1749-6632.2012.06697.x             23045967   \n",
       "3                                       10.1038/415389a             11807545   \n",
       "4                       10.1128/aac.50.4.1251-1256.2006             16569836   \n",
       "...                                                 ...                  ...   \n",
       "1516                           10.2174/1381612033454595             12871062   \n",
       "1517                                 10.1002/prot.10266             12660987   \n",
       "1518  10.1002/(sici)1097-0134(1997)1+<215::aid-prot2...              9485515   \n",
       "1519                                  10.1021/jm030605g             15369385   \n",
       "1520                                  10.1021/jm0311487             15481976   \n",
       "\n",
       "     referenced_pubs.pmcid  \n",
       "0               PMC3117184  \n",
       "1                      NaN  \n",
       "2                      NaN  \n",
       "3                      NaN  \n",
       "4               PMC1426946  \n",
       "...                    ...  \n",
       "1516                   NaN  \n",
       "1517                   NaN  \n",
       "1518                   NaN  \n",
       "1519                   NaN  \n",
       "1520                   NaN  \n",
       "\n",
       "[1521 rows x 5 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search publications where referenced_pubs.id = \"pub.1009669527\" return publications[id+unnest(referenced_pubs)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Publications: 20 (total = 47)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>reference_ids</th>\n",
       "      <th>id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>[pub.1018649176, pub.1016092297, pub.100545027...</td>\n",
       "      <td>pub.1117179638</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>[pub.1046633756, pub.1038403355, pub.100675499...</td>\n",
       "      <td>pub.1104396394</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>[pub.1050798656, pub.1076629359, pub.110707151...</td>\n",
       "      <td>pub.1038459728</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>[pub.1078392838, pub.1019357889, pub.101236136...</td>\n",
       "      <td>pub.1038347311</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>[pub.1028899848, pub.1019183774, pub.101055930...</td>\n",
       "      <td>pub.1071873023</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>[pub.1055924690, pub.1032390305, pub.101872728...</td>\n",
       "      <td>pub.1042934850</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>[pub.1045564604, pub.1048354066, pub.101670489...</td>\n",
       "      <td>pub.1042159830</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>[pub.1059932028, pub.1010168713, pub.105519451...</td>\n",
       "      <td>pub.1051858162</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>[pub.1008187659, pub.1044487004, pub.100293309...</td>\n",
       "      <td>pub.1032049163</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>[pub.1005099978, pub.1046685846, pub.105097551...</td>\n",
       "      <td>pub.1050764619</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>[pub.1053479690, pub.1011300232, pub.103304579...</td>\n",
       "      <td>pub.1002574183</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>[pub.1011497032, pub.1001150823, pub.102219449...</td>\n",
       "      <td>pub.1048472748</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>[pub.1033053605, pub.1053203562, pub.102273632...</td>\n",
       "      <td>pub.1063973657</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>[pub.1056291766, pub.1033090823, pub.101759929...</td>\n",
       "      <td>pub.1035135967</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>[pub.1070468463, pub.1003899012, pub.101973765...</td>\n",
       "      <td>pub.1002818671</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>[pub.1051718868, pub.1047246077, pub.101205777...</td>\n",
       "      <td>pub.1053162347</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>[pub.1060100448, pub.1068410295, pub.103414583...</td>\n",
       "      <td>pub.1003324801</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>[pub.1008520375, pub.1059980495, pub.100457088...</td>\n",
       "      <td>pub.1035383471</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>[pub.1077182691, pub.1032990478, pub.100661879...</td>\n",
       "      <td>pub.1009519039</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>[pub.1036220074, pub.1050947955, pub.103510949...</td>\n",
       "      <td>pub.1043995944</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                        reference_ids              id\n",
       "0   [pub.1018649176, pub.1016092297, pub.100545027...  pub.1117179638\n",
       "1   [pub.1046633756, pub.1038403355, pub.100675499...  pub.1104396394\n",
       "2   [pub.1050798656, pub.1076629359, pub.110707151...  pub.1038459728\n",
       "3   [pub.1078392838, pub.1019357889, pub.101236136...  pub.1038347311\n",
       "4   [pub.1028899848, pub.1019183774, pub.101055930...  pub.1071873023\n",
       "5   [pub.1055924690, pub.1032390305, pub.101872728...  pub.1042934850\n",
       "6   [pub.1045564604, pub.1048354066, pub.101670489...  pub.1042159830\n",
       "7   [pub.1059932028, pub.1010168713, pub.105519451...  pub.1051858162\n",
       "8   [pub.1008187659, pub.1044487004, pub.100293309...  pub.1032049163\n",
       "9   [pub.1005099978, pub.1046685846, pub.105097551...  pub.1050764619\n",
       "10  [pub.1053479690, pub.1011300232, pub.103304579...  pub.1002574183\n",
       "11  [pub.1011497032, pub.1001150823, pub.102219449...  pub.1048472748\n",
       "12  [pub.1033053605, pub.1053203562, pub.102273632...  pub.1063973657\n",
       "13  [pub.1056291766, pub.1033090823, pub.101759929...  pub.1035135967\n",
       "14  [pub.1070468463, pub.1003899012, pub.101973765...  pub.1002818671\n",
       "15  [pub.1051718868, pub.1047246077, pub.101205777...  pub.1053162347\n",
       "16  [pub.1060100448, pub.1068410295, pub.103414583...  pub.1003324801\n",
       "17  [pub.1008520375, pub.1059980495, pub.100457088...  pub.1035383471\n",
       "18  [pub.1077182691, pub.1032990478, pub.100661879...  pub.1009519039\n",
       "19  [pub.1036220074, pub.1050947955, pub.103510949...  pub.1043995944"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search publications where reference_ids = \"pub.1009669527\" return publications[id+reference_ids]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "Collapsed": "false"
   },
   "source": [
    "## DSL-476 Support multi-index full-text search\n",
    "\n",
    "https://uberresearch.atlassian.net/browse/DSL-476"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Publications: 9 (total = 9)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>volume</th>\n",
       "      <th>title</th>\n",
       "      <th>pages</th>\n",
       "      <th>author_affiliations</th>\n",
       "      <th>type</th>\n",
       "      <th>issue</th>\n",
       "      <th>year</th>\n",
       "      <th>journal.id</th>\n",
       "      <th>journal.title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1125708976</td>\n",
       "      <td>5</td>\n",
       "      <td>Efficient Photoreduction of Hexavalent Chromiu...</td>\n",
       "      <td>6414-6422</td>\n",
       "      <td>[[{'raw_affiliation': ['Multifunctional Materi...</td>\n",
       "      <td>article</td>\n",
       "      <td>12</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1157000</td>\n",
       "      <td>ACS Omega</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1120404163</td>\n",
       "      <td>11</td>\n",
       "      <td>Construction of Layered B3N3-Doped Graphene Sh...</td>\n",
       "      <td>33245-33253</td>\n",
       "      <td>[[{'raw_affiliation': ['Key Laboratory of Spec...</td>\n",
       "      <td>article</td>\n",
       "      <td>36</td>\n",
       "      <td>2019</td>\n",
       "      <td>jour.1041450</td>\n",
       "      <td>ACS Applied Materials &amp; Interfaces</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1100480107</td>\n",
       "      <td>29</td>\n",
       "      <td>Formation of snowflake-like CdS/reduced graphe...</td>\n",
       "      <td>5944-5953</td>\n",
       "      <td>[[{'raw_affiliation': ['Key Laboratory of Eco-...</td>\n",
       "      <td>article</td>\n",
       "      <td>7</td>\n",
       "      <td>2018</td>\n",
       "      <td>jour.1136825</td>\n",
       "      <td>Journal of Materials Science: Materials in Ele...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1104581633</td>\n",
       "      <td>1</td>\n",
       "      <td>Preparation and Photocatalytic Properties of A...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[[{'raw_affiliation': [], 'first_name': 'Huanl...</td>\n",
       "      <td>article</td>\n",
       "      <td>1</td>\n",
       "      <td>2018</td>\n",
       "      <td>jour.1337213</td>\n",
       "      <td>Journal of Analytical Chromatography and Spect...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1030236433</td>\n",
       "      <td>365</td>\n",
       "      <td>Integrating Graphene and C60 Into TiO2 Nanofib...</td>\n",
       "      <td>128-139</td>\n",
       "      <td>[[{'raw_affiliation': ['Department of Mechanic...</td>\n",
       "      <td>article</td>\n",
       "      <td>1</td>\n",
       "      <td>2016</td>\n",
       "      <td>jour.1358689</td>\n",
       "      <td>Macromolecular Symposia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>pub.1055120558</td>\n",
       "      <td>15</td>\n",
       "      <td>Clean graphene electrodes on organic thin-film...</td>\n",
       "      <td>2555-61</td>\n",
       "      <td>[[{'raw_affiliation': [], 'first_name': 'Jonat...</td>\n",
       "      <td>article</td>\n",
       "      <td>4</td>\n",
       "      <td>2015</td>\n",
       "      <td>jour.1028316</td>\n",
       "      <td>Nano Letters</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>pub.1002609244</td>\n",
       "      <td>5</td>\n",
       "      <td>Bubble template synthesis of CdLa 2 S 4 hollow...</td>\n",
       "      <td>90321-90334</td>\n",
       "      <td>[[{'raw_affiliation': ['Department of Advanced...</td>\n",
       "      <td>article</td>\n",
       "      <td>110</td>\n",
       "      <td>2015</td>\n",
       "      <td>jour.1046724</td>\n",
       "      <td>RSC Advances</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>pub.1032536325</td>\n",
       "      <td>22</td>\n",
       "      <td>Hydrogen evolution from water using semiconduc...</td>\n",
       "      <td>1539-1546</td>\n",
       "      <td>[[{'raw_affiliation': ['Key Laboratory of Phot...</td>\n",
       "      <td>article</td>\n",
       "      <td>4</td>\n",
       "      <td>2012</td>\n",
       "      <td>jour.1132648</td>\n",
       "      <td>Journal of Materials Chemistry</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>pub.1002389728</td>\n",
       "      <td>27</td>\n",
       "      <td>Highly Efficient Hydrogen Evolution Using TiO2...</td>\n",
       "      <td>570-576</td>\n",
       "      <td>[[{'raw_affiliation': ['Key Laboratory of Phot...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2012</td>\n",
       "      <td>jour.1044217</td>\n",
       "      <td>Procedia Engineering</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               id volume                                              title  \\\n",
       "0  pub.1125708976      5  Efficient Photoreduction of Hexavalent Chromiu...   \n",
       "1  pub.1120404163     11  Construction of Layered B3N3-Doped Graphene Sh...   \n",
       "2  pub.1100480107     29  Formation of snowflake-like CdS/reduced graphe...   \n",
       "3  pub.1104581633      1  Preparation and Photocatalytic Properties of A...   \n",
       "4  pub.1030236433    365  Integrating Graphene and C60 Into TiO2 Nanofib...   \n",
       "5  pub.1055120558     15  Clean graphene electrodes on organic thin-film...   \n",
       "6  pub.1002609244      5  Bubble template synthesis of CdLa 2 S 4 hollow...   \n",
       "7  pub.1032536325     22  Hydrogen evolution from water using semiconduc...   \n",
       "8  pub.1002389728     27  Highly Efficient Hydrogen Evolution Using TiO2...   \n",
       "\n",
       "         pages                                author_affiliations     type  \\\n",
       "0    6414-6422  [[{'raw_affiliation': ['Multifunctional Materi...  article   \n",
       "1  33245-33253  [[{'raw_affiliation': ['Key Laboratory of Spec...  article   \n",
       "2    5944-5953  [[{'raw_affiliation': ['Key Laboratory of Eco-...  article   \n",
       "3          NaN  [[{'raw_affiliation': [], 'first_name': 'Huanl...  article   \n",
       "4      128-139  [[{'raw_affiliation': ['Department of Mechanic...  article   \n",
       "5      2555-61  [[{'raw_affiliation': [], 'first_name': 'Jonat...  article   \n",
       "6  90321-90334  [[{'raw_affiliation': ['Department of Advanced...  article   \n",
       "7    1539-1546  [[{'raw_affiliation': ['Key Laboratory of Phot...  article   \n",
       "8      570-576  [[{'raw_affiliation': ['Key Laboratory of Phot...  article   \n",
       "\n",
       "  issue  year    journal.id                                      journal.title  \n",
       "0    12  2020  jour.1157000                                          ACS Omega  \n",
       "1    36  2019  jour.1041450                 ACS Applied Materials & Interfaces  \n",
       "2     7  2018  jour.1136825  Journal of Materials Science: Materials in Ele...  \n",
       "3     1  2018  jour.1337213  Journal of Analytical Chromatography and Spect...  \n",
       "4     1  2016  jour.1358689                            Macromolecular Symposia  \n",
       "5     4  2015  jour.1028316                                       Nano Letters  \n",
       "6   110  2015  jour.1046724                                       RSC Advances  \n",
       "7     4  2012  jour.1132648                     Journal of Materials Chemistry  \n",
       "8   NaN  2012  jour.1044217                               Procedia Engineering  "
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search publications in title_only for \"graphene AND catalyst\" \n",
    "    and in concepts for \"\\\"semiconductor materials\\\"\" \n",
    "return publications"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "Collapsed": "false"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Returned Publications: 20 (total = 1812)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>volume</th>\n",
       "      <th>title</th>\n",
       "      <th>pages</th>\n",
       "      <th>author_affiliations</th>\n",
       "      <th>type</th>\n",
       "      <th>issue</th>\n",
       "      <th>year</th>\n",
       "      <th>journal.id</th>\n",
       "      <th>journal.title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>pub.1129300233</td>\n",
       "      <td>17</td>\n",
       "      <td>Induction of ferroptosis in response to graphe...</td>\n",
       "      <td>30</td>\n",
       "      <td>[[{'raw_affiliation': ['Key Laboratory of Envi...</td>\n",
       "      <td>article</td>\n",
       "      <td>1</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1034805</td>\n",
       "      <td>Particle and Fibre Toxicology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>pub.1129376257</td>\n",
       "      <td>164</td>\n",
       "      <td>Highly efficient removal of As(III) from aqueo...</td>\n",
       "      <td>13-26</td>\n",
       "      <td>[[{'raw_affiliation': ['College of Environment...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1090368</td>\n",
       "      <td>International Journal of Biological Macromolec...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>pub.1128678090</td>\n",
       "      <td>401</td>\n",
       "      <td>Fabrication of Core-shell Nanohybrid Derived f...</td>\n",
       "      <td>126001</td>\n",
       "      <td>[[{'raw_affiliation': [\"College of Chemistry a...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1127675</td>\n",
       "      <td>Chemical Engineering Journal</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>pub.1124597201</td>\n",
       "      <td>10</td>\n",
       "      <td>Nanoremediation of As and metals polluted soil...</td>\n",
       "      <td>1896</td>\n",
       "      <td>[[{'raw_affiliation': ['INDUROT and Environmen...</td>\n",
       "      <td>article</td>\n",
       "      <td>1</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1045337</td>\n",
       "      <td>Scientific Reports</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>pub.1128559650</td>\n",
       "      <td>10</td>\n",
       "      <td>Effect and mechanism of graphene structured pa...</td>\n",
       "      <td>9931</td>\n",
       "      <td>[[{'raw_affiliation': ['College of Environment...</td>\n",
       "      <td>article</td>\n",
       "      <td>1</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1045337</td>\n",
       "      <td>Scientific Reports</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>pub.1127704470</td>\n",
       "      <td>841</td>\n",
       "      <td>Unique FeP@C with polyhedral structure in-situ...</td>\n",
       "      <td>155670</td>\n",
       "      <td>[[{'raw_affiliation': ['School of Metallurgy a...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1041821</td>\n",
       "      <td>Journal of Alloys and Compounds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>pub.1128635128</td>\n",
       "      <td>219</td>\n",
       "      <td>Electrochemical synthesis of Prussian blue fro...</td>\n",
       "      <td>121289</td>\n",
       "      <td>[[{'raw_affiliation': ['Institute of Chemistry...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1076998</td>\n",
       "      <td>Talanta</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>pub.1129377878</td>\n",
       "      <td>273</td>\n",
       "      <td>Deposition mechanism of polydisperse xanthan g...</td>\n",
       "      <td>123069</td>\n",
       "      <td>[[{'raw_affiliation': ['Key Lab of Groundwater...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1044002</td>\n",
       "      <td>Journal of Cleaner Production</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>pub.1129330561</td>\n",
       "      <td>530</td>\n",
       "      <td>The evolution of configuration and final state...</td>\n",
       "      <td>147084</td>\n",
       "      <td>[[{'raw_affiliation': ['School of Mechanical a...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1038686</td>\n",
       "      <td>Applied Surface Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>pub.1129259129</td>\n",
       "      <td>580</td>\n",
       "      <td>Ammonium thiocyanate functionalized graphene o...</td>\n",
       "      <td>345-353</td>\n",
       "      <td>[[{'raw_affiliation': ['Key Laboratory of and ...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1005567</td>\n",
       "      <td>Journal of Colloid and Interface Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>pub.1126838874</td>\n",
       "      <td>53</td>\n",
       "      <td>Electrochemical Determination of Hydrogen Pero...</td>\n",
       "      <td>1-20</td>\n",
       "      <td>[[{'raw_affiliation': ['SensorLab, Department ...</td>\n",
       "      <td>article</td>\n",
       "      <td>15</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1014250</td>\n",
       "      <td>Analytical Letters</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>pub.1127870752</td>\n",
       "      <td>8</td>\n",
       "      <td>Synthesis of Graphene nanosheets by emitted Bl...</td>\n",
       "      <td>104071</td>\n",
       "      <td>[[{'raw_affiliation': ['Department of Studies ...</td>\n",
       "      <td>article</td>\n",
       "      <td>5</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1052918</td>\n",
       "      <td>Journal of Environmental Chemical Engineering</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>pub.1128528792</td>\n",
       "      <td>528</td>\n",
       "      <td>Enhanced adsorption of graphene oxide on iron ...</td>\n",
       "      <td>146981</td>\n",
       "      <td>[[{'raw_affiliation': ['State Key Laboratory o...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1038686</td>\n",
       "      <td>Applied Surface Science</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>pub.1127550252</td>\n",
       "      <td>397</td>\n",
       "      <td>The electrochemical overall water splitting pr...</td>\n",
       "      <td>125454</td>\n",
       "      <td>[[{'raw_affiliation': ['State Key Laboratory o...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1127675</td>\n",
       "      <td>Chemical Engineering Journal</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>pub.1129452259</td>\n",
       "      <td>37</td>\n",
       "      <td>Highly efficient removal of cationic, anionic ...</td>\n",
       "      <td>101345</td>\n",
       "      <td>[[{'raw_affiliation': ['Institute of Environme...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1143108</td>\n",
       "      <td>Journal of Water Process Engineering</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>pub.1128471500</td>\n",
       "      <td>167</td>\n",
       "      <td>Electrocatalytic reduction of CO2 to CO over i...</td>\n",
       "      <td>658-667</td>\n",
       "      <td>[[{'raw_affiliation': ['Key Laboratory of Desi...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1033315</td>\n",
       "      <td>Carbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>pub.1127686946</td>\n",
       "      <td>397</td>\n",
       "      <td>Flexible reduced graphene oxide/prussian blue ...</td>\n",
       "      <td>125521</td>\n",
       "      <td>[[{'raw_affiliation': ['State Key Laboratory o...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1127675</td>\n",
       "      <td>Chemical Engineering Journal</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>pub.1127457260</td>\n",
       "      <td>397</td>\n",
       "      <td>Removal of Microcystin-LR and other Water Poll...</td>\n",
       "      <td>125398</td>\n",
       "      <td>[[{'raw_affiliation': ['INRS-ETE, Université d...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1127675</td>\n",
       "      <td>Chemical Engineering Journal</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>pub.1128314792</td>\n",
       "      <td>167</td>\n",
       "      <td>Multimaterial 3D-printing of graphene/Li0.35Zn...</td>\n",
       "      <td>62-74</td>\n",
       "      <td>[[{'raw_affiliation': ['College of Materials S...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1033315</td>\n",
       "      <td>Carbon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>pub.1127147998</td>\n",
       "      <td>397</td>\n",
       "      <td>Reduced graphene oxide decorated with magnetit...</td>\n",
       "      <td>122760</td>\n",
       "      <td>[[{'raw_affiliation': ['División de Materiales...</td>\n",
       "      <td>article</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2020</td>\n",
       "      <td>jour.1106099</td>\n",
       "      <td>Journal of Hazardous Materials</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                id volume                                              title  \\\n",
       "0   pub.1129300233     17  Induction of ferroptosis in response to graphe...   \n",
       "1   pub.1129376257    164  Highly efficient removal of As(III) from aqueo...   \n",
       "2   pub.1128678090    401  Fabrication of Core-shell Nanohybrid Derived f...   \n",
       "3   pub.1124597201     10  Nanoremediation of As and metals polluted soil...   \n",
       "4   pub.1128559650     10  Effect and mechanism of graphene structured pa...   \n",
       "5   pub.1127704470    841  Unique FeP@C with polyhedral structure in-situ...   \n",
       "6   pub.1128635128    219  Electrochemical synthesis of Prussian blue fro...   \n",
       "7   pub.1129377878    273  Deposition mechanism of polydisperse xanthan g...   \n",
       "8   pub.1129330561    530  The evolution of configuration and final state...   \n",
       "9   pub.1129259129    580  Ammonium thiocyanate functionalized graphene o...   \n",
       "10  pub.1126838874     53  Electrochemical Determination of Hydrogen Pero...   \n",
       "11  pub.1127870752      8  Synthesis of Graphene nanosheets by emitted Bl...   \n",
       "12  pub.1128528792    528  Enhanced adsorption of graphene oxide on iron ...   \n",
       "13  pub.1127550252    397  The electrochemical overall water splitting pr...   \n",
       "14  pub.1129452259     37  Highly efficient removal of cationic, anionic ...   \n",
       "15  pub.1128471500    167  Electrocatalytic reduction of CO2 to CO over i...   \n",
       "16  pub.1127686946    397  Flexible reduced graphene oxide/prussian blue ...   \n",
       "17  pub.1127457260    397  Removal of Microcystin-LR and other Water Poll...   \n",
       "18  pub.1128314792    167  Multimaterial 3D-printing of graphene/Li0.35Zn...   \n",
       "19  pub.1127147998    397  Reduced graphene oxide decorated with magnetit...   \n",
       "\n",
       "      pages                                author_affiliations     type issue  \\\n",
       "0        30  [[{'raw_affiliation': ['Key Laboratory of Envi...  article     1   \n",
       "1     13-26  [[{'raw_affiliation': ['College of Environment...  article   NaN   \n",
       "2    126001  [[{'raw_affiliation': [\"College of Chemistry a...  article   NaN   \n",
       "3      1896  [[{'raw_affiliation': ['INDUROT and Environmen...  article     1   \n",
       "4      9931  [[{'raw_affiliation': ['College of Environment...  article     1   \n",
       "5    155670  [[{'raw_affiliation': ['School of Metallurgy a...  article   NaN   \n",
       "6    121289  [[{'raw_affiliation': ['Institute of Chemistry...  article   NaN   \n",
       "7    123069  [[{'raw_affiliation': ['Key Lab of Groundwater...  article   NaN   \n",
       "8    147084  [[{'raw_affiliation': ['School of Mechanical a...  article   NaN   \n",
       "9   345-353  [[{'raw_affiliation': ['Key Laboratory of and ...  article   NaN   \n",
       "10     1-20  [[{'raw_affiliation': ['SensorLab, Department ...  article    15   \n",
       "11   104071  [[{'raw_affiliation': ['Department of Studies ...  article     5   \n",
       "12   146981  [[{'raw_affiliation': ['State Key Laboratory o...  article   NaN   \n",
       "13   125454  [[{'raw_affiliation': ['State Key Laboratory o...  article   NaN   \n",
       "14   101345  [[{'raw_affiliation': ['Institute of Environme...  article   NaN   \n",
       "15  658-667  [[{'raw_affiliation': ['Key Laboratory of Desi...  article   NaN   \n",
       "16   125521  [[{'raw_affiliation': ['State Key Laboratory o...  article   NaN   \n",
       "17   125398  [[{'raw_affiliation': ['INRS-ETE, Université d...  article   NaN   \n",
       "18    62-74  [[{'raw_affiliation': ['College of Materials S...  article   NaN   \n",
       "19   122760  [[{'raw_affiliation': ['División de Materiales...  article   NaN   \n",
       "\n",
       "    year    journal.id                                      journal.title  \n",
       "0   2020  jour.1034805                      Particle and Fibre Toxicology  \n",
       "1   2020  jour.1090368  International Journal of Biological Macromolec...  \n",
       "2   2020  jour.1127675                       Chemical Engineering Journal  \n",
       "3   2020  jour.1045337                                 Scientific Reports  \n",
       "4   2020  jour.1045337                                 Scientific Reports  \n",
       "5   2020  jour.1041821                    Journal of Alloys and Compounds  \n",
       "6   2020  jour.1076998                                            Talanta  \n",
       "7   2020  jour.1044002                      Journal of Cleaner Production  \n",
       "8   2020  jour.1038686                            Applied Surface Science  \n",
       "9   2020  jour.1005567           Journal of Colloid and Interface Science  \n",
       "10  2020  jour.1014250                                 Analytical Letters  \n",
       "11  2020  jour.1052918      Journal of Environmental Chemical Engineering  \n",
       "12  2020  jour.1038686                            Applied Surface Science  \n",
       "13  2020  jour.1127675                       Chemical Engineering Journal  \n",
       "14  2020  jour.1143108               Journal of Water Process Engineering  \n",
       "15  2020  jour.1033315                                             Carbon  \n",
       "16  2020  jour.1127675                       Chemical Engineering Journal  \n",
       "17  2020  jour.1127675                       Chemical Engineering Journal  \n",
       "18  2020  jour.1033315                                             Carbon  \n",
       "19  2020  jour.1106099                     Journal of Hazardous Materials  "
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%dsldf\n",
    "\n",
    "search publications in title_only for \"graphene AND catalyst\" \n",
    "    or in full_data for  \"graphene AND iron\" \n",
    "return publications"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
